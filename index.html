<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="styles/wallet.css" rel="stylesheet">
    <!--link href="styles/ethereum.css" rel="stylesheet"-->
    <title>Open Offline Wallet</title>
</head>

<body>
    <!--div class="container" -->

    <header>
        <img src="images/logo.png" style="position: absolute;top: 5px;left: 16px;height: 60px;">
        <div
            style="position: absolute;left: 90px;font-size: 2.5rem;text-shadow: -1px -1px #eee,1px 1px #555;color: lightblue;font-weight: 600;height: 70px;line-height: 70px;">
            Open Offline Wallet
        </div>
        <select id="select_language"
            style="text-align: center;border-style: none;background-color: transparent;outline-style: none;position: absolute;right: 10px;top: 4px;border-bottom: 1px solid #999;">
            <option value="en" selected="">English</option>
            <option value="zh">简体中文</option>
        </select>
        <a href="btceth/index.html" target="_blank">
            <img id="walletoffline_website" src="images/offlinewallet.png"
                style="position: fixed;top: 70px;right: 0px;z-index: 1" title="Browser the walletoffline website">
        </a>

    </header>
    <main>
        <details class="parent">
            <summary>ABOUT US</summary>
            <div class="window">
                <section>
                    <h1>Who Are We?</h1>
                    <p>We have a deep understanding of cryptocurrency principles, mastery of cryptocurrency development
                        technologies, and over a decade of cryptocurrency trading experience. We are fully aware of the
                        concerns of current and potential cryptocurrency investors, as well as the issues they want us
                        to address: 1. What exactly is cryptocurrency? 2. Which wallet is the safest? 3. How to securely
                        protect private keys without fail? 4. How to buy and sell cryptocurrency? ...</p>
                    <p>We are here to solve these problems, eliminating all your doubts so you can confidently invest in
                        cryptocurrency and reap the benefits of its year-after-year value surge.</p>
                </section>
                <section style="background: #F0F0F0;">
                    <h1>What Have We Done?</h1>
                    <p>We have developed an open offline cryptocurrency wallet that meticulously demonstrates every
                        detail of wallet creation and transaction initiation, ensuring you fully understand and control
                        each step. Yes, having complete control yourself guarantees foolproof security! No reliance on
                        cryptocurrency trading platforms—where your private keys are exposed—nor on existing
                        cryptocurrency wallets, which obscure details and may contain backdoors.</p>
                    <p>Our offline cryptocurrency wallet is fully open-source, with transparent and publicly available
                        code. Everyone can inspect the source code, so you can use it with complete confidence.</p>
                </section>
                <section>
                    <h1>How to Use the Open Offline Wallet?</h1>
                    <p>There are multiple methods.</p>
                    <p>Method 1: Click the wallet icon in the top-right corner of this website to open the offline
                        wallet site. You can familiarize yourself with the demo operations there, but it is not
                        recommended for actual use.</p>
                    <p>Method 2: Click the wallet icon in the top-right corner of this website to open the offline
                        wallet site, then switch your browser to offline mode or physically disconnect from the
                        internet. This makes it safer for actual use, as private keys cannot be leaked online.</p>
                    <p>Method 3: Download the offline wallet to your local hard drive from the download page. You can
                        then open the page offline to perform wallet and transaction operations securely.</p>
                    <p>For safe operation methods, continue browsing the "Introduction" page.</p>
                </section>
            </div>
        </details>
        <details class="parent">
            <summary>DOCUMENT</summary>
            <div class="window">
                <details class="child">
                    <summary>INTRODUCTION</summary>
                    <section>
                        <h1>Important Notes</h1>
                        <p style="color: rgb(213, 5, 5);">(1). Please use Firefox browser. You can download and install
                            the enterprise version Firefox-ESR <a
                                href="https://www.mozilla.org/en-US/firefox/enterprise/#download" target="_blank"
                                class="online">here</a>. Firefox is open-source software, making it extremely difficult
                            to contain backdoors.</p>
                        <p style="color: rgb(213, 5, 5);">(2). Always use Firefox's Private Window (launch by pressing
                            Ctrl+Shift+P after starting Firefox). All browsing traces will be destroyed after closing
                            the Private Window, ensuring your private keys remain absolutely secure.</p>
                        <p style="color: rgb(213, 5, 5);">(3). When generating wallets, recovering wallets, or signing
                            transactions, always disconnect the browser from the internet (Press Alt key, then click
                            "File" in the top-left corner, and select "Work Offline"). This guarantees your private keys
                            cannot be leaked through network transmission.</p>
                        <p style="color: rgb(213, 5, 5);">(4). When copying and pasting private keys, use the
                            three-segment method: First copy-paste one segment, then manually type the next few
                            characters, and finally copy-paste the remaining characters. This prevents
                            clipboard-monitoring spyware from stealing your complete private key. Reference example
                            below:</p>
                        <p><img src="images/copy_pri.png" style="max-width: 80%;"></p>
                    </section>
                    <section style="background: #F0F0F0;">
                        <h1>1. Trading Introduction</h1>
                        <p>Let's begin with a story. John saved some money after years of work but found no good
                            investment opportunities domestically. "At the very least, I should preserve the value of my
                            hard-earned money," John pondered, ultimately deciding to invest all his savings in
                            cryptocurrency. Hearing that one Bitcoin could buy an apartment in a second-tier city within
                            five years, he chose to purchase Bitcoin.</p>

                        <p>First, John needed a Bitcoin wallet. He registered an account on a cryptocurrency
                            exchange, which automatically provided him with an online Bitcoin wallet (let's call it
                            Wallet A), and later acquired an offline wallet (Wallet B). John bought Bitcoin through
                            Wallet A and transferred his holdings to Wallet B once they reached a certain value (say,
                            $30,000 equivalent), since Wallet A on a third-party platform was less secure than Wallet B
                            which only he controlled. When selling Bitcoin, he would first transfer from Wallet B back
                            to Wallet A before selling on the platform. Beyond online trading, peer-to-peer transactions
                            were another option - like when John bought Bitcoin directly from acquaintance Jack
                            via WeChat Pay, with Jack sending the coins straight to John's Wallet B.</p>

                        <p>Through this website, you can not only obtain Wallet B but also learn how to: send coins
                            peer-to-peer, find where to get Wallet A, locate local cryptocurrency sellers, and more...
                        </p>

                        <p>In China, investing in cryptocurrencies is one of the best ways for the poor to become rich.
                            By late 2024, one Bitcoin was worth $100,000 - enough to
                            buy an apartment in third-tier cities. We're confident that in five years it'll buy homes in
                            second-tier cities, and in ten years, first-tier cities! Excited? If so, keep reading.</p>

                        <p>So how exactly do you trade cryptocurrency? Stay tuned for our next chapter... just kidding!
                        </p>

                        <p>First, you'll need at least one cryptocurrency wallet with its unique address. When buying
                            coins, you'd provide this address saying "Please send coins here!" The seller might
                            cautiously reply "Triple-check this address - wrong transfers are your responsibility!"
                            After repeatedly verifying, you'd confirm "Address is correct, don't worry bro!" After
                            transfer, you can check receipt on blockchain explorers like https://blockchair.com/.</p>

                        <p>As you accumulate coins and watch prices soar daily, you'll calculate your growing wealth.
                            Gradually escaping your underdog status, one day you'll finally make it - perhaps
                            exclaiming: "Damn, I love this crazy world! Let's toast to our mortal lives!"</p>

                        <p>How to actually buy cryptocurrency? Patience... Imagine approaching a mysterious cabin on a
                            dark, windy night... just kidding again!</p>

                        <p>Your wallet contains a private key. When selling coins, you'll initiate a transfer
                            transaction signed with this private key, then broadcast the signed transaction to the
                            network. Miners will include it in a block - usually completing within minutes. Higher
                            transaction fees (paid in crypto, not actual dollars) grant priority. Currently miners care
                            more about block rewards than fees. You set the fee (typically under $1 equivalent) -
                            unrelated to transfer amount. I once paid just $0.40 equivalent (about 400 satoshis at
                            100,000 satoshi/$1) for a speedy transaction. Example transaction data: Recipient's address:
                            xxxxx, Amount: 30,000,000 satoshis (0.3 BTC), Fee: 1,000 satoshis.</p>

                        <p>Addresses derive from private keys but cannot reverse-engineer them. Never share your private
                            key - it's the sole access to spend your coins!</p>

                        <p>How to get a wallet? See "Wallet Management" below. How to initiate transactions? Click
                            "Offline Signing" and "Broadcast Transaction".</p>
                    </section>
                    <section>
                        <h1>2. Cryptocurrency Wallets</h1>
                        <h2>2.1 Private Keys</h2>
                        <p>A private key IS your cryptocurrency wallet! Essentially, it's a 256-bit random binary
                            number. Imagine flipping a coin where heads=1 and tails=0 - if you record 256 consecutive
                            flips, you've created a valid private key, like this example:</p>

                        <img src="images/privateKey.png" style="height: auto; max-width: 80%;">

                        <p>I actually tested this coin-flip method myself, generating this binary sequence:
                            1100111101001101000100000011000011111110110011100001000001110001101101110011001001000110011110010011110100000110110100111101000010001110101011010011100001010100100000011110111000101000110010111111011110110010001010000101100101110111001001111001100011010001.
                        </p>

                        <p>Since 256-bit binary is hard to remember, we convert it to hexadecimal. My coin-flip key
                            becomes: cf4d1030fece1071b73246793d06d3d08ead385481ee28cbf7b22859772798d1. "Seriously?
                            That's still impossible to memorize!" "Dude, just write it down!"</p>

                        <p>Written on paper, it's a paper wallet; memorized, it's a brain wallet; stored digitally, an
                            electronic wallet. Both Bitcoin and Ethereum use 256-bit private keys, meaning one key could
                            technically control both assets - but I strongly advise against this. If you lose the key,
                            game over for all associated coins. If compromised, all assets are at risk.</p>

                        <p>Bitcoin experts recommend: Use a unique private key for every incoming transaction! Receive 3
                            BTC from John? Use key X. Get 5 BTC from Jack? Use key Y. Wang Er sending coins?
                            Generate another new key. My practical advice: Follow this for large transactions, but use
                            fewer keys for small amounts to avoid management headaches.</p>

                        <p>For easier wallet integration, Bitcoin converts hexadecimal keys to Base58-encoded WIF
                            (Wallet Import Format). My coin-flip key in WIF becomes:
                            L4AgDeoTPbdRd4S7X9UhXaNtyxZhDuj7EoUxPUndDYkvfmHjR8Cd. The binary, hexadecimal, and WIF
                            formats are interchangeable. Ethereum only uses hexadecimal format. Important note:
                            Hexadecimal is case-insensitive, but WIF is CASE-SENSITIVE!</p>

                        <p>NEVER share your private key - it should be known ONLY to you! (Well... maybe share with
                            family as contingency planning, unless you want your crypto to die with you... just saying.)
                        </p>

                        <p>In practice, we generate keys programmatically rather than coin-flipping. For deeper
                            exploration of private keys, check out my new book "Cryptocurrency Security in Practice"
                            available on my personal site (https://www.veryopen.org).</p>
                    </section>
                    <section style="background: #F0F0F0;">
                        <h2>2.2 Addresses</h2>
                        <p>A wallet address is derived from a public key, which in turn is generated from a private key.
                            However, it's impossible to reverse-engineer the public key from an address or deduce the
                            private key from a public key. You can freely share your address with others to receive
                            cryptocurrency, similar to providing your shipping address for online purchases. Different
                            cryptocurrencies use different methods to derive addresses from private keys, resulting in
                            distinct address formats. For example, Bitcoin and Ethereum addresses generated from the
                            same private key will be completely different - a Bitcoin address cannot receive Ether, and
                            vice versa. Sending coins to the wrong address type will result in permanent loss!</p>

                        <p>Even within the same cryptocurrency, multiple address types may emerge over time. Bitcoin
                            currently has several address types in chronological order: P2PK, P2PKH, P2SH, P2WPKH, and
                            P2TR (introduced in 2021). P2WPKH is currently the most popular due to smaller transaction
                            data size and lower fees. P2SH and P2TR support multisignature transactions, ideal for
                            organizational use cases requiring multiple approvals - for example, a company requiring
                            signatures from the CEO, CFO, and accounting manager to authorize payments.</p>

                        <p>The same private key can generate all address types. For instance, I can derive all Bitcoin
                            address formats from one private key. When transacting, I provide the most advanced address
                            type the recipient's wallet supports. If John's wallet handles P2WPKH, P2SH, and P2PKH,
                            I'll share my P2WPKH address. For Jack's wallet that only supports P2PKH and P2PK, I'd
                            provide the P2PKH address instead. Older wallets may not support newer address types.</p>

                        <p>Example Bitcoin addresses derived from my earlier coin-flip private key
                            (L4AgDeoTPbdRd4S7X9UhXaNtyxZhDuj7EoUxPUndDYkvfmHjR8Cd), generated using our open offline
                            wallet's "Bitcoin > Wallet Management > Derive Public Key and Address" tool:</p>

                        <div style="padding-left: 3rem;">
                            P2PKH address: 1QKaUAoU2h9HUFyBpxFwrSZ4X4n4X2Xukp<br>
                            P2SH address: 35SbZDs5biwdSFFUTR5GTQSH2fkDX2GqQ8<br>
                            P2WPKH address: bc1qll89rqfmzllnyd9cnzy8vex9jueqv86y6587wg<br>
                            P2WSH address: bc1q0lsk5wd7kqr053lyzxmcdy2a07a7ntju4rjjwftutqsahg6u2gfqu6tp6v<br>
                            P2TR address: bc1pgp2szey33f8eaqxd5hlulhmhd6dh8fz90zdgftr0var5jcs4vypsx5u8f6
                        </div>

                        <p>I've omitted P2PK addresses as they're obsolete. P2PKH and P2SH addresses use Base58 encoding
                            with case-sensitive characters, while the last three types use Bech32 encoding (all
                            lowercase).</p>

                        <p>Ethereum uses a single address format like 0x2e8681f8e38726D6C99009A4d724651Ff611fB27.
                            Ethereum Name Service (ENS) - similar to DNS for websites - maps human-readable names (e.g.,
                            abc.eth) to Ethereum addresses. Instead of sharing complex addresses, you can provide your
                            ENS domain (e.g., "Send to abc.eth"). Register your ENS domain at <a
                                href="https://app.ens.domains/">https://app.ens.domains/</a> (detailed instructions in
                            my book "Cryptocurrency Security in Practice"). As Ethereum becomes more widely adopted,
                            short ENS domains may become valuable digital assets.</p>
                    </section>
                    <section>
                        <h2>2.3 Wallet Balance</h2>
                        <p>Ethereum has a concept of account balance, but Bitcoin doesn't maintain balances in the
                            traditional sense. The "balance" shown in Bitcoin wallet apps is dynamically calculated -
                            it's the sum of all unspent transaction outputs (UTXOs) you've received. To better
                            understand how this works, let's examine an example:</p>

                        <p>Suppose your address has received two transactions: 1 BTC from John and 0.5 BTC from Jack,
                            making your wallet balance 1.5 BTC. Now you want to send 0.7 BTC to Alice. This would
                            require spending John's original 1 BTC transaction. You'd create a transaction with
                            these details:</p>
                        <div style="padding-left: 3rem;">
                            • Input: Spend John's 100,000,000 satoshis (1 BTC)
                            <br>• Output 1: Send 70,000,000 satoshis (0.7 BTC) to Alice
                            <br>• Output 2: Return 29,999,000 satoshis (0.29999 BTC) to yourself
                            <br>• Transaction fee: 1,000 satoshis
                        </div>

                        <p>After signing this transaction with your private key and broadcasting it, John's
                            original transaction is marked as spent. Your wallet now shows a new balance of 0.79999 BTC
                            (Jack's 0.5 BTC plus your 0.29999 BTC change).</p>

                        <p>Could you have spent Jack's 0.5 BTC instead? No, because it's insufficient. However, you
                            could combine both inputs (1.5 BTC total) and send the difference (0.79999 BTC) back to
                            yourself (typically to a different address for fund consolidation).</p>

                        <p>In summary, a Bitcoin wallet balance is simply the sum of all unspent transaction outputs
                            (UTXOs) associated with your addresses.</p>
                    </section>

                    <section style="background: #F0F0F0;">
                        <h1>3. Offline Transaction Signing</h1>
                        <p>All cryptocurrency transactions must be digitally signed before being broadcast to the
                            network. Miners verify these signatures before including transactions in blocks - unsigned
                            or invalid transactions are immediately rejected. To create a valid transaction, you must
                            specify:</p>

                        <p>For Bitcoin:</p>
                        <div style="padding-left: 3rem;">
                            (1) Which UTXOs to spend (Inputs)
                            <br>(2) Recipient addresses and amounts (Outputs)
                            <br>(3) Where to send any remaining change
                            <br>The fundamental equation is: Total Inputs = Total Outputs + Transaction Fee
                        </div>

                        <p>For Ethereum (which uses account balances):</p>
                        <div style="padding-left: 3rem;">(1) Recipient address
                            <br>(2) Amount to send
                            <br>(3) Willingness to pay gas fee
                        </div>

                        <p>Since signing requires your private key, online signing methods (like exchange platforms or
                            mobile wallets) risk private key exposure. Our open offline wallet allows secure signing in
                            air-gapped environments, ensuring absolute private key protection!</p>
                    </section>
                    <section>
                        <h1>4. Private Key Management</h1>
                        <p>Given the critical importance of private keys, their secure management remains a paramount
                            concern for all cryptocurrency users. A forgotten private key means permanent loss of
                            assets, while a compromised private key equals stolen funds.</p>
                    </section>

                    <section>
                        <h2>4.1 Private Key Encryption</h2>
                        <p>To prevent theft, private keys can be encrypted - creating ciphertext private keys. Even if
                            someone obtains the encrypted version, without the decryption password they cannot access
                            the actual private key or initiate transactions (as miners reject all unsigned
                            transactions). The encryption password (similar to online banking passwords) typically
                            consists of 7-8 memorable characters. The encrypted private key can then be safely stored on
                            paper, computers, USB drives, cloud storage, or email.</p>

                        <p>Warning: Simple passwords (like "123456") create significant risk, especially for
                            cloud-stored keys. We recommend passwords with:</p>
                        <div style="padding-left: 3rem;">• Minimum 9 characters
                            <br>• Combination of numbers, lowercase letters
                            <br>• Special characters (.,%@#*&!;-)
                        </div>

                        <p>Our Open Offline Wallet's "Private Key Protection" tool handles encryption/decryption and
                            supports direct signing with encrypted private keys (temporarily decrypting during signing).
                        </p>
                    </section>

                    <section style="background: #F0F0F0;">
                        <h2>4.2 HD Wallet</h2>
                        <p>An HD wallet can generate a large number of private keys and is easy to remember and manage.
                            It fulfills one of the recommendations in "Best Practices for Cryptocurrency Investment":
                            use a separate private key for each transaction. As the number of transactions increases,
                            the number of private keys used also rises significantly. Encrypting each private key
                            individually becomes time-consuming and labor-intensive, and this is where HD wallets come
                            into play. An HD wallet, or Hierarchical Deterministic wallet, is based on the core idea of
                            deriving a large number of wallets from a set of words (seed phrase) according to a wallet
                            path, as illustrated below.</p>
                        <p style="text-align: center;"><img src="images/hd.png" style="max-width: 80%;"></p>
                        <p>Once the random number is determined, the mnemonic phrase is fixed. The mnemonic phrase +
                            password uniquely determines the seed, and the seed uniquely determines the root private key
                            (m). From there, the wallet path determines each private key. Whether a password is used or
                            not, and what password is used, the seed derived from the same mnemonic phrase will be
                            entirely different. The path from the root (m) to the 5th level is referred to as the
                            Bitcoin HD wallet path, with the following format:</p>
                        <p style="text-align: center;"><img src="images/hd_road.png" style="max-width: 80%;"></p>
                        <p>Wallet paths exceeding 5 levels are non-standard and may not be supported by many wallet
                            apps. However, our "Open Offline Wallet" supports non-standard paths. The standard wallet
                            path format for Bitcoin's P2WPKH type is "m/84'/0'/i'/x/j," while Ethereum's HD wallet path
                            format is "m/44'/60'/i'/x/j." Here, the values of i and j range from [0, 2147483647]. When x
                            = 0, it represents the (j+1)th external wallet of the (i+1)th account; when x = 1, it
                            represents the (j+1)th internal wallet of the (i+1)th account. External wallet addresses are
                            public, allowing others to send coins to them, while internal wallet addresses are kept
                            private and known only to the owner. For example, the Bitcoin wallet path "m/84'/0'/1'/0/3"
                            refers to the 4th external wallet of the 2nd account, while "m/84'/0'/1'/1/3" refers to the
                            4th internal wallet of the 2nd account. Since cryptocurrencies currently exist in a legal
                            gray area in almost all countries, many cryptocurrency investors prefer not to expose their
                            privacy, even avoiding publicizing wallet addresses. A common practice is to publish an
                            external wallet address and transfer accumulated coins to an internal wallet once a certain
                            amount is reached, while keeping only a small amount in the external wallet. As previously
                            mentioned, a private key is equivalent to a wallet. Now, we only need to remember a set of
                            words, known as the mnemonic phrase. The number of words in a mnemonic phrase can be 12, 15,
                            18, 21, or 24. The more words there are, the harder it is for others to guess, making your
                            HD wallet more secure. For example, "asset curve boss naive trade never sister evoke what
                            lunch glory update course acquire first mistake solve bullet pipe practice husband round
                            glow wing" is a 24-word mnemonic phrase. Mnemonic phrases cannot be manually specified by
                            users because the last word contains a checksum of the preceding words. This open offline
                            wallet provides a feature to customize mnemonic phrases (under "Tools > Custom Mnemonic"),
                            but it is not advisable to specify too few words, as this makes it easier for others to
                            guess. If you want to understand the mechanism behind mnemonic phrase generation, please
                            refer to our book "Practical Cryptocurrency Security Trading." When deriving an account from
                            a mnemonic phrase, a password can be added, ensuring that even if someone obtains your
                            mnemonic phrase, they cannot access your accounts without the password.</p>
                        <p>When generating an HD wallet, you need to specify the wallet path. To restore an HD wallet,
                            you must input the mnemonic phrase and wallet path. If a password was set, it must also be
                            provided. For example, two years ago, I used the mnemonic phrase "poem crater dove table
                            knock moment raccoon scrub color raccoon figure stumble" with the password "A1b2C3&" to
                            derive a wallet with the path "m/84'/0'/5'/0/2" and had Zhang San transfer 3 Bitcoins to it.
                            At the time, I noted the following on paper: "poem crater dove table knock moment raccoon
                            scrub color raccoon figure stumble | m/84'/0'/5'/0/2," while the password was one I
                            frequently used and memorized.</p>
                        <p>Now, if you want to spend these funds, you must recover the private key from the mnemonic
                            phrase. To do this, go to "Bitcoin > Wallet Management > Create/Restore Wallet" in the open
                            offline wallet, enter the mnemonic phrase "poem crater dove table knock moment raccoon scrub
                            color raccoon figure stumble," the password "A1b2C3&," and the wallet path
                            "m/84'/0'/5'/0/2." Then click the "Restore Wallet" button to reveal the private key
                            "KyPwsvn7cPoCoyujACRUz4m5SsH9tYaYv6JTm4YAu1XBMfH1fs17." Once you have the private key, you
                            can initiate and sign transactions.</p>
                        <p>You might think, "Why not just memorize the private key instead of restoring it from the
                            mnemonic phrase every time?" That's correct—if a wallet is used frequently, memorizing the
                            private key separately is a good idea, as frequent use of the mnemonic phrase increases the
                            risk of exposure. The mnemonic phrase is the lifeline of all your wallets. However, we
                            recommend encrypting the private key before memorizing it.</p>
                    </section>
                    <section>
                        <h1>5. Best Practices</h1>
                        <p>These are purely our summarized experiences and do not represent the optimal or the only
                            methods. They are provided for reference only.</p>
                        <p>(1) For ordinary users who only buy/sell cryptocurrencies with low transaction frequency
                            (rarely exceeding 10 times a year) and whose crypto assets are below one million, we
                            recommend using just one private key. Protect the private key with a password, then derive
                            both a Bitcoin P2WPKH and P2PKH address from it, as well as an Ethereum address.</p>
                        <p>(2) For users with crypto assets between one million and ten million and low transaction
                            frequency, we recommend using a single mnemonic phrase (containing 18 or more words)
                            protected by a password. Use this mnemonic to derive a Bitcoin HD wallet with an external
                            wallet path like "m/84'/0'/i'/0/j" (i.e., the (j+1)th wallet in the (i+1)th account). Only
                            create 1-2 accounts, with 2-3 wallets per account, along with a few internal wallets.
                            Additionally, set up a few Ethereum external wallets with paths like "m/44'/60'/i'/0/j"
                            (where i and j have the same meaning as in Bitcoin) and a few Ethereum internal wallets with
                            paths like "m/44'/60'/i'/1/j".</p>
                        <p>(3) For heavy cryptocurrency investors with assets exceeding tens of millions, hundreds of
                            millions, or even billions, use a separate mnemonic phrase (containing 24 words) for each
                            cryptocurrency. Protect each mnemonic with a strong password (at least 15 characters long,
                            including uppercase/lowercase letters, numbers, and special symbols). Use 3-5 accounts per
                            cryptocurrency, with multiple external and internal wallets in each. Plan account and wallet
                            usage carefully—each large transaction (over ten million) should use a dedicated wallet for
                            receiving funds. The private keys of these wallets must be encrypted, and signing
                            transactions should be done using the encrypted private key and password (temporarily
                            decrypting the private key for signing).</p>
                    </section>
                </details>
                <details class="child">
                    <summary>DEALING BITCOIN</summary>
                    <div class="window">
                        <section style="background: #F0F0F0;">
                            <h1>1. Bitcoin Wallet Management</h1>
                            <p>A private key constitutes a complete wallet - essentially a 256-bit random binary number
                                that generates wallet addresses. As Bitcoin was the pioneer cryptocurrency, its initial
                                design had limitations that led to multiple upgrades and forks, resulting in various
                                address types:</p>

                            <ul>
                                <li><strong>P2PK</strong>: Original Pay-to-Public-Key</li>
                                <li><strong>P2PKH</strong>: Pay-to-Public-Key-Hash</li>
                                <li><strong>P2WPKH</strong>: SegWit addresses (most popular currently)</li>
                                <li><strong>P2SH/P2WSH</strong>: Multi-signature addresses</li>
                                <li><strong>P2TR</strong>: Latest Taproot addresses</li>
                            </ul>

                            <p>The same private key can generate all address types, and spending from any of them
                                requires signing with that single private key. Currently, P2WPKH addresses dominate due
                                to lower transaction fees and enhanced privacy.</p>

                            <p>Our Open Offline Wallet creates Hierarchical Deterministic (HD) wallets - the most
                                advanced Bitcoin wallet system. A single mnemonic phrase can generate millions of
                                accounts, each capable of producing millions of wallets.</p>
                        </section>

                        <section>
                            <h2>1.1 Create New Wallet</h2>
                            <p>Navigate to "Bitcoin" > "Wallet Management" > "Create/Recover Wallet" in the Open Offline
                                Wallet. Click "Create New Wallet" to generate a default wallet (path: m/84'/0'/0'/0/0)
                                with a 24-word English mnemonic phrase (no password protection).</p>

                            <p style="text-align: center;"><img src="images/hd_new.jpg" style="max-width: 80%;"></p>

                            <p>Customization options include:
                                <br>• Mnemonic length (12/15/18/21/24 words)
                                <br>• Language (English recommended for compatibility)
                                <br>• Optional password protection
                                <br>• Custom HD wallet path
                            </p>

                            <p>Supported languages: English, Simplified Chinese, Traditional Chinese, Japanese, Spanish,
                                French, Italian, Korean, Portuguese, and Czech. Longer mnemonics provide greater
                                security through increased entropy.</p>

                            <p>After creation, click "Show More Info" to view:
                                <br>• Seed
                                <br>• Root extended private key (xprv)
                                <br>• Account extended keys (useful for importing to other wallets)
                            </p>

                            <p><strong>Best Practice:</strong>
                                <br>1. Create an external receiving wallet (e.g., m/84'/0'/0'/0/0)
                                <br>2. Establish an internal wallet in the same account (e.g., m/84'/0'/0'/1/666)
                                <br>3. Regularly sweep funds from external to internal wallet
                                <br>4. Maintain minimal balances in external wallets
                            </p>
                        </section>

                        <section style="background: #F0F0F0;">
                            <h2>1.2 Wallet Recovery</h2>
                            <p>Three recovery methods (priority order):</p>

                            <ol>
                                <li><strong>Root Extended Private Key</strong>: Highest priority if provided</li>
                                <li><strong>Seed</strong>: Used if no xprv provided</li>
                                <li><strong>Mnemonic + Password</strong>: Required if wallet was password-protected</li>
                            </ol>

                            <p>Simply enter the required information along with the wallet path and click "Recover
                                Wallet". The system automatically follows the priority hierarchy if multiple recovery
                                methods are entered simultaneously.</p>
                        </section>
                        <section>
                            <h2>1.3 Deriving Public Key and Wallet Address from Private Key</h2>
                            <p>In the offline wallet, click "Bitcoin," "Wallet Management," and then "Derive Public Key
                                and Wallet Address from Private Key" to open the interface shown below. Enter the
                                private key and click the "Confirm" button to derive the public key and address.</p>
                            <p style="text-align: center;"><img src="images/privateKey_address.jpg"
                                    style="max-width: 80%;"></p>
                        </section>
                        <section style="background: #F0F0F0;">
                            <h2>1.4 Generating a Multi-Signature Address</h2>
                            <p>In the offline wallet, click "Bitcoin," "Wallet Management," and then "Derive Public Key
                                and Wallet Address from Private Key" to open the interface shown below. P2SH, P2WSH, and
                                P2TR-type addresses all support multi-signature—requiring signatures from multiple
                                parties to spend funds. An "n-of-m multi-signature" means that at least n out of m
                                signatures are required to spend the funds.</p>
                            <img src="images/multi_sign_address.jpg">
                            <p>For example, to generate a 2-of-3 multi-signature address for P2SH and P2WSH, assume the
                                three public keys are
                                02770c8febd8c26aa31678f390fbd9df9840b2640cfbf8d3048af58ead89d150d1,
                                02c5e1f3dc9d9a23650710daa31cfc5faa055c4350fa94690936666a60c6a3e16d, and
                                02563ccbebd4747938ac6e6e6dfaea04dedac50f8db53f10de366bdc1a88157da6. The result is shown
                                in the image below.</p>
                            <img src="images/multisign_exp.jpg">
                            <p>Later, others can send coins to the addresses
                                bc1qnlz6jdehzz68z9czuz9levmf5czdpudahyp0ta0x6lf0wgxklfrs7apvx2 or
                                34umyEgUMxve5ru74PLWHJjKdKcJ8Exeow. When spending UTXOs from these addresses, at least
                                two signatures are required—either two or three private keys corresponding to the three
                                public keys.</p>
                            <p>For instructions on generating a script-path address for a P2TR wallet, please refer to
                                our book "Practical Guide to Secure Cryptocurrency Transactions." Examples will not be
                                provided here.</p>
                        </section>
                        <section>
                            <h2>1.5 Wallet Balance, UTXOs, and Transaction Details</h2>
                            <p>You can query all UTXOs and the total balance based on a wallet address, or enter a
                                transaction ID to check a specific transaction.</p>
                        </section>
                        <section style="background: #F0F0F0;">
                            <h1>2. Bitcoin Transaction Broadcasting</h1>
                            <p>Complete external transfer transactions here. In the offline wallet, click "Bitcoin,"
                                then "Broadcast Transaction" to open the page shown below.</p>
                            <img src="images/send_tx.jpg">
                            <p>The steps for broadcasting a transaction include: creating a transaction, signing the
                                transaction, encoding the transaction into a hex string, decoding the hex string to
                                verify the transaction, and finally broadcasting the transaction.</p>
                        </section>
                        <section>
                            <h2>2.1 Creating a Transaction</h2>
                            <p>Click "Bitcoin," "Broadcast Transaction," then "1. Create" to open the screen shown
                                below.</p>
                            <img src="images/create_tx.jpg">
                            <p>Unless you understand the exact meanings of Version, Marker, Locktime, and Flag and truly
                                need to modify them, do not change these parameters casually. You can specify the
                                transaction fee yourself, typically between $3 and $5. Avoid setting it too low—if it's
                                below $1, the transaction may take a long time to complete (several hours). Higher fees
                                lead to faster confirmations, as miners prioritize transactions with higher fees. The
                                difference between the total amount and the recipient's credited amount is the
                                transaction fee.</p>
                            <p>A transfer transaction can have inputs from multiple wallet addresses and outputs to
                                multiple wallet addresses. For more details, refer to "Practical Guide to Secure
                                Cryptocurrency Transactions."</p>
                            <p>To permanently store information on the Bitcoin blockchain, select the "OP_RETURN"
                                address type in the output section on the right. A dialog box will appear where you can
                                enter the information to be stored (up to 80 characters). However, it is recommended to
                                store data on the Ethereum blockchain instead, as the fees are lower and you can store
                                up to 7,000 Chinese characters.</p>
                        </section>
                        <section style="background: #F0F0F0;">
                            <h2>2.2 Signing</h2>
                            <p>Click "Bitcoin," "Broadcast Transaction," then "2. Sign" to open the screen shown below.
                            </p>
                            <img src="images/sign.jpg">
                            <p>Since signing requires a private key, ensure the browser is in offline mode. Copy the
                                private key in segments. The private key used for signing must correspond to the UTXO of
                                the input. The default signature type is SIGHASH_ALL—do not change it unless necessary.
                                If using an encrypted private key, enter the password used for encryption along with the
                                N, r, and p parameters, which correspond to "CPU/memory cost," "block size," and
                                "parallelization" during encryption.</p>
                            <p>Note: A single private key can sign multiple inputs at once, and an input can be signed
                                multiple times by different private keys. All inputs must be signed.</p>
                        </section>
                        <section>
                            <h2>2.3 Encoding</h2>
                            <p>This step converts the transaction into a Hex (hexadecimal format) string for subsequent
                                decoding, verification, and broadcasting.</p>
                        </section>
                        <section style="background: #F0F0F0;">
                            <h2>2.4 Verification</h2>
                            <p>Decode the Hex-formatted transaction string back into its structured form to inspect each
                                field. Key areas to verify include the recipient address, amount, output scripts, and
                                transaction fee. Unlike traditional bank transfers, cryptocurrency transactions are
                                irreversible if errors occur! Refer to the image below.</p>
                            <img src="images/verify.jpg">
                            <p>After thorough verification, the transaction can be broadcast. Since this browser
                                operates offline, you must copy the Hex string to an online browser for broadcasting.
                                The following websites support transaction broadcasting:
                                <a href="https://blockchair.com/broadcast">https://blockchair.com/broadcast</a>,
                                <a
                                    href="https://live.blockcypher.com/btc/pushtx/">https://live.blockcypher.com/btc/pushtx/</a>,
                                <a
                                    href="https://www.blockchain.com/btc/pushtx">https://www.blockchain.com/btc/pushtx</a>.
                                Alternatively, open the offline wallet in another browser, navigate to "Bitcoin" →
                                "Broadcast Transaction" → "5. Broadcast".
                                After broadcasting, check <a
                                    href="https://blockstream.info/">https://blockstream.info/</a> within minutes to
                                confirm transaction completion.
                            </p>
                        </section>
                    </div>
                </details>
                <details class="child">
                    <summary>DEALING ETHEREUM</summary>
                    <div class="window">
                        <section>
                            <h1>1. Ethereum Wallet Management</h1>
                            <p>Click "Ethereum" on the left sidebar, then select "Wallet Management" to access the
                                interface shown below.</p>
                            <img src="images/ethereum_allet.jpg">
                        </section>
                        <section style="background: #F0F0F0;">
                            <h2>1.1 Create/Restore Wallet</h2>
                            <p>Click "Create/Restore Wallet" in the above image to enter Ethereum wallet management.
                                Here, identical mnemonic phrases with different passwords will generate distinct
                                wallets. You can restore an HD wallet from a mnemonic or derive public keys/addresses
                                from existing private keys (whether encrypted or unencrypted). For example, clicking
                                "Create New Ethereum Wallet" generates a wallet as shown below.</p>
                            <img src="images/ethereum_create.jpg">
                            <p>1. <strong>Creating a wallet</strong>:
                                - Specify the number of mnemonic words (minimum 12, maximum 24; more words enhance
                                security).
                                - Select the mnemonic language (e.g., English, Simplified Chinese).
                                - A combination of "Mnemonic Phrase" + "Mnemonic Password" can derive multiple private
                                keys (each key corresponds to one wallet).
                                - <u>Note</u>: Different passwords with the same mnemonic yield different private
                                keys—always use a password for mnemonic protection.
                                - <strong>Wallet Path</strong>: A string like "m/44'/60'/i'/0/j…" indicates the (j+1)th
                                wallet under the (i+1)th account (i, j ≥ 0). Only modify <em>i</em> and <em>j</em> or
                                extend the path.
                                - Example: Default path "m/44'/60'/0'/0/0" = 1st account’s 1st wallet;
                                "m/44'/60'/0'/0/5" = 1st account’s 6th wallet. Avoid overly complex paths to prevent
                                errors.
                                - If a private key encryption password is set, the derived key will be encrypted.
                                Signing later will require this password—do not forget it.</p>
                            <p>2. <strong>Restoring a wallet</strong>:
                                - <u>Method 1</u>: Use the original mnemonic language, phrase, password, and wallet path
                                to recover all private keys.
                                - <u>Method 2</u>: Input a single private key (and its decryption password if encrypted)
                                to restore the wallet address.</p>
                        </section>
                        <section>
                            <h1>2. Ethereum Transaction Broadcasting</h1>
                            <p>Navigate to "Ethereum" → "Broadcast Transaction" → "1. Create" to open the page below.
                            </p>
                            <img src="images/etherum_tx.jpg">
                            <p>The "Nonce" indicates the sequential count of outgoing transactions from the wallet
                                (e.g., 0 for the first transaction, 1 for the second). If online, the nonce
                                auto-populates; otherwise, manually enter it (ensure accuracy). Third-party tools can
                                help query the current nonce. For advanced details, refer to <em>Practical Guide to
                                    Secure Cryptocurrency Transactions</em>.</p>
                        </section>
                    </div>
                </details>
                <details class="child">
                    <summary>TOOLS</summary>
                    <div class="window">
                        <p>In the offline wallet, click "Tools" on the left sidebar to access the page shown below.</p>
                        <p><img src="images/tools.jpg"></p>
                        <section>
                            <h1>1. Private Key Encryption</h1>
                            <p>We strongly recommend encrypting your private keys for protection. Encrypted private keys
                                can be stored on your computer, but the password must never be stored alongside
                                them—memorize it or write it down separately. The offline wallet supports direct signing
                                with encrypted private keys, automatically decrypting them during the process. Click
                                "Tools" → "Private Key Encryption" to open the interface below.</p>
                            <img src="images/tools_pri_enc.jpg">
                            <p>This tool can encrypt plaintext private keys into ciphertext or decrypt ciphertext back
                                to plaintext. Given the critical importance of private keys, encrypting them is highly
                                advised. Even if someone obtains the encrypted key, they cannot sign transactions
                                without the password. Remember: You must decrypt the key for each signing attempt, so
                                never forget your password! When copying/pasting private keys, split them into segments
                                (e.g., copy the first half, then the latter half, manually typing a few middle
                                characters) to thwart clipboard spyware. Do not modify "CPU/Memory Cost," "Block Size,"
                                or "Parallelization" unless you fully understand their implications.</p>
                            <p style="color: rgb(213, 5, 5);">After encryption, always verify decryption works. The
                                password, CPU/Memory Cost, Block Size, and Parallelization values must match exactly
                                during both processes—and remember any modified parameters!</p>
                        </section>
                        <section style="background: #F0F0F0;">
                            <h2>2. Custom Mnemonic Phrases</h2>
                            <p>Mnemonic phrases can contain 12, 15, 18, 21, or 24 words—more words enhance security by
                                reducing guessability. By design, mnemonics cannot be fully user-defined because the
                                last word includes a checksum of prior words. Best practice is to let the system
                                generate them randomly. However, our offline wallet allows partial customization: Users
                                may specify some words (blue box in the image), while the system fills the rest. For
                                example, to generate a 15-word Simplified Chinese mnemonic with partial customization,
                                the result might be: "我 是 一 个 大 本 蛋 磁 定 亭 你 呢 叶 纺 途" (see below).</p>
                            <p><img src="images/tools_mnemonic.jpg"></p>
                            <p>Mnemonic words are carefully curated, excluding obscure or easily confused terms (e.g.,
                                "笨" from "笨蛋"). English mnemonics offer broader compatibility; use them unless you have
                                specific preferences.</p>
                        </section>
                        <br><br>
                        <p>Other tools (QR Code Generator, Image Steganography, Digital Signatures/Verification,
                            Encryption/Decryption, UTF8-HEX Conversion) are straightforward and omitted here.</p>
                    </div>
                </details>
            </div>
        </details>

        <details class="parent">
            <summary>OPERATING ENVIRONMENT</summary>
            <div class="window">
                <div style="padding: 1rem 2rem;">
                    <p>Although our open-source offline cryptocurrency wallet is powerful and transparent in operation,
                        it requires a browser to access and operate. This raises several security considerations: Which
                        browser is the most secure? What operating system should the browser run on? What type of
                        computer should the OS run on? Should the computer be connected to the internet? The solutions
                        to these questions constitute the security environment for cryptocurrency transactions. While
                        greater security is always preferable, higher security requirements demand more advanced IT
                        expertise and incur higher costs. Therefore, we have carefully designed several security environments
                        to suit different user needs - choose what fits your situation without blindly pursuing the
                        highest security level.</p>
                    <p>If we rate security on a scale from 1 to 10 (with 10 being most secure), using public wallets and
                        exchange platforms would rank about 3. Our Beginner Environment achieves level 5 security,
                        Intermediate Environment reaches level 7, Advanced Environment achieves level 8, and our Ultimate Environment reaches level 9. For funds under $100,000, public wallets may be acceptable. For hundreds
                        of thousands, Beginner Environment suffices. Millions warrant Intermediate Environment, while tens of
                        millions require Advanced Environment. For larger sums, the Ultimate Environment is strongly
                        recommended.</p>
                </div>
                <details class="child">
                    <summary>Beginner Environment</summary>
                    <div>
                        <section>
                            <h2>Overview</h2>
                            <p>Use Firefox Enterprise Edition on your everyday computer in offline mode, opening the
                                offline cryptocurrency wallet in a private window. Use a separate browser (e.g., Chrome,
                                Edge) for online activities like research and transaction submission.</p>
                        </section>
                        <section>
                            <h2>Detailed Steps</h2>
                            <section style="background: #F0F0F0;">
                                <h3>1. Computer Preparation</h3>
                                <p>We recommend using a desktop or laptop rather than mobile devices (phones/tablets),
                                    as they're least secure. Purchase brand-name computers (Apple, HP, Dell, etc.) from
                                    overseas (including Hong Kong, Macau, Taiwan). Install original Windows OS (from
                                    Microsoft's official site: <a
                                        href="https://www.microsoft.com/zh-cn/software-download/">https://www.microsoft.com</a>),
                                    macOS, or Linux. Avoid installing domestic Chinese software (QQ, WeChat, Sogou Input
                                    Method, etc.), as both hardware and software from China may contain backdoors. The
                                    optimal solution is building your own PC with components and installing Linux
                                    (Debian/Ubuntu) to eliminate potential hardware/OS backdoors and minimize malware
                                    risks.</p>
                                <p>Hardware and OS form the foundation - without secure foundations, complete security
                                    is unachievable.</p>
                            </section>
                            <section>
                                <h3>2. Install Nginx</h3>
                                <p>It is a good idea to enable a web server locally to limit the files that the browser can access. And NGINX is a small and powerful web server; for Windows, please download it from https://nginx.org/download/nginx-1.28.0.zip here, and then unzip it to the D drive, see the figure below.</p>
                                <img src="images/nginx.jpg">
                                <p>Every time you turn on your computer, you have to double-click on the ngnix.exe programme in the picture above to start it.</p>
                            </section>
                            <section style="background: #F0F0F0;">
                                <h3>3. Browser Setup</h3>
                                <p>Strongly recommend Firefox (open-source, high security). Download Firefox ESR
                                    Enterprise Edition from: <a
                                        href="https://www.mozilla.org/en-US/firefox/enterprise/#download">https://www.mozilla.org</a>.
                                    Warning: Never download from third-party sites like firefox.com.cn (potential
                                    backdoors).</p>
                                <p>After installation, right-click the desktop icon <img src="images/firefox.jpg">,
                                    select "Properties," and append "--private-window http://localhost" to the Target
                                    field (see image). Change the icon. This ensures Firefox always launches in private
                                    mode (no history retention).</p>
                                <img src="images/firefox_pri.jpg">
                                <p>Press Alt to show the menu bar, then select File > Work Offline (see image). Note:
                                    You must manually enable offline mode each session.</p>
                                <img src="images/firefox_offline.jpg">
                                <p>Offline mode prevents private key leaks, while private windows erase all traces after
                                    closing. Use Edge/Chrome exclusively for online activities and transaction
                                    broadcasting.</p>
                            </section>
                            <section>
                                <h3>4. Offline Wallet Setup</h3>
                                <p>Download walletoffline.zip from the DOWNLOAD menu below, then extract to your D:
                                    drive (final structure shown).</p>
                                <img src="images/www.jpg">
                                <p>Click on the Firefox icon on your computer's desktop to launch the browser, then you will open the Open Offline Wallet website. Refer to DOCUMENT section above
                                    for detail operational guidance.</p>
                            </section>
                        </section>
                    </div>
                </details>
                <details class="child">
                    <summary>Intermediate Environment</summary>
                    <div>
                        <section>
                            <h2>Overview</h2>
                            <p>Install virtualization software (VirtualBox or VMware) on your work computer and create a
                                virtual machine running Debian Linux. Configure Firefox to work offline within the VM
                                for creating and signing cryptocurrency transactions. Install Chrome separately for
                                broadcasting transactions and external communications. Compared to the beginner
                                approach, this method eliminates potential backdoors, viruses, or spyware from other
                                installed applications. Additionally, VMs are easily backed up and can be launched on
                                other computers when needed.</p>
                        </section>
                        <section>
                            <h2>Detailed Steps</h2>
                            <section style="background: #F0F0F0;">
                                <h3>1. Computer Preparation</h3>
                                <p>Use a desktop or laptop rather than mobile devices (phones/tablets), as they're least
                                    secure. Purchase brand-name computers (Apple, HP, Dell, etc.) from overseas
                                    (including Hong Kong, Macau, Taiwan). Install original Windows OS (from Microsoft's
                                    official site: <a
                                        href="https://www.microsoft.com/zh-cn/software-download/">https://www.microsoft.com</a>),
                                    macOS, or Linux. Avoid installing domestic Chinese software (QQ, WeChat, Sogou Input
                                    Method, etc.), as both hardware and software from China may contain backdoors. The
                                    optimal solution is building your own PC with components and installing Linux
                                    (Debian/Ubuntu) to eliminate potential hardware/OS backdoors and minimize malware
                                    risks.</p>
                                <p>Hardware and OS form the foundation - without secure foundations, complete security
                                    is unachievable.</p>
                            </section>
                            <section>
                                <h3>2. Virtual Machine Setup</h3>
                                <p>VMware Workstation 17.5 is now free for personal use but remains proprietary.
                                    VirtualBox is open-source but owned by Oracle, limiting its "freedom." VMware
                                    Workstation offers better stability, ease of use, and wider adoption.</p>
                                <p>Register at <a href="https://support.broadcom.com/">https://support.broadcom.com/</a>
                                    to download the latest version (currently VMware-workstation-full-17.6.3). Install
                                    and reboot. Press Ctrl+N to create a new VM after launching VMware.</p>
                                <p>Install Debian 12 in the VM (standard installation process), with two critical notes:
                                    (1) Create a 500MB partition and allocate remaining space to root (no swap); (2)
                                    Only install SSH server and standard system utilities.</p>
                                <p>After installation, run these commands to add the LightDM desktop:</p>
                                <pre><code>cat &gt;/etc/apt/sources.list &lt;&lt;EOF
deb http://deb.debian.org/debian bookworm main contrib non-free non-free-firmware
deb http://deb.debian.org/debian bookworm-updates main contrib non-free non-free-firmware
EOF
apt update -y
apt upgrade -y
apt install -y xorg
apt install -y --no-install-recommends xfce4
apt install lightdm -y
apt install -y fonts-wqy-microhei fonts-wqy-zenhei xfce4-terminal cryptsetup vim mousepad nginx
apt install -y firefox-esr --no-install-recommends
shutdown -r now</code></pre>
                                <p>After reboot, log into the graphical desktop. Disable VM copy-paste functionality
                                    (Edit VM Settings > Options > Guest Isolation). Set up encrypted partition:</p>
                                <pre><code>// Initialization:
apt-get install cryptsetup
cryptsetup luksFormat /dev/sda1<span class="comments"># Set password</span>
cryptsetup open /dev/sda1 encdisk
mkfs.ext4 /dev/mapper/encdisk
cryptsetup close encdisk
                    
// Daily use:
cryptsetup open /dev/sda1 encdisk<span class="comments"># Enter password</span>
mount /dev/mapper/encdisk /opt/encrypt
                    
// Unmount after use:
umount /opt/encrypt
cryptsetup close encdisk</code></pre>
                                <p>Disable command history:</p>
                                <pre><code>echo "export HISTFILESIZE=0">>/etc/profile
echo "export HISTSIZE=0">>/etc/profile
history -c</code></pre>
                                <p>Change SSH default port from 22 to 7208:</p>
                                <pre><code>vim /etc/ssh/sshd_config
<i style="color: gray;">……
Port 7208
……</i>
                        
systemctl restart ssh</code></pre>
                                <p>Configure firewall:</p>
                                <pre><code>apt install firewalld -y
systemctl --now enable firewalld
firewall-cmd --set-target=DROP --permanent<span class="comments"># Default deny policy</span>
firewall-cmd --remove-service=ssh --permanent
firewall-cmd --add-port=7208/tcp --permanent
firewall-cmd --remove-forward --permanent<span class="comments"># Disable forwarding</span>
firewall-cmd --add-icmp-block-inversion --permanent<span class="comments"># Disable ping</span>
firewall-cmd --reload</code></pre>
                            </section>
                            <section style="background: #F0F0F0;">
                                <h3>3. Offline Wallet Setup</h3>
                                <p>Download walletoffline.zip from the DOWNLOAD section below and extract to the
                                    /var/www/html directory (result shown below).</p>
                                <p><img src="images/user_www.jpg"></p>
                                <p>Run these commands to modify permissions (only root can make changes):</p>
                                <pre><code>chown -R root:www-data /var/www/html
find /var/www/html -type d -exec chmod 750 {} \;
find /var/www/html -type f -exec chmod 640 {} \;
usermod -a -G www-data user</code></pre>
                            </section>
                            <section>
                                <h3>4. Browser Setup</h3>
                                <p>Install two browsers: Firefox for accessing the offline wallet and Chrome for
                                    internet access and transaction broadcasting. First install Firefox ESR (Extended
                                    Support Release) with:</p>
                                <pre><code>apt install firefox-esr --no-install-recommends</code></pre>
                                <p>Create a desktop launcher that always starts in private mode with this command:</p>
                                <pre><code>/usr/lib/firefox-esr/firefox-esr --private-window http://localhost</code></pre>
                                <p>Download the latest Chrome .deb package from <a
                                        href="https://www.google.com/chrome/dr/download/">https://www.google.com/chrome</a>
                                    and install:</p>
                                <pre><code>dpkg -i google-chrome-stable_current_amd64.deb
apt -f install -y</code></pre>
                                <p>Create a Chrome launcher that routes through a SOCKS5 proxy:</p>
                                <pre><code>/usr/bin/google-chrome-stable --proxy-server="socks5://127.0.0.1:8080"</code></pre>
                            </section>

                            <section style="background: #F0F0F0;">
                                <h3>5. SOCKS5 Proxy Setup</h3>
                                <p>Create an SSH launcher on desktop with this command:</p>
                                <pre><code>/usr/bin/ssh -C -N -D 8080 -i ~/rsa_4096 alice@xx.yy.zzz.xyz</code></pre>
                                <p>Generate SSH key pair:</p>
                                <pre><code>ssh-keygen -q -b 4096 -C "Socks5 VPN" -t rsa -f rsa_4096<span class="comments">#Generate key pair</span>
ssh-copy-id -i rsa_4096.pub alice@xx.yy.zzz.xyz</code></pre>
                                <p>Always start the SOCKS5 proxy via SSH before using Chrome. After connecting, install
                                    MetaMask extension: Click the three-dot menu → "Extensions" → "Visit Chrome Web
                                    Store" → search and install MetaMask. Then create/import a wallet (refer to
                                    <em>Practical Cryptocurrency Security</em> for details).
                                </p>
                            </section>

                            <section>
                                <h3>6. Storing Sensitive Information</h3>
                                <p>Store mnemonics, private keys, and other sensitive data in a file (e.g.,
                                    cryptocurrency.txt), then encrypt and save to the encrypted partition:</p>
                                <pre><code>gpg -c cryptocurrency.txt<span class="comments">#Enter password twice (use strong complexity)</span>
cryptsetup open /dev/sda1 encdisk<span class="comments">#Enter partition password</span>
mount /dev/mapper/encdisk /opt/encrypt
cp cryptocurrency.txt.gpg /opt/encdisk/
rm -rf cryptocurrency.txt</code></pre>
                            </section>

                            <section style="background: #F0F0F0;">
                                <h3>7. Finalization</h3>
                                <h4>7.1 Disk Cleanup</h4>
                                <p>Remove unnecessary files and zero out free space:</p>
                                <pre><code>apt clean
apt autoremove --purge
journalctl --vacuum-time=1d
rm -rf /var/log/*.gz /var/log/*.old /var/log/*.log /var/log/apt/*
rm -rf /usr/share/doc/* /usr/share/man/* /usr/share/info/*
rm -rf /tmp/* /var/tmp/*
dd if=/dev/zero of=/file.zero
rm -rf /file.zero
shutdown -h now</code></pre>
                                <p>Then defragment the VM disk in VMware:</p>
                                <p><img src="images/shrink_vm.jpg"></p>
                            </section>

                            <section style="background: #F0F0F0;">
                                <h4>7.2 Disk Immutability</h4>
                                <p>Configure the VM to discard all changes after shutdown:</p>
                                <p><img src="images/rom_vm.jpg"></p>
                            </section>

                            <section>
                                <h4>7.3 Boot Encryption</h4>
                                <p>Encrypt the VM disk so copied VMs cannot be started or accessed without the password
                                    (use long/complex passwords). This requires entering the password at every VM
                                    startup.</p>
                                <p><img src="images/security_vm.jpg"></p><br><br>
                                <p>Back up the VM by compressing its host directory (typically under 1GB).</p>
                            </section>
                    </div>
                </details>
                <details class="child">
                    <summary>Advanced Environment</summary>
                    <div>
                        <section>
                            <h2>Overview</h2>
                            <p>The advanced trading setup employs comprehensive security enhancements: Transactions are
                                signed on a completely air-gapped computer, while signed transactions are broadcast from
                                a separate internet-connected machine. All web browsing and transaction broadcasting
                                routes through the Tor network. In mainland China, Tor access requires VPN tunneling.
                                Thus, we use three computers—or virtual machines (VMs) for equivalent security with
                                greater convenience—each running Debian Linux. The architecture is shown below:</p>
                            <p><img src="images/advanced.jpg"></p>
                            <p>Transactions are created and signed on the offline machine, while UTXO queries, balance
                                checks, and transaction broadcasting occur on the online machine—all traffic routed
                                through the Tor gateway. This gateway establishes an encrypted tunnel to a VPN server,
                                with Tor clients connecting via VPN → Tor entry node → Tor middle node → Tor exit node →
                                Internet. This dual-layer obfuscation enhances anonymity.</p>
                            <p>We use VirtualBox (open-source) to create three VMs: offline signing machine, transaction
                                broadcasting machine, and Tor gateway.</p>
                        </section>
                        <section>
                            <h2>Detailed Steps</h2>
                            <section style="background: #F0F0F0;">
                                <h3>1. Install VirtualBox</h3>
                                <p>Download VirtualBox from <a
                                        href="https://download.virtualbox.org/virtualbox/7.1.10/VirtualBox-7.1.10-169112-Win.exe">https://download.virtualbox.org</a>
                                    and install. Then get the Extension Pack (enables disk encryption) from <a
                                        href="https://download.virtualbox.org/virtualbox/7.1.10/Oracle_VirtualBox_Extension_Pack-7.1.10-169112.vbox-extpack">https://download.virtualbox.org</a>
                                    and double-click to install. Launch VirtualBox after installation.</p>
                            </section>
                            <section>
                                <h3>2. Import Whonix</h3>
                                <p>We deploy Whonix—a Debian 12-based OS preconfigured with Tor, renowned as the world's
                                    most privacy-focused operating system. Download the appropriate OVA file from <a
                                        href="https://www.whonix.org/wiki/Download">https://www.whonix.org</a> (e.g., <a
                                        href="https://www.whonix.org/download/ova/17.3.9.9/Whonix-Xfce-17.3.9.9.Intel_AMD64.ova">Whonix-Xfce-17.3.9.9.Intel_AMD64.ova</a>).
                                    In VirtualBox, press Ctrl+I to import the downloaded Whonix image (see below).</p>
                                <p><img src="images/virtualbox_import.jpg"></p>
                                <p>The <strong>Whonix-Gateway-XFCE</strong> VM serves as the Tor gateway (preconfigured;
                                    just launch it). <strong>Whonix-Workstation-XFCE</strong> is the online
                                    workstation—all its internet traffic routes through Tor for activities like
                                    broadcasting signed transactions, checking balances, and communications.</p>
                            </section>
                            <section style="background: #F0F0F0;">
                                <h3>3. Tor Gateway Setup</h3>
                                <p>For detailed configuration, refer to <em>Practical Cryptocurrency Security</em>.</p>
                            </section>
                            <section style="background: #F0F0F0;">
                                <h3>4. Online Workstation Prep</h3>
                                <p>For detailed configuration, refer to <em>Practical Cryptocurrency Security</em>.</p>
                            </section>
                            <section>
                                <h3>5. Offline Signing Machine</h3>
                                <p>For detailed configuration, refer to <em>Practical Cryptocurrency Security</em>.</p>
                            </section>
                            <section style="background: #F0F0F0;">
                                <h3>6. VM Backup & Recovery</h3>
                                <p>For detailed configuration, refer to <em>Practical Cryptocurrency Security</em>.</p>
                            </section>
                        </section>
                    </div>
                </details>
                <details class="child">
                    <summary>Ultimate Environment</summary>
                    <div>
                        <section>
                            <h1>Overview</h1>
                            <p>Two approaches are available:<br>
                                <span style="padding-left: 4rem;">Option 1: Employ multiple Raspberry Pi devices to
                                    achieve military-grade hardware-level security.</span><br>
                                <span style="padding-left: 4rem;">Option 2: Use x86 architecture bare-metal computers
                                    (16GB+ RAM) with Qubes OS installed on USB drives, subsequently configuring Whonix
                                    within Qubes OS.</span>
                            </p>
                            <p>We implement Option 2: Install Qubes OS on USB drives, then create four qubes within
                                Qubes OS. The first runs Whonix-Gateway as a Tor gateway, the second hosts
                                Whonix-WorkStation as the online workstation, the third installs Debian to store
                                sensitive materials (e.g., private keys) and handles transaction signing—remaining
                                permanently offline. The fourth runs Debian for processing online materials without
                                routing through Tor.
                            </p>
                            <p>Maintain at least two identical copies of the USB drive.</p>
                        </section>
                        <section>
                            <h1>Detailed Steps</h1>
                            <section style="background: #F0F0F0;">
                                <h2>1. Hardware Preparation</h2>
                                <p>(1) Computer: x86 CPU (Intel/AMD), 16GB+ RAM, minimum 32GB storage, with VT-x/VT-d
                                    virtualization enabled in BIOS.</p>
                                <p>(2) USB Drives: Procure two Corsair CMFSS3B-256GB Flash Survivor Stealth 256GB USB
                                    3.0 Flash Drives (waterproof, EMI-shielded, shock-resistant) via Amazon or overseas
                                    suppliers.</p>
                            </section>
                            <section>
                                <h2>2. Create Qubes OS Installation Media</h2>
                                <p>Download Qubes-R4.2.4-x86_64.iso from
                                    https://mirrors.edge.kernel.org/qubes/iso/Qubes-R4.2.4-x86_64.iso. Obtain the Rufus
                                    flashing tool (v4.7) from
                                    https://github.com/pbatard/rufus/releases/download/v4.7/rufus-4.7.exe. Follow the
                                    operational steps shown in Figure 9-3.</p>
                                <p><img src="images/rufus.jpg"></p>
                            </section>
                            <section style="background: #F0F0F0;">
                                <h2>3. Qubes Architecture</h2>
                                <p>The overall architecture is illustrated below.</p>
                                <p><img src="images/qubes.jpg"></p>
                                <p>sys-usb manages all USB devices and can be attached to any running VM. The app-online
                                    VM handles routine internet tasks with optional VPN or direct connection.</p>
                            </section>
                            <section>
                                <h2>4. Install Qubes OS</h2>
                                <p>For detailed installation procedures, refer to the book "Secure Cryptocurrency
                                    Trading in Practice"</p>
                            </section>

                            <section>
                                <h2>5. Create and Configure Qubes</h2>
                                <p>For detailed configuration methods, refer to the book "Secure Cryptocurrency Trading
                                    in Practice"</p>
                            </section>
                        </section>
                    </div>
                </details>
            </div>
        </details>

        <details class="parent">
            <summary>DOWNLOAD</summary>
            <div style="background-color: rgb(255, 239, 211);">
                <p>Our GPG key fingerprint is: 823C 41F5 9DF0 64A5 FC40 615B 16E1 4CE7 68C0 F602. Download the signature
                    verification public key from <a href="./downloads/walletoffline_public_key.asc"
                        download="walletoffline_public_key.asc">here</a>. We strongly recommend verifying the
                    cryptographic signature of all downloaded resources using these commands:</p>

                <pre
                    style="font-size: 14px; color: gray;"><code>gpg --import walletoffline_public_key.asc<span style="float: right;"># Import public key</span>
gpg --verify &lt;resource_filename&gt;.sig &lt;resource_filename&gt;<span style="float: right;"># Place resource and signature in same directory</span></code></pre>

                <div class="window" style="display: flex;flex-wrap: wrap;">
                    <div class="resources">
                        <fieldset>
                            <legend>Open Source Offline Wallet</legend>
                            <div style="font-size: 0.8rem;">
                                File:<br><a href="./downloads/walletoffline.zip" style="float: right;"
                                    download="walletoffline.zip">walletoffline.zip</a><br><br>
                                Signature:<br><a href="./downloads/walloffline.rar.sig" style="float: right;"
                                    download="walloffline.rar.sig">walletoffline.zip.sig</a>
                            </div>
                        </fieldset>
                    </div>
                    <!--div class="resources">
                        <fieldset style="height: 160px;">
                            <legend>开放离线钱包</legend>
                        </fieldset>
                    </div-->
                </div>
            </div>
        </details>
        <section
            style="padding: 20px 60px; color: white; font-size: 1.5rem; line-height: 2em;text-shadow: 1px 1px #333; text-indent: 2em;">
            Open-Source Offline Crypto Wallet - Take Full Control of Every Wallet and Transaction Detail to Ensure
            Uncompromised Private Key Security. Key Distinctive Advantages:
            <div style="display: flex;font-size: 1.2rem;flex-wrap: wrap; line-height: 2rem; text-indent: 0px;">
                <fieldset class="good">
                    <legend>Advantage 1: Customizable Mnemonic Phrase</legend>
                    <ul>
                        <li>Define custom word count</li>
                        <li>Choose mnemonic language</li>
                        <li>Specify partial word sets</li>
                        <li>Set mnemonic passphrase protection</li>
                    </ul>
                </fieldset>
                <fieldset class="good">
                    <legend>Advantage 2: Customizable HD Wallet</legend>
                    <ul>
                        <li>Define custom derivation paths</li>
                        <li>Support non-standard wallet paths</li>
                        <li>Recover wallet from mnemonic phrase</li>
                        <li>Restore wallet from seed value</li>
                        <li>Recover wallet from root xprv</li>
                    </ul>
                </fieldset>
                <fieldset class="good">
                    <legend>Advantage 3: Absolute Private Key Control</legend>
                    <ul>
                        <li>Full ownership of private keys</li>
                        <li>Encrypted private key protection</li>
                        <li>Derive addresses anytime from keys</li>
                        <li>Single private key for multiple cryptocurrencies</li>
                        <li>Direct signing with encrypted keys</li>
                    </ul>
                </fieldset>
                <fieldset class="good">
                    <legend>Advantage 4: Complete Transaction Control</legend>
                    <ul>
                        <li>Construct complex transactions easily</li>
                        <li>Customize transaction fees</li>
                        <li>End-to-end signing process control</li>
                        <li>Immutable blockchain data storage</li>
                    </ul>
                </fieldset>
                <fieldset class="good">
                    <legend>Advantage 5: Flexible Address Formats</legend>
                    <ul>
                        <li>Derive all Bitcoin address types from single key</li>
                        <li>Ethereum ENS domain support</li>
                        <li>Generate Bitcoin multisig addresses</li>
                        <li>Create P2TR keys and Taproot addresses</li>
                        <li>Easy QR code generation</li>
                    </ul>
                </fieldset>
            </div>
        </section>
    </main>
    <footer>
        <div class="footer-column">
            <h3>Contacts</h3>
            <p>Email:&nbsp;help@walletoffline.com</p>
        </div>
        <div class="footer-column">
            <h3>Support</h3>
            <ul style="padding-left: 2rem;">
                <li><a href="https://github.com/veryopen/walletoffline" target="_blank">Github</a></li>
                <!--li><a href="/qa.html">Q&A</a></li -->
            </ul>
        </div>
        <div class="footer-column">
            <h3>Donate to</h3>
            <p style="position: relative;"><img src="images/52px-BC_Logo_.png"
                    style="height: 16px; display: inline-block; position: absolute;left: 10px;">Bitcoin:
                bc1qxmxjgp3389rujuyv7v7wgng6nxf7w4lpsmu729<img src="images/Qr-logo-v2.png" id="small_btc_qr"><img
                    src="images/bitcoin_qrcode.jpg" id="large_btc_qr"></p>
            <p style="position: relative;"><img src="images/52px-Ethereumlogo.png"
                    style="height: 16px; display: inline-block; position: absolute;left: 10px;">Ethereum:
                0x6E129a13F7bc11C7afedcF00CC7F0aF0562F870a（823456.eth）<img src="images/Qr-logo-v2.png"
                    id="small_eth_qr"><img src="images/ethereum_qrcode.jpg" id="large_eth_qr"></p>
        </div>
    </footer>
    <!--/div-->
</body>
<script src="js/wallet.js"></script>

</html>