(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.bip174=e()}})(function(){var e,t,r;return function(){function c(o,u,s){function f(r,e){if(!u[r]){if(!o[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(a)return a(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=u[r]={exports:{}};o[r][0].call(i.exports,function(e){var t=o[r][1][e];return f(t||e)},i,i.exports,c,o,u,s)}return u[r].exports}for(var a="function"==typeof require&&require,e=0;e<s.length;e++)f(s[e]);return f}return c}()({1:[function(e,t,r){"use strict";r.byteLength=u;r.toByteArray=s;r.fromByteArray=y;var f=[];var a=[];var c=typeof Uint8Array!=="undefined"?Uint8Array:Array;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,o=n.length;i<o;++i){f[i]=n[i];a[n.charCodeAt(i)]=i}a["-".charCodeAt(0)]=62;a["_".charCodeAt(0)]=63;function l(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var r=e.indexOf("=");if(r===-1)r=t;var n=r===t?0:4-r%4;return[r,n]}function u(e){var t=l(e);var r=t[0];var n=t[1];return(r+n)*3/4-n}function p(e,t,r){return(t+r)*3/4-r}function s(e){var t;var r=l(e);var n=r[0];var i=r[1];var o=new c(p(e,n,i));var u=0;var s=i>0?n-4:n;var f;for(f=0;f<s;f+=4){t=a[e.charCodeAt(f)]<<18|a[e.charCodeAt(f+1)]<<12|a[e.charCodeAt(f+2)]<<6|a[e.charCodeAt(f+3)];o[u++]=t>>16&255;o[u++]=t>>8&255;o[u++]=t&255}if(i===2){t=a[e.charCodeAt(f)]<<2|a[e.charCodeAt(f+1)]>>4;o[u++]=t&255}if(i===1){t=a[e.charCodeAt(f)]<<10|a[e.charCodeAt(f+1)]<<4|a[e.charCodeAt(f+2)]>>2;o[u++]=t>>8&255;o[u++]=t&255}return o}function h(e){return f[e>>18&63]+f[e>>12&63]+f[e>>6&63]+f[e&63]}function d(e,t,r){var n;var i=[];for(var o=t;o<r;o+=3){n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255);i.push(h(n))}return i.join("")}function y(e){var t;var r=e.length;var n=r%3;var i=[];var o=16383;for(var u=0,s=r-n;u<s;u+=o){i.push(d(e,u,u+o>s?s:u+o))}if(n===1){t=e[r-1];i.push(f[t>>2]+f[t<<4&63]+"==")}else if(n===2){t=(e[r-2]<<8)+e[r-1];i.push(f[t>>10]+f[t>>4&63]+f[t<<2&63]+"=")}return i.join("")}},{}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});const d=e("../parser");function n(e){const t=e[0];const r=d.psbtToKeyVals(t);const n=e.slice(1);if(n.length===0)throw new Error("Combine: Nothing to combine");const i=g(t);if(i===undefined){throw new Error("Combine: Self missing transaction")}const o=b(r.globalKeyVals);const u=r.inputKeyVals.map(b);const s=r.outputKeyVals.map(b);for(const f of n){const a=g(f);if(a===undefined||!a.toBuffer().equals(i.toBuffer())){throw new Error("Combine: One of the Psbts does not have the same transaction.")}const c=d.psbtToKeyVals(f);const l=b(c.globalKeyVals);l.forEach(y(o,r.globalKeyVals,c.globalKeyVals));const p=c.inputKeyVals.map(b);p.forEach((e,t)=>e.forEach(y(u[t],r.inputKeyVals[t],c.inputKeyVals[t])));const h=c.outputKeyVals.map(b);h.forEach((e,t)=>e.forEach(y(s[t],r.outputKeyVals[t],c.outputKeyVals[t])))}return d.psbtFromKeyVals(i,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}r.combine=n;function y(r,n,i){return t=>{if(r.has(t))return;const e=i.filter(e=>e.key.toString("hex")===t)[0];n.push(e);r.add(t)}}function g(e){return e.globalMap.unsignedTx}function b(e){const r=new Set;e.forEach(e=>{const t=e.key.toString("hex");if(r.has(t))throw new Error("Combine: KeyValue Map keys should be unique");r.add(t)});return r}},{"../parser":27}],3:[function(i,e,o){(function(u){(function(){"use strict";Object.defineProperty(o,"__esModule",{value:true});const s=i("../../typeFields");const f=e=>[...Array(e).keys()];function e(e){if(e.key[0]!==s.GlobalTypes.GLOBAL_XPUB){throw new Error("Decode Error: could not decode globalXpub with key 0x"+e.key.toString("hex"))}if(e.key.length!==79||![2,3].includes(e.key[46])){throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+e.key.toString("hex"))}if(e.value.length/4%1!==0){throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4")}const t=e.key.slice(1);const r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(const n of f(e.value.length/4-1)){const i=e.value.readUInt32LE(n*4+4);const o=!!(i&2147483648);const u=i&2147483647;r.path+="/"+u.toString(10)+(o?"'":"")}return r}o.decode=e;function t(e){const t=u.from([s.GlobalTypes.GLOBAL_XPUB]);const r=u.concat([t,e.extendedPubkey]);const n=e.path.split("/");const i=u.allocUnsafe(n.length*4);e.masterFingerprint.copy(i,0);let o=4;n.slice(1).forEach(e=>{const t=e.slice(-1)==="'";let r=2147483647&parseInt(t?e.slice(0,-1):e,10);if(t)r+=2147483648;i.writeUInt32LE(r,o);o+=4});return{key:r,value:i}}o.encode=t;o.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }";function r(e){const t=e.extendedPubkey;const r=e.masterFingerprint;const n=e.path;return u.isBuffer(t)&&t.length===78&&[2,3].indexOf(t[45])>-1&&u.isBuffer(r)&&r.length===4&&typeof n==="string"&&!!n.match(/^m(\/\d+'?)*$/)}o.check=r;function n(e,t,r){const n=t.extendedPubkey.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.extendedPubkey.equals(t.extendedPubkey)).length===0}o.canAddToArray=n}).call(this)}).call(this,i("buffer").Buffer)},{"../../typeFields":29,buffer:31}],4:[function(n,e,i){(function(r){(function(){"use strict";Object.defineProperty(i,"__esModule",{value:true});const t=n("../../typeFields");function e(e){return{key:r.from([t.GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}i.encode=e}).call(this)}).call(this,n("buffer").Buffer)},{"../../typeFields":29,buffer:31}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});const n=e("../typeFields");const i=e("./global/globalXpub");const o=e("./global/unsignedTx");const u=e("./input/finalScriptSig");const s=e("./input/finalScriptWitness");const f=e("./input/nonWitnessUtxo");const a=e("./input/partialSig");const c=e("./input/porCommitment");const l=e("./input/sighashType");const p=e("./input/tapKeySig");const h=e("./input/tapLeafScript");const d=e("./input/tapMerkleRoot");const y=e("./input/tapScriptSig");const g=e("./input/witnessUtxo");const b=e("./output/tapTree");const w=e("./shared/bip32Derivation");const E=e("./shared/checkPubkey");const T=e("./shared/redeemScript");const v=e("./shared/tapBip32Derivation");const I=e("./shared/tapInternalKey");const k=e("./shared/witnessScript");const S={unsignedTx:o,globalXpub:i,checkPubkey:E.makeChecker([])};r.globals=S;const m={nonWitnessUtxo:f,partialSig:a,sighashType:l,finalScriptSig:u,finalScriptWitness:s,porCommitment:c,witnessUtxo:g,bip32Derivation:w.makeConverter(n.InputTypes.BIP32_DERIVATION),redeemScript:T.makeConverter(n.InputTypes.REDEEM_SCRIPT),witnessScript:k.makeConverter(n.InputTypes.WITNESS_SCRIPT),checkPubkey:E.makeChecker([n.InputTypes.PARTIAL_SIG,n.InputTypes.BIP32_DERIVATION]),tapKeySig:p,tapScriptSig:y,tapLeafScript:h,tapBip32Derivation:v.makeConverter(n.InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:I.makeConverter(n.InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot:d};r.inputs=m;const _={bip32Derivation:w.makeConverter(n.OutputTypes.BIP32_DERIVATION),redeemScript:T.makeConverter(n.OutputTypes.REDEEM_SCRIPT),witnessScript:k.makeConverter(n.OutputTypes.WITNESS_SCRIPT),checkPubkey:E.makeChecker([n.OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:v.makeConverter(n.OutputTypes.TAP_BIP32_DERIVATION),tapTree:b,tapInternalKey:I.makeConverter(n.OutputTypes.TAP_INTERNAL_KEY)};r.outputs=_},{"../typeFields":29,"./global/globalXpub":3,"./global/unsignedTx":4,"./input/finalScriptSig":6,"./input/finalScriptWitness":7,"./input/nonWitnessUtxo":8,"./input/partialSig":9,"./input/porCommitment":10,"./input/sighashType":11,"./input/tapKeySig":12,"./input/tapLeafScript":13,"./input/tapMerkleRoot":14,"./input/tapScriptSig":15,"./input/witnessUtxo":16,"./output/tapTree":17,"./shared/bip32Derivation":18,"./shared/checkPubkey":19,"./shared/redeemScript":20,"./shared/tapBip32Derivation":21,"./shared/tapInternalKey":22,"./shared/witnessScript":23}],6:[function(u,e,s){(function(o){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const r=u("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.FINAL_SCRIPTSIG){throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+e.key.toString("hex"))}return e.value}s.decode=e;function t(e){const t=o.from([r.InputTypes.FINAL_SCRIPTSIG]);return{key:t,value:e}}s.encode=t;s.expected="Buffer";function n(e){return o.isBuffer(e)}s.check=n;function i(e,t){return!!e&&!!t&&e.finalScriptSig===undefined}s.canAdd=i}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":29,buffer:31}],7:[function(u,e,s){(function(o){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const r=u("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.FINAL_SCRIPTWITNESS){throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+e.key.toString("hex"))}return e.value}s.decode=e;function t(e){const t=o.from([r.InputTypes.FINAL_SCRIPTWITNESS]);return{key:t,value:e}}s.encode=t;s.expected="Buffer";function n(e){return o.isBuffer(e)}s.check=n;function i(e,t){return!!e&&!!t&&e.finalScriptWitness===undefined}s.canAdd=i}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":29,buffer:31}],8:[function(u,e,s){(function(o){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const t=u("../../typeFields");function e(e){if(e.key[0]!==t.InputTypes.NON_WITNESS_UTXO){throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+e.key.toString("hex"))}return e.value}s.decode=e;function r(e){return{key:o.from([t.InputTypes.NON_WITNESS_UTXO]),value:e}}s.encode=r;s.expected="Buffer";function n(e){return o.isBuffer(e)}s.check=n;function i(e,t){return!!e&&!!t&&e.nonWitnessUtxo===undefined}s.canAdd=i}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":29,buffer:31}],9:[function(s,e,f){(function(u){(function(){"use strict";Object.defineProperty(f,"__esModule",{value:true});const r=s("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.PARTIAL_SIG){throw new Error("Decode Error: could not decode partialSig with key 0x"+e.key.toString("hex"))}if(!(e.key.length===34||e.key.length===66)||![2,3,4].includes(e.key[1])){throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+e.key.toString("hex"))}const t=e.key.slice(1);return{pubkey:t,signature:e.value}}f.decode=e;function t(e){const t=u.from([r.InputTypes.PARTIAL_SIG]);return{key:u.concat([t,e.pubkey]),value:e.signature}}f.encode=t;f.expected="{ pubkey: Buffer; signature: Buffer; }";function n(e){return u.isBuffer(e.pubkey)&&u.isBuffer(e.signature)&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&i(e.signature)}f.check=n;function i(e){if(!u.isBuffer(e)||e.length<9)return false;if(e[0]!==48)return false;if(e.length!==e[1]+3)return false;if(e[2]!==2)return false;const t=e[3];if(t>33||t<1)return false;if(e[3+t+1]!==2)return false;const r=e[3+t+2];if(r>33||r<1)return false;if(e.length!==3+t+2+r+2)return false;return true}function o(e,t,r){const n=t.pubkey.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.pubkey.equals(t.pubkey)).length===0}f.canAddToArray=o}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":29,buffer:31}],10:[function(u,e,s){(function(o){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const r=u("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.POR_COMMITMENT){throw new Error("Decode Error: could not decode porCommitment with key 0x"+e.key.toString("hex"))}return e.value.toString("utf8")}s.decode=e;function t(e){const t=o.from([r.InputTypes.POR_COMMITMENT]);return{key:t,value:o.from(e,"utf8")}}s.encode=t;s.expected="string";function n(e){return typeof e==="string"}s.check=n;function i(e,t){return!!e&&!!t&&e.porCommitment===undefined}s.canAdd=i}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":29,buffer:31}],11:[function(u,e,s){(function(o){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const n=u("../../typeFields");function e(e){if(e.key[0]!==n.InputTypes.SIGHASH_TYPE){throw new Error("Decode Error: could not decode sighashType with key 0x"+e.key.toString("hex"))}return e.value.readUInt32LE(0)}s.decode=e;function t(e){const t=o.from([n.InputTypes.SIGHASH_TYPE]);const r=o.allocUnsafe(4);r.writeUInt32LE(e,0);return{key:t,value:r}}s.encode=t;s.expected="number";function r(e){return typeof e==="number"}s.check=r;function i(e,t){return!!e&&!!t&&e.sighashType===undefined}s.canAdd=i}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":29,buffer:31}],12:[function(u,e,s){(function(o){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const r=u("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.TAP_KEY_SIG||e.key.length!==1){throw new Error("Decode Error: could not decode tapKeySig with key 0x"+e.key.toString("hex"))}if(!n(e.value)){throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature")}return e.value}s.decode=e;function t(e){const t=o.from([r.InputTypes.TAP_KEY_SIG]);return{key:t,value:e}}s.encode=t;s.expected="Buffer";function n(e){return o.isBuffer(e)&&(e.length===64||e.length===65)}s.check=n;function i(e,t){return!!e&&!!t&&e.tapKeySig===undefined}s.canAdd=i}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":29,buffer:31}],13:[function(u,e,s){(function(o){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const i=u("../../typeFields");function e(e){if(e.key[0]!==i.InputTypes.TAP_LEAF_SCRIPT){throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+e.key.toString("hex"))}if((e.key.length-2)%32!==0){throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+e.key.toString("hex"))}const t=e.value[e.value.length-1];if((e.key[1]&254)!==t){throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+e.key.toString("hex"))}const r=e.value.slice(0,-1);const n=e.key.slice(1);return{controlBlock:n,script:r,leafVersion:t}}s.decode=e;function t(e){const t=o.from([i.InputTypes.TAP_LEAF_SCRIPT]);const r=o.from([e.leafVersion]);return{key:o.concat([t,e.controlBlock]),value:o.concat([e.script,r])}}s.encode=t;s.expected="{ controlBlock: Buffer; leafVersion: number, script: Buffer; }";function r(e){return o.isBuffer(e.controlBlock)&&(e.controlBlock.length-1)%32===0&&(e.controlBlock[0]&254)===e.leafVersion&&o.isBuffer(e.script)}s.check=r;function n(e,t,r){const n=t.controlBlock.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.controlBlock.equals(t.controlBlock)).length===0}s.canAddToArray=n}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":29,buffer:31}],14:[function(u,e,s){(function(o){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const r=u("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.TAP_MERKLE_ROOT||e.key.length!==1){throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+e.key.toString("hex"))}if(!n(e.value)){throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash")}return e.value}s.decode=e;function t(e){const t=o.from([r.InputTypes.TAP_MERKLE_ROOT]);return{key:t,value:e}}s.encode=t;s.expected="Buffer";function n(e){return o.isBuffer(e)&&e.length===32}s.check=n;function i(e,t){return!!e&&!!t&&e.tapMerkleRoot===undefined}s.canAdd=i}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":29,buffer:31}],15:[function(u,e,s){(function(o){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const n=u("../../typeFields");function e(e){if(e.key[0]!==n.InputTypes.TAP_SCRIPT_SIG){throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+e.key.toString("hex"))}if(e.key.length!==65){throw new Error("Decode Error: tapScriptSig has invalid key 0x"+e.key.toString("hex"))}if(e.value.length!==64&&e.value.length!==65){throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+e.key.toString("hex"))}const t=e.key.slice(1,33);const r=e.key.slice(33);return{pubkey:t,leafHash:r,signature:e.value}}s.decode=e;function t(e){const t=o.from([n.InputTypes.TAP_SCRIPT_SIG]);return{key:o.concat([t,e.pubkey,e.leafHash]),value:e.signature}}s.encode=t;s.expected="{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }";function r(e){return o.isBuffer(e.pubkey)&&o.isBuffer(e.leafHash)&&o.isBuffer(e.signature)&&e.pubkey.length===32&&e.leafHash.length===32&&(e.signature.length===64||e.signature.length===65)}s.check=r;function i(e,t,r){const n=t.pubkey.toString("hex")+t.leafHash.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.pubkey.equals(t.pubkey)&&e.leafHash.equals(t.leafHash)).length===0}s.canAddToArray=i}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":29,buffer:31}],16:[function(i,e,a){(function(f){(function(){"use strict";Object.defineProperty(a,"__esModule",{value:true});const o=i("../../typeFields");const u=i("../tools");const s=i("../varint");function e(e){if(e.key[0]!==o.InputTypes.WITNESS_UTXO){throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+e.key.toString("hex"))}const t=u.readUInt64LE(e.value,0);let r=8;const n=s.decode(e.value,r);r+=s.encodingLength(n);const i=e.value.slice(r);if(i.length!==n){throw new Error("Decode Error: WITNESS_UTXO script is not proper length")}return{script:i,value:t}}a.decode=e;function t(e){const{script:t,value:r}=e;const n=s.encodingLength(t.length);const i=f.allocUnsafe(8+n+t.length);u.writeUInt64LE(i,r,0);s.encode(t.length,i,8);t.copy(i,8+n);return{key:f.from([o.InputTypes.WITNESS_UTXO]),value:i}}a.encode=t;a.expected="{ script: Buffer; value: number; }";function r(e){return f.isBuffer(e.script)&&typeof e.value==="number"}a.check=r;function n(e,t){return!!e&&!!t&&e.witnessUtxo===undefined}a.canAdd=n}).call(this)}).call(this,i("buffer").Buffer)},{"../../typeFields":29,"../tools":24,"../varint":25,buffer:31}],17:[function(o,e,f){(function(i){(function(){"use strict";Object.defineProperty(f,"__esModule",{value:true});const u=o("../../typeFields");const s=o("../varint");function e(e){if(e.key[0]!==u.OutputTypes.TAP_TREE||e.key.length!==1){throw new Error("Decode Error: could not decode tapTree with key 0x"+e.key.toString("hex"))}let t=0;const r=[];while(t<e.value.length){const n=e.value[t++];const i=e.value[t++];const o=s.decode(e.value,t);t+=s.encodingLength(o);r.push({depth:n,leafVersion:i,script:e.value.slice(t,t+o)});t+=o}return{leaves:r}}f.decode=e;function t(e){const t=i.from([u.OutputTypes.TAP_TREE]);const r=[].concat(...e.leaves.map(e=>[i.of(e.depth,e.leafVersion),s.encode(e.script.length),e.script]));return{key:t,value:i.concat(r)}}f.encode=t;f.expected="{ leaves: [{ depth: number; leafVersion: number, script: Buffer; }] }";function r(e){return Array.isArray(e.leaves)&&e.leaves.every(e=>e.depth>=0&&e.depth<=128&&(e.leafVersion&254)===e.leafVersion&&i.isBuffer(e.script))}f.check=r;function n(e,t){return!!e&&!!t&&e.tapTree===undefined}f.canAdd=n}).call(this)}).call(this,o("buffer").Buffer)},{"../../typeFields":29,"../varint":25,buffer:31}],18:[function(e,t,r){(function(u){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const a=e=>[...Array(e).keys()];const o=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&4===e[0];function e(s,f=o){function e(e){if(e.key[0]!==s){throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+e.key.toString("hex"))}const t=e.key.slice(1);if(!f(t)){throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+e.key.toString("hex"))}if(e.value.length/4%1!==0){throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4")}const r={masterFingerprint:e.value.slice(0,4),pubkey:t,path:"m"};for(const n of a(e.value.length/4-1)){const i=e.value.readUInt32LE(n*4+4);const o=!!(i&2147483648);const u=i&2147483647;r.path+="/"+u.toString(10)+(o?"'":"")}return r}function t(e){const t=u.from([s]);const r=u.concat([t,e.pubkey]);const n=e.path.split("/");const i=u.allocUnsafe(n.length*4);e.masterFingerprint.copy(i,0);let o=4;n.slice(1).forEach(e=>{const t=e.slice(-1)==="'";let r=2147483647&parseInt(t?e.slice(0,-1):e,10);if(t)r+=2147483648;i.writeUInt32LE(r,o);o+=4});return{key:r,value:i}}const r="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }";function n(e){return u.isBuffer(e.pubkey)&&u.isBuffer(e.masterFingerprint)&&typeof e.path==="string"&&f(e.pubkey)&&e.masterFingerprint.length===4}function i(e,t,r){const n=t.pubkey.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.pubkey.equals(t.pubkey)).length===0}return{decode:e,encode:t,check:n,expected:r,canAddToArray:i}}r.makeConverter=e}).call(this)}).call(this,e("buffer").Buffer)},{buffer:31}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});function n(r){return e;function e(e){let t;if(r.includes(e.key[0])){t=e.key.slice(1);if(!(t.length===33||t.length===65)||![2,3,4].includes(t[0])){throw new Error("Format Error: invalid pubkey in key 0x"+e.key.toString("hex"))}}return t}}r.makeChecker=n},{}],20:[function(e,t,r){(function(u){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});function e(r){function e(e){if(e.key[0]!==r){throw new Error("Decode Error: could not decode redeemScript with key 0x"+e.key.toString("hex"))}return e.value}function t(e){const t=u.from([r]);return{key:t,value:e}}const n="Buffer";function i(e){return u.isBuffer(e)}function o(e,t){return!!e&&!!t&&e.redeemScript===undefined}return{decode:e,encode:t,check:i,expected:n,canAdd:o}}r.makeConverter=e}).call(this)}).call(this,e("buffer").Buffer)},{buffer:31}],21:[function(t,e,r){(function(a){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const s=t("../varint");const o=t("./bip32Derivation");const f=e=>e.length===32;function e(e){const u=o.makeConverter(e,f);function t(r){const n=s.decode(r.value);const i=s.encodingLength(n);const e=u.decode({key:r.key,value:r.value.slice(i+n*32)});const o=new Array(n);for(let e=0,t=i;e<n;e++,t+=32){o[e]=r.value.slice(t,t+32)}return Object.assign({},e,{leafHashes:o})}function r(e){const t=u.encode(e);const r=s.encodingLength(e.leafHashes.length);const n=a.allocUnsafe(r);s.encode(e.leafHashes.length,n);const i=a.concat([n,...e.leafHashes,t.value]);return Object.assign({},t,{value:i})}const n="{ "+"masterFingerprint: Buffer; "+"pubkey: Buffer; "+"path: string; "+"leafHashes: Buffer[]; "+"}";function i(e){return Array.isArray(e.leafHashes)&&e.leafHashes.every(e=>a.isBuffer(e)&&e.length===32)&&u.check(e)}return{decode:t,encode:r,check:i,expected:n,canAddToArray:u.canAddToArray}}r.makeConverter=e}).call(this)}).call(this,t("buffer").Buffer)},{"../varint":25,"./bip32Derivation":18,buffer:31}],22:[function(e,t,r){(function(u){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});function e(r){function e(e){if(e.key[0]!==r||e.key.length!==1){throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+e.key.toString("hex"))}if(e.value.length!==32){throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey")}return e.value}function t(e){const t=u.from([r]);return{key:t,value:e}}const n="Buffer";function i(e){return u.isBuffer(e)&&e.length===32}function o(e,t){return!!e&&!!t&&e.tapInternalKey===undefined}return{decode:e,encode:t,check:i,expected:n,canAdd:o}}r.makeConverter=e}).call(this)}).call(this,e("buffer").Buffer)},{buffer:31}],23:[function(e,t,r){(function(u){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});function e(r){function e(e){if(e.key[0]!==r){throw new Error("Decode Error: could not decode witnessScript with key 0x"+e.key.toString("hex"))}return e.value}function t(e){const t=u.from([r]);return{key:t,value:e}}const n="Buffer";function i(e){return u.isBuffer(e)}function o(e,t){return!!e&&!!t&&e.witnessScript===undefined}return{decode:e,encode:t,check:i,expected:n,canAdd:o}}r.makeConverter=e}).call(this)}).call(this,e("buffer").Buffer)},{buffer:31}],24:[function(f,e,a){(function(s){(function(){"use strict";Object.defineProperty(a,"__esModule",{value:true});const u=f("./varint");a.range=e=>[...Array(e).keys()];function e(t){if(t.length<1)return t;let r=t.length-1;let n=0;for(let e=0;e<t.length/2;e++){n=t[e];t[e]=t[r];t[r]=n;r--}return t}a.reverseBuffer=e;function t(e){const t=e.map(r);t.push(s.from([0]));return s.concat(t)}a.keyValsToBuffer=t;function r(e){const t=e.key.length;const r=e.value.length;const n=u.encodingLength(t);const i=u.encodingLength(r);const o=s.allocUnsafe(n+t+i+r);u.encode(t,o,0);e.key.copy(o,n);u.encode(r,o,n+t);e.value.copy(o,n+t+i);return o}a.keyValToBuffer=r;function i(e,t){if(typeof e!=="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function n(e,t){const r=e.readUInt32LE(t);let n=e.readUInt32LE(t+4);n*=4294967296;i(n+r,9007199254740991);return n+r}a.readUInt64LE=n;function o(e,t,r){i(t,9007199254740991);e.writeInt32LE(t&-1,r);e.writeUInt32LE(Math.floor(t/4294967296),r+4);return r+8}a.writeUInt64LE=o}).call(this)}).call(this,f("buffer").Buffer)},{"./varint":25,buffer:31}],25:[function(e,t,r){(function(f){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const t=9007199254740991;function u(e){if(e<0||e>t||e%1!==0)throw new RangeError("value out of range")}function n(e,t,r){u(e);if(!t)t=f.allocUnsafe(i(e));if(!f.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(!r)r=0;if(e<253){t.writeUInt8(e,r);Object.assign(n,{bytes:1})}else if(e<=65535){t.writeUInt8(253,r);t.writeUInt16LE(e,r+1);Object.assign(n,{bytes:3})}else if(e<=4294967295){t.writeUInt8(254,r);t.writeUInt32LE(e,r+1);Object.assign(n,{bytes:5})}else{t.writeUInt8(255,r);t.writeUInt32LE(e>>>0,r+1);t.writeUInt32LE(e/4294967296|0,r+5);Object.assign(n,{bytes:9})}return t}r.encode=n;function s(e,t){if(!f.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(!t)t=0;const r=e.readUInt8(t);if(r<253){Object.assign(s,{bytes:1});return r}else if(r===253){Object.assign(s,{bytes:3});return e.readUInt16LE(t+1)}else if(r===254){Object.assign(s,{bytes:5});return e.readUInt32LE(t+1)}else{Object.assign(s,{bytes:9});const n=e.readUInt32LE(t+1);const i=e.readUInt32LE(t+5);const o=i*4294967296+n;u(o);return o}}r.decode=s;function i(e){u(e);return e<253?1:e<=65535?3:e<=4294967295?5:9}r.encodingLength=i}).call(this)}).call(this,e("buffer").Buffer)},{buffer:31}],26:[function(t,e,r){(function(n){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const d=t("../converter");const k=t("../converter/tools");const S=t("../converter/varint");const m=t("../typeFields");function e(r,e){let n=0;function i(){const e=S.decode(r,n);n+=S.encodingLength(e);const t=r.slice(n,n+e);n+=e;return t}function t(){const e=r.readUInt32BE(n);n+=4;return e}function o(){const e=r.readUInt8(n);n+=1;return e}function u(){const e=i();const t=i();return{key:e,value:t}}function s(){if(n>=r.length){throw new Error("Format Error: Unexpected End of PSBT")}const e=r.readUInt8(n)===0;if(e){n++}return e}if(t()!==1886610036){throw new Error("Format Error: Invalid Magic Number")}if(o()!==255){throw new Error("Format Error: Magic Number must be followed by 0xff separator")}const f=[];const a={};while(!s()){const g=u();const b=g.key.toString("hex");if(a[b]){throw new Error("Format Error: Keys must be unique for global keymap: key "+b)}a[b]=1;f.push(g)}const c=f.filter(e=>e.key[0]===m.GlobalTypes.UNSIGNED_TX);if(c.length!==1){throw new Error("Format Error: Only one UNSIGNED_TX allowed")}const l=e(c[0].value);const{inputCount:p,outputCount:h}=l.getInputOutputCounts();const d=[];const y=[];for(const w of k.range(p)){const E={};const T=[];while(!s()){const g=u();const b=g.key.toString("hex");if(E[b]){throw new Error("Format Error: Keys must be unique for each input: "+"input index "+w+" key "+b)}E[b]=1;T.push(g)}d.push(T)}for(const w of k.range(h)){const v={};const I=[];while(!s()){const g=u();const b=g.key.toString("hex");if(v[b]){throw new Error("Format Error: Keys must be unique for each output: "+"output index "+w+" key "+b)}v[b]=1;I.push(g)}y.push(I)}return _(l,{globalMapKeyVals:f,inputKeyVals:d,outputKeyVals:y})}r.psbtFromBuffer=e;function y(e,t,r){if(!t.equals(n.from([r]))){throw new Error(`Format Error: Invalid ${e} key: ${t.toString("hex")}`)}}r.checkKeyBuffer=y;function _(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:n}){const i={unsignedTx:e};let o=0;for(const c of t){switch(c.key[0]){case m.GlobalTypes.UNSIGNED_TX:y("global",c.key,m.GlobalTypes.UNSIGNED_TX);if(o>0){throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX")}o++;break;case m.GlobalTypes.GLOBAL_XPUB:if(i.globalXpub===undefined){i.globalXpub=[]}i.globalXpub.push(d.globals.globalXpub.decode(c));break;default:if(!i.unknownKeyVals)i.unknownKeyVals=[];i.unknownKeyVals.push(c)}}const u=r.length;const s=n.length;const f=[];const a=[];for(const l of k.range(u)){const p={};for(const c of r[l]){d.inputs.checkPubkey(c);switch(c.key[0]){case m.InputTypes.NON_WITNESS_UTXO:y("input",c.key,m.InputTypes.NON_WITNESS_UTXO);if(p.nonWitnessUtxo!==undefined){throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO")}p.nonWitnessUtxo=d.inputs.nonWitnessUtxo.decode(c);break;case m.InputTypes.WITNESS_UTXO:y("input",c.key,m.InputTypes.WITNESS_UTXO);if(p.witnessUtxo!==undefined){throw new Error("Format Error: Input has multiple WITNESS_UTXO")}p.witnessUtxo=d.inputs.witnessUtxo.decode(c);break;case m.InputTypes.PARTIAL_SIG:if(p.partialSig===undefined){p.partialSig=[]}p.partialSig.push(d.inputs.partialSig.decode(c));break;case m.InputTypes.SIGHASH_TYPE:y("input",c.key,m.InputTypes.SIGHASH_TYPE);if(p.sighashType!==undefined){throw new Error("Format Error: Input has multiple SIGHASH_TYPE")}p.sighashType=d.inputs.sighashType.decode(c);break;case m.InputTypes.REDEEM_SCRIPT:y("input",c.key,m.InputTypes.REDEEM_SCRIPT);if(p.redeemScript!==undefined){throw new Error("Format Error: Input has multiple REDEEM_SCRIPT")}p.redeemScript=d.inputs.redeemScript.decode(c);break;case m.InputTypes.WITNESS_SCRIPT:y("input",c.key,m.InputTypes.WITNESS_SCRIPT);if(p.witnessScript!==undefined){throw new Error("Format Error: Input has multiple WITNESS_SCRIPT")}p.witnessScript=d.inputs.witnessScript.decode(c);break;case m.InputTypes.BIP32_DERIVATION:if(p.bip32Derivation===undefined){p.bip32Derivation=[]}p.bip32Derivation.push(d.inputs.bip32Derivation.decode(c));break;case m.InputTypes.FINAL_SCRIPTSIG:y("input",c.key,m.InputTypes.FINAL_SCRIPTSIG);p.finalScriptSig=d.inputs.finalScriptSig.decode(c);break;case m.InputTypes.FINAL_SCRIPTWITNESS:y("input",c.key,m.InputTypes.FINAL_SCRIPTWITNESS);p.finalScriptWitness=d.inputs.finalScriptWitness.decode(c);break;case m.InputTypes.POR_COMMITMENT:y("input",c.key,m.InputTypes.POR_COMMITMENT);p.porCommitment=d.inputs.porCommitment.decode(c);break;case m.InputTypes.TAP_KEY_SIG:y("input",c.key,m.InputTypes.TAP_KEY_SIG);p.tapKeySig=d.inputs.tapKeySig.decode(c);break;case m.InputTypes.TAP_SCRIPT_SIG:if(p.tapScriptSig===undefined){p.tapScriptSig=[]}p.tapScriptSig.push(d.inputs.tapScriptSig.decode(c));break;case m.InputTypes.TAP_LEAF_SCRIPT:if(p.tapLeafScript===undefined){p.tapLeafScript=[]}p.tapLeafScript.push(d.inputs.tapLeafScript.decode(c));break;case m.InputTypes.TAP_BIP32_DERIVATION:if(p.tapBip32Derivation===undefined){p.tapBip32Derivation=[]}p.tapBip32Derivation.push(d.inputs.tapBip32Derivation.decode(c));break;case m.InputTypes.TAP_INTERNAL_KEY:y("input",c.key,m.InputTypes.TAP_INTERNAL_KEY);p.tapInternalKey=d.inputs.tapInternalKey.decode(c);break;case m.InputTypes.TAP_MERKLE_ROOT:y("input",c.key,m.InputTypes.TAP_MERKLE_ROOT);p.tapMerkleRoot=d.inputs.tapMerkleRoot.decode(c);break;default:if(!p.unknownKeyVals)p.unknownKeyVals=[];p.unknownKeyVals.push(c)}}f.push(p)}for(const l of k.range(s)){const h={};for(const c of n[l]){d.outputs.checkPubkey(c);switch(c.key[0]){case m.OutputTypes.REDEEM_SCRIPT:y("output",c.key,m.OutputTypes.REDEEM_SCRIPT);if(h.redeemScript!==undefined){throw new Error("Format Error: Output has multiple REDEEM_SCRIPT")}h.redeemScript=d.outputs.redeemScript.decode(c);break;case m.OutputTypes.WITNESS_SCRIPT:y("output",c.key,m.OutputTypes.WITNESS_SCRIPT);if(h.witnessScript!==undefined){throw new Error("Format Error: Output has multiple WITNESS_SCRIPT")}h.witnessScript=d.outputs.witnessScript.decode(c);break;case m.OutputTypes.BIP32_DERIVATION:if(h.bip32Derivation===undefined){h.bip32Derivation=[]}h.bip32Derivation.push(d.outputs.bip32Derivation.decode(c));break;case m.OutputTypes.TAP_INTERNAL_KEY:y("output",c.key,m.OutputTypes.TAP_INTERNAL_KEY);h.tapInternalKey=d.outputs.tapInternalKey.decode(c);break;case m.OutputTypes.TAP_TREE:y("output",c.key,m.OutputTypes.TAP_TREE);h.tapTree=d.outputs.tapTree.decode(c);break;case m.OutputTypes.TAP_BIP32_DERIVATION:if(h.tapBip32Derivation===undefined){h.tapBip32Derivation=[]}h.tapBip32Derivation.push(d.outputs.tapBip32Derivation.decode(c));break;default:if(!h.unknownKeyVals)h.unknownKeyVals=[];h.unknownKeyVals.push(c)}}a.push(h)}return{globalMap:i,inputs:f,outputs:a}}r.psbtFromKeyVals=_}).call(this)}).call(this,t("buffer").Buffer)},{"../converter":5,"../converter/tools":24,"../converter/varint":25,"../typeFields":29,buffer:31}],27:[function(e,t,r){"use strict";function n(e){for(var t in e)if(!r.hasOwnProperty(t))r[t]=e[t]}Object.defineProperty(r,"__esModule",{value:true});n(e("./fromBuffer"));n(e("./toBuffer"))},{"./fromBuffer":26,"./toBuffer":28}],28:[function(t,e,r){(function(h){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const n=t("../converter");const l=t("../converter/tools");function e({globalMap:e,inputs:t,outputs:r}){const{globalKeyVals:n,inputKeyVals:i,outputKeyVals:o}=p({globalMap:e,inputs:t,outputs:r});const u=l.keyValsToBuffer(n);const s=e=>e.length===0?[h.from([0])]:e.map(l.keyValsToBuffer);const f=s(i);const a=s(o);const c=h.allocUnsafe(5);c.writeUIntBE(482972169471,0,5);return h.concat([c,u].concat(f,a))}r.psbtToBuffer=e;const i=(e,t)=>{return e.key.compare(t.key)};function o(e,u){const s=new Set;const t=Object.entries(e).reduce((e,[t,r])=>{if(t==="unknownKeyVals")return e;const n=u[t];if(n===undefined)return e;const i=(Array.isArray(r)?r:[r]).map(n.encode);const o=i.map(e=>e.key.toString("hex"));o.forEach(e=>{if(s.has(e))throw new Error("Serialize Error: Duplicate key: "+e);s.add(e)});return e.concat(i)},[]);const r=e.unknownKeyVals?e.unknownKeyVals.filter(e=>{return!s.has(e.key.toString("hex"))}):[];return t.concat(r).sort(i)}function p({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:o(e,n.globals),inputKeyVals:t.map(e=>o(e,n.inputs)),outputKeyVals:r.map(e=>o(e,n.outputs))}}r.psbtToKeyVals=p}).call(this)}).call(this,t("buffer").Buffer)},{"../converter":5,"../converter/tools":24,buffer:31}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n;(function(e){e[e["UNSIGNED_TX"]=0]="UNSIGNED_TX";e[e["GLOBAL_XPUB"]=1]="GLOBAL_XPUB"})(n=r.GlobalTypes||(r.GlobalTypes={}));r.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"];var i;(function(e){e[e["NON_WITNESS_UTXO"]=0]="NON_WITNESS_UTXO";e[e["WITNESS_UTXO"]=1]="WITNESS_UTXO";e[e["PARTIAL_SIG"]=2]="PARTIAL_SIG";e[e["SIGHASH_TYPE"]=3]="SIGHASH_TYPE";e[e["REDEEM_SCRIPT"]=4]="REDEEM_SCRIPT";e[e["WITNESS_SCRIPT"]=5]="WITNESS_SCRIPT";e[e["BIP32_DERIVATION"]=6]="BIP32_DERIVATION";e[e["FINAL_SCRIPTSIG"]=7]="FINAL_SCRIPTSIG";e[e["FINAL_SCRIPTWITNESS"]=8]="FINAL_SCRIPTWITNESS";e[e["POR_COMMITMENT"]=9]="POR_COMMITMENT";e[e["TAP_KEY_SIG"]=19]="TAP_KEY_SIG";e[e["TAP_SCRIPT_SIG"]=20]="TAP_SCRIPT_SIG";e[e["TAP_LEAF_SCRIPT"]=21]="TAP_LEAF_SCRIPT";e[e["TAP_BIP32_DERIVATION"]=22]="TAP_BIP32_DERIVATION";e[e["TAP_INTERNAL_KEY"]=23]="TAP_INTERNAL_KEY";e[e["TAP_MERKLE_ROOT"]=24]="TAP_MERKLE_ROOT"})(i=r.InputTypes||(r.InputTypes={}));r.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment","tapKeySig","tapScriptSig","tapLeafScript","tapBip32Derivation","tapInternalKey","tapMerkleRoot"];var o;(function(e){e[e["REDEEM_SCRIPT"]=0]="REDEEM_SCRIPT";e[e["WITNESS_SCRIPT"]=1]="WITNESS_SCRIPT";e[e["BIP32_DERIVATION"]=2]="BIP32_DERIVATION";e[e["TAP_INTERNAL_KEY"]=5]="TAP_INTERNAL_KEY";e[e["TAP_TREE"]=6]="TAP_TREE";e[e["TAP_BIP32_DERIVATION"]=7]="TAP_BIP32_DERIVATION"})(o=r.OutputTypes||(r.OutputTypes={}));r.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation","tapInternalKey","tapTree","tapBip32Derivation"]},{}],30:[function(l,e,d){(function(c){(function(){"use strict";Object.defineProperty(d,"__esModule",{value:true});const p=l("./converter");function i(e,t){const r=e[t];if(r===undefined)throw new Error(`No input #${t}`);return r}d.checkForInput=i;function o(e,t){const r=e[t];if(r===undefined)throw new Error(`No output #${t}`);return r}d.checkForOutput=o;function e(t,e,r){if(t.key[0]<r){throw new Error(`Use the method for your specific key instead of addUnknownKeyVal*`)}if(e&&e.filter(e=>e.key.equals(t.key)).length!==0){throw new Error(`Duplicate Key: ${t.key.toString("hex")}`)}}d.checkHasKey=e;function t(e){let t=0;Object.keys(e).forEach(e=>{if(Number(isNaN(Number(e)))){t++}});return t}d.getEnumLength=t;function r(e,t){let r=false;if(t.nonWitnessUtxo||t.witnessUtxo){const n=!!t.redeemScript;const i=!!t.witnessScript;const o=!n||!!t.finalScriptSig;const u=!i||!!t.finalScriptWitness;const s=!!t.finalScriptSig||!!t.finalScriptWitness;r=o&&u&&s}if(r===false){throw new Error(`Input #${e} has too much or too little data to clean`)}}d.inputCheckUncleanFinalized=r;function h(e,t,r,n){throw new Error(`Data for ${e} key ${t} is incorrect: Expected `+`${r} and got ${JSON.stringify(n)}`)}function n(l){return(e,t)=>{for(const r of Object.keys(e)){const n=e[r];const{canAdd:i,canAddToArray:o,check:u,expected:s}=p[l+"s"][r]||{};const f=!!o;if(u){if(f){if(!Array.isArray(n)||t[r]&&!Array.isArray(t[r])){throw new Error(`Key type ${r} must be an array`)}if(!n.every(u)){h(l,r,s,n)}const a=t[r]||[];const c=new Set;if(!n.every(e=>o(a,e,c))){throw new Error("Can not add duplicate data to array")}t[r]=a.concat(n)}else{if(!u(n)){h(l,r,s,n)}if(!i(t,n)){throw new Error(`Can not add duplicate data to ${l}`)}t[r]=n}}}}}d.updateGlobal=n("global");d.updateInput=n("input");d.updateOutput=n("output");function u(e,t){const r=e.length-1;const n=i(e,r);d.updateInput(t,n)}d.addInputAttributes=u;function s(e,t){const r=e.length-1;const n=o(e,r);d.updateOutput(t,n)}d.addOutputAttributes=s;function f(e,t){if(!c.isBuffer(t)||t.length<4){throw new Error("Set Version: Invalid Transaction")}t.writeUInt32LE(e,0);return t}d.defaultVersionSetter=f;function a(e,t){if(!c.isBuffer(t)||t.length<4){throw new Error("Set Locktime: Invalid Transaction")}t.writeUInt32LE(e,t.length-4);return t}d.defaultLocktimeSetter=a}).call(this)}).call(this,{isBuffer:l("../../../is-buffer/index.js")})},{"../../../is-buffer/index.js":33,"./converter":5}],31:[function($,e,J){(function(e){(function(){"use strict";var n=$("base64-js");var o=$("ieee754");J.Buffer=p;J.SlowBuffer=t;J.INSPECT_MAX_BYTES=50;var r=2147483647;J.kMaxLength=r;p.TYPED_ARRAY_SUPPORT=e();if(!p.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function e(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42}catch(e){return false}}Object.defineProperty(p.prototype,"parent",{enumerable:true,get:function(){if(!p.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(p.prototype,"offset",{enumerable:true,get:function(){if(!p.isBuffer(this))return undefined;return this.byteOffset}});function u(e){if(e>r){throw new RangeError('The value "'+e+'" is invalid for option "size"')}var t=new Uint8Array(e);t.__proto__=p.prototype;return t}function p(e,t,r){if(typeof e==="number"){if(typeof t==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return a(e)}return i(e,t,r)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&p[Symbol.species]===p){Object.defineProperty(p,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}p.poolSize=8192;function i(e,t,r){if(typeof e==="string"){return c(e,t)}if(ArrayBuffer.isView(e)){return l(e)}if(e==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}if(N(e,ArrayBuffer)||e&&N(e.buffer,ArrayBuffer)){return h(e,t,r)}if(typeof e==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var n=e.valueOf&&e.valueOf();if(n!=null&&n!==e){return p.from(n,t,r)}var i=d(e);if(i)return i;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]==="function"){return p.from(e[Symbol.toPrimitive]("string"),t,r)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}p.from=function(e,t,r){return i(e,t,r)};p.prototype.__proto__=Uint8Array.prototype;p.__proto__=Uint8Array;function s(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be of type number')}else if(e<0){throw new RangeError('The value "'+e+'" is invalid for option "size"')}}function f(e,t,r){s(e);if(e<=0){return u(e)}if(t!==undefined){return typeof r==="string"?u(e).fill(t,r):u(e).fill(t)}return u(e)}p.alloc=function(e,t,r){return f(e,t,r)};function a(e){s(e);return u(e<0?0:y(e)|0)}p.allocUnsafe=function(e){return a(e)};p.allocUnsafeSlow=function(e){return a(e)};function c(e,t){if(typeof t!=="string"||t===""){t="utf8"}if(!p.isEncoding(t)){throw new TypeError("Unknown encoding: "+t)}var r=g(e,t)|0;var n=u(r);var i=n.write(e,t);if(i!==r){n=n.slice(0,i)}return n}function l(e){var t=e.length<0?0:y(e.length)|0;var r=u(t);for(var n=0;n<t;n+=1){r[n]=e[n]&255}return r}function h(e,t,r){if(t<0||e.byteLength<t){throw new RangeError('"offset" is outside of buffer bounds')}if(e.byteLength<t+(r||0)){throw new RangeError('"length" is outside of buffer bounds')}var n;if(t===undefined&&r===undefined){n=new Uint8Array(e)}else if(r===undefined){n=new Uint8Array(e,t)}else{n=new Uint8Array(e,t,r)}n.__proto__=p.prototype;return n}function d(e){if(p.isBuffer(e)){var t=y(e.length)|0;var r=u(t);if(r.length===0){return r}e.copy(r,0,0,t);return r}if(e.length!==undefined){if(typeof e.length!=="number"||L(e.length)){return u(0)}return l(e)}if(e.type==="Buffer"&&Array.isArray(e.data)){return l(e.data)}}function y(e){if(e>=r){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+r.toString(16)+" bytes")}return e|0}function t(e){if(+e!=e){e=0}return p.alloc(+e)}p.isBuffer=function e(t){return t!=null&&t._isBuffer===true&&t!==p.prototype};p.compare=function e(t,r){if(N(t,Uint8Array))t=p.from(t,t.offset,t.byteLength);if(N(r,Uint8Array))r=p.from(r,r.offset,r.byteLength);if(!p.isBuffer(t)||!p.isBuffer(r)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(t===r)return 0;var n=t.length;var i=r.length;for(var o=0,u=Math.min(n,i);o<u;++o){if(t[o]!==r[o]){n=t[o];i=r[o];break}}if(n<i)return-1;if(i<n)return 1;return 0};p.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};p.concat=function e(t,r){if(!Array.isArray(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return p.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var i=p.allocUnsafe(r);var o=0;for(n=0;n<t.length;++n){var u=t[n];if(N(u,Uint8Array)){u=p.from(u)}if(!p.isBuffer(u)){throw new TypeError('"list" argument must be an Array of Buffers')}u.copy(i,o);o+=u.length}return i};function g(e,t){if(p.isBuffer(e)){return e.length}if(ArrayBuffer.isView(e)||N(e,ArrayBuffer)){return e.byteLength}if(typeof e!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof e)}var r=e.length;var n=arguments.length>2&&arguments[2]===true;if(!n&&r===0)return 0;var i=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return x(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return R(e).length;default:if(i){return n?-1:x(e).length}t=(""+t).toLowerCase();i=true}}}p.byteLength=g;function b(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return j(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return F(this,t,r);case"latin1":case"binary":return G(this,t,r);case"base64":return D(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}p.prototype._isBuffer=true;function w(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}p.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){w(this,r,r+1)}return this};p.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){w(this,r,r+3);w(this,r+1,r+2)}return this};p.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){w(this,r,r+7);w(this,r+1,r+6);w(this,r+2,r+5);w(this,r+3,r+4)}return this};p.prototype.toString=function e(){var t=this.length;if(t===0)return"";if(arguments.length===0)return S(this,0,t);return b.apply(this,arguments)};p.prototype.toLocaleString=p.prototype.toString;p.prototype.equals=function e(t){if(!p.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return p.compare(this,t)===0};p.prototype.inspect=function e(){var t="";var r=J.INSPECT_MAX_BYTES;t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim();if(this.length>r)t+=" ... ";return"<Buffer "+t+">"};p.prototype.compare=function e(t,r,n,i,o){if(N(t,Uint8Array)){t=p.from(t,t.offset,t.byteLength)}if(!p.isBuffer(t)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof t)}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(i===undefined){i=0}if(o===undefined){o=this.length}if(r<0||n>t.length||i<0||o>this.length){throw new RangeError("out of range index")}if(i>=o&&r>=n){return 0}if(i>=o){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;i>>>=0;o>>>=0;if(this===t)return 0;var u=o-i;var s=n-r;var f=Math.min(u,s);var a=this.slice(i,o);var c=t.slice(r,n);for(var l=0;l<f;++l){if(a[l]!==c[l]){u=a[l];s=c[l];break}}if(u<s)return-1;if(s<u)return 1;return 0};function E(e,t,r,n,i){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(L(r)){r=i?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(i)return-1;else r=e.length-1}else if(r<0){if(i)r=0;else return-1}if(typeof t==="string"){t=p.from(t,n)}if(p.isBuffer(t)){if(t.length===0){return-1}return T(e,t,r,n,i)}else if(typeof t==="number"){t=t&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(i){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return T(e,[t],r,n,i)}throw new TypeError("val must be string, number or Buffer")}function T(e,t,r,n,i){var o=1;var u=e.length;var s=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}o=2;u/=2;s/=2;r/=2}}function f(e,t){if(o===1){return e[t]}else{return e.readUInt16BE(t*o)}}var a;if(i){var c=-1;for(a=r;a<u;a++){if(f(e,a)===f(t,c===-1?0:a-c)){if(c===-1)c=a;if(a-c+1===s)return c*o}else{if(c!==-1)a-=a-c;c=-1}}}else{if(r+s>u)r=u-s;for(a=r;a>=0;a--){var l=true;for(var p=0;p<s;p++){if(f(e,a+p)!==f(t,p)){l=false;break}}if(l)return a}}return-1}p.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};p.prototype.indexOf=function e(t,r,n){return E(this,t,r,n,true)};p.prototype.lastIndexOf=function e(t,r,n){return E(this,t,r,n,false)};function v(e,t,r,n){r=Number(r)||0;var i=e.length-r;if(!n){n=i}else{n=Number(n);if(n>i){n=i}}var o=t.length;if(n>o/2){n=o/2}for(var u=0;u<n;++u){var s=parseInt(t.substr(u*2,2),16);if(L(s))return u;e[r+u]=s}return u}function I(e,t,r,n){return U(x(t,e.length-r),e,r,n)}function k(e,t,r,n){return U(q(t),e,r,n)}function M(e,t,r,n){return k(e,t,r,n)}function K(e,t,r,n){return U(R(t),e,r,n)}function C(e,t,r,n){return U(z(t,e.length-r),e,r,n)}p.prototype.write=function e(t,r,n,i){if(r===undefined){i="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){i=r;n=this.length;r=0}else if(isFinite(r)){r=r>>>0;if(isFinite(n)){n=n>>>0;if(i===undefined)i="utf8"}else{i=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var o=this.length-r;if(n===undefined||n>o)n=o;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!i)i="utf8";var u=false;for(;;){switch(i){case"hex":return v(this,t,r,n);case"utf8":case"utf-8":return I(this,t,r,n);case"ascii":return k(this,t,r,n);case"latin1":case"binary":return M(this,t,r,n);case"base64":return K(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,r,n);default:if(u)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase();u=true}}};p.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function D(e,t,r){if(t===0&&r===e.length){return n.fromByteArray(e)}else{return n.fromByteArray(e.slice(t,r))}}function S(e,t,r){r=Math.min(e.length,r);var n=[];var i=t;while(i<r){var o=e[i];var u=null;var s=o>239?4:o>223?3:o>191?2:1;if(i+s<=r){var f,a,c,l;switch(s){case 1:if(o<128){u=o}break;case 2:f=e[i+1];if((f&192)===128){l=(o&31)<<6|f&63;if(l>127){u=l}}break;case 3:f=e[i+1];a=e[i+2];if((f&192)===128&&(a&192)===128){l=(o&15)<<12|(f&63)<<6|a&63;if(l>2047&&(l<55296||l>57343)){u=l}}break;case 4:f=e[i+1];a=e[i+2];c=e[i+3];if((f&192)===128&&(a&192)===128&&(c&192)===128){l=(o&15)<<18|(f&63)<<12|(a&63)<<6|c&63;if(l>65535&&l<1114112){u=l}}}}if(u===null){u=65533;s=1}else if(u>65535){u-=65536;n.push(u>>>10&1023|55296);u=56320|u&1023}n.push(u);i+=s}return V(n)}var m=4096;function V(e){var t=e.length;if(t<=m){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=m))}return r}function F(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i]&127)}return n}function G(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i])}return n}function j(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var i="";for(var o=t;o<r;++o){i+=Y(e[o])}return i}function W(e,t,r){var n=e.slice(t,r);var i="";for(var o=0;o<n.length;o+=2){i+=String.fromCharCode(n[o]+n[o+1]*256)}return i}p.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var i=this.subarray(t,r);i.__proto__=p.prototype;return i};function _(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}p.prototype.readUIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)_(t,r,this.length);var i=this[t];var o=1;var u=0;while(++u<r&&(o*=256)){i+=this[t+u]*o}return i};p.prototype.readUIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n){_(t,r,this.length)}var i=this[t+--r];var o=1;while(r>0&&(o*=256)){i+=this[t+--r]*o}return i};p.prototype.readUInt8=function e(t,r){t=t>>>0;if(!r)_(t,1,this.length);return this[t]};p.prototype.readUInt16LE=function e(t,r){t=t>>>0;if(!r)_(t,2,this.length);return this[t]|this[t+1]<<8};p.prototype.readUInt16BE=function e(t,r){t=t>>>0;if(!r)_(t,2,this.length);return this[t]<<8|this[t+1]};p.prototype.readUInt32LE=function e(t,r){t=t>>>0;if(!r)_(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};p.prototype.readUInt32BE=function e(t,r){t=t>>>0;if(!r)_(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};p.prototype.readIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)_(t,r,this.length);var i=this[t];var o=1;var u=0;while(++u<r&&(o*=256)){i+=this[t+u]*o}o*=128;if(i>=o)i-=Math.pow(2,8*r);return i};p.prototype.readIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)_(t,r,this.length);var i=r;var o=1;var u=this[t+--i];while(i>0&&(o*=256)){u+=this[t+--i]*o}o*=128;if(u>=o)u-=Math.pow(2,8*r);return u};p.prototype.readInt8=function e(t,r){t=t>>>0;if(!r)_(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};p.prototype.readInt16LE=function e(t,r){t=t>>>0;if(!r)_(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};p.prototype.readInt16BE=function e(t,r){t=t>>>0;if(!r)_(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};p.prototype.readInt32LE=function e(t,r){t=t>>>0;if(!r)_(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};p.prototype.readInt32BE=function e(t,r){t=t>>>0;if(!r)_(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};p.prototype.readFloatLE=function e(t,r){t=t>>>0;if(!r)_(t,4,this.length);return o.read(this,t,true,23,4)};p.prototype.readFloatBE=function e(t,r){t=t>>>0;if(!r)_(t,4,this.length);return o.read(this,t,false,23,4)};p.prototype.readDoubleLE=function e(t,r){t=t>>>0;if(!r)_(t,8,this.length);return o.read(this,t,true,52,8)};p.prototype.readDoubleBE=function e(t,r){t=t>>>0;if(!r)_(t,8,this.length);return o.read(this,t,false,52,8)};function A(e,t,r,n,i,o){if(!p.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}p.prototype.writeUIntLE=function e(t,r,n,i){t=+t;r=r>>>0;n=n>>>0;if(!i){var o=Math.pow(2,8*n)-1;A(this,t,r,n,o,0)}var u=1;var s=0;this[r]=t&255;while(++s<n&&(u*=256)){this[r+s]=t/u&255}return r+n};p.prototype.writeUIntBE=function e(t,r,n,i){t=+t;r=r>>>0;n=n>>>0;if(!i){var o=Math.pow(2,8*n)-1;A(this,t,r,n,o,0)}var u=n-1;var s=1;this[r+u]=t&255;while(--u>=0&&(s*=256)){this[r+u]=t/s&255}return r+n};p.prototype.writeUInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,1,255,0);this[r]=t&255;return r+1};p.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,2,65535,0);this[r]=t&255;this[r+1]=t>>>8;return r+2};p.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,2,65535,0);this[r]=t>>>8;this[r+1]=t&255;return r+2};p.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,4,4294967295,0);this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255;return r+4};p.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,4,4294967295,0);this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};p.prototype.writeIntLE=function e(t,r,n,i){t=+t;r=r>>>0;if(!i){var o=Math.pow(2,8*n-1);A(this,t,r,n,o-1,-o)}var u=0;var s=1;var f=0;this[r]=t&255;while(++u<n&&(s*=256)){if(t<0&&f===0&&this[r+u-1]!==0){f=1}this[r+u]=(t/s>>0)-f&255}return r+n};p.prototype.writeIntBE=function e(t,r,n,i){t=+t;r=r>>>0;if(!i){var o=Math.pow(2,8*n-1);A(this,t,r,n,o-1,-o)}var u=n-1;var s=1;var f=0;this[r+u]=t&255;while(--u>=0&&(s*=256)){if(t<0&&f===0&&this[r+u+1]!==0){f=1}this[r+u]=(t/s>>0)-f&255}return r+n};p.prototype.writeInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,1,127,-128);if(t<0)t=255+t+1;this[r]=t&255;return r+1};p.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,2,32767,-32768);this[r]=t&255;this[r+1]=t>>>8;return r+2};p.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,2,32767,-32768);this[r]=t>>>8;this[r+1]=t&255;return r+2};p.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,4,2147483647,-2147483648);this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24;return r+4};p.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)A(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};function B(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function P(e,t,r,n,i){t=+t;r=r>>>0;if(!i){B(e,t,r,4,34028234663852886e22,-34028234663852886e22)}o.write(e,t,r,n,23,4);return r+4}p.prototype.writeFloatLE=function e(t,r,n){return P(this,t,r,true,n)};p.prototype.writeFloatBE=function e(t,r,n){return P(this,t,r,false,n)};function O(e,t,r,n,i){t=+t;r=r>>>0;if(!i){B(e,t,r,8,17976931348623157e292,-17976931348623157e292)}o.write(e,t,r,n,52,8);return r+8}p.prototype.writeDoubleLE=function e(t,r,n){return O(this,t,r,true,n)};p.prototype.writeDoubleBE=function e(t,r,n){return O(this,t,r,false,n)};p.prototype.copy=function e(t,r,n,i){if(!p.isBuffer(t))throw new TypeError("argument should be a Buffer");if(!n)n=0;if(!i&&i!==0)i=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(i>0&&i<n)i=n;if(i===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");if(i>this.length)i=this.length;if(t.length-r<i-n){i=t.length-r+n}var o=i-n;if(this===t&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(r,n,i)}else if(this===t&&n<r&&r<i){for(var u=o-1;u>=0;--u){t[u+r]=this[u+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,i),r)}return o};p.prototype.fill=function e(t,r,n,i){if(typeof t==="string"){if(typeof r==="string"){i=r;r=0;n=this.length}else if(typeof n==="string"){i=n;n=this.length}if(i!==undefined&&typeof i!=="string"){throw new TypeError("encoding must be a string")}if(typeof i==="string"&&!p.isEncoding(i)){throw new TypeError("Unknown encoding: "+i)}if(t.length===1){var o=t.charCodeAt(0);if(i==="utf8"&&o<128||i==="latin1"){t=o}}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var u;if(typeof t==="number"){for(u=r;u<n;++u){this[u]=t}}else{var s=p.isBuffer(t)?t:p.from(t,i);var f=s.length;if(f===0){throw new TypeError('The value "'+t+'" is invalid for argument "value"')}for(u=0;u<n-r;++u){this[u+r]=s[u%f]}}return this};var X=/[^+/0-9A-Za-z-_]/g;function H(e){e=e.split("=")[0];e=e.trim().replace(X,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function Y(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function x(e,t){t=t||Infinity;var r;var n=e.length;var i=null;var o=[];for(var u=0;u<n;++u){r=e.charCodeAt(u);if(r>55295&&r<57344){if(!i){if(r>56319){if((t-=3)>-1)o.push(239,191,189);continue}else if(u+1===n){if((t-=3)>-1)o.push(239,191,189);continue}i=r;continue}if(r<56320){if((t-=3)>-1)o.push(239,191,189);i=r;continue}r=(i-55296<<10|r-56320)+65536}else if(i){if((t-=3)>-1)o.push(239,191,189)}i=null;if(r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return o}function q(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function z(e,t){var r,n,i;var o=[];for(var u=0;u<e.length;++u){if((t-=2)<0)break;r=e.charCodeAt(u);n=r>>8;i=r%256;o.push(i);o.push(n)}return o}function R(e){return n.toByteArray(H(e))}function U(e,t,r,n){for(var i=0;i<n;++i){if(i+r>=t.length||i>=e.length)break;t[i+r]=e[i]}return i}function N(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function L(e){return e!==e}}).call(this)}).call(this,$("buffer").Buffer)},{"base64-js":1,buffer:31,ieee754:32}],32:[function(e,t,r){r.read=function(e,t,r,n,i){var o,u;var s=i*8-n-1;var f=(1<<s)-1;var a=f>>1;var c=-7;var l=r?i-1:0;var p=r?-1:1;var h=e[t+l];l+=p;o=h&(1<<-c)-1;h>>=-c;c+=s;for(;c>0;o=o*256+e[t+l],l+=p,c-=8){}u=o&(1<<-c)-1;o>>=-c;c+=n;for(;c>0;u=u*256+e[t+l],l+=p,c-=8){}if(o===0){o=1-a}else if(o===f){return u?NaN:(h?-1:1)*Infinity}else{u=u+Math.pow(2,n);o=o-a}return(h?-1:1)*u*Math.pow(2,o-n)};r.write=function(e,t,r,n,i,o){var u,s,f;var a=o*8-i-1;var c=(1<<a)-1;var l=c>>1;var p=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var h=n?0:o-1;var d=n?1:-1;var y=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;u=c}else{u=Math.floor(Math.log(t)/Math.LN2);if(t*(f=Math.pow(2,-u))<1){u--;f*=2}if(u+l>=1){t+=p/f}else{t+=p*Math.pow(2,1-l)}if(t*f>=2){u++;f/=2}if(u+l>=c){s=0;u=c}else if(u+l>=1){s=(t*f-1)*Math.pow(2,i);u=u+l}else{s=t*Math.pow(2,l-1)*Math.pow(2,i);u=0}}for(;i>=8;e[r+h]=s&255,h+=d,s/=256,i-=8){}u=u<<i|s;a+=i;for(;a>0;e[r+h]=u&255,h+=d,u/=256,a-=8){}e[r+h-d]|=y*128}},{}],33:[function(e,t,r){t.exports=function(e){return e!=null&&(n(e)||i(e)||!!e._isBuffer)};function n(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function i(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&n(e.slice(0,0))}},{}],bip174:[function(t,e,s){(function(u){(function(){"use strict";Object.defineProperty(s,"__esModule",{value:true});const r=t("./combiner");const i=t("./parser");const n=t("./typeFields");const o=t("./utils");class e{constructor(e){this.inputs=[];this.outputs=[];this.globalMap={unsignedTx:e}}static fromBase64(e,t){const r=u.from(e,"base64");return this.fromBuffer(r,t)}static fromHex(e,t){const r=u.from(e,"hex");return this.fromBuffer(r,t)}static fromBuffer(e,t){const r=i.psbtFromBuffer(e,t);const n=new this(r.globalMap.unsignedTx);Object.assign(n,r);return n}toBase64(){const e=this.toBuffer();return e.toString("base64")}toHex(){const e=this.toBuffer();return e.toString("hex")}toBuffer(){return i.psbtToBuffer(this)}updateGlobal(e){o.updateGlobal(e,this.globalMap);return this}updateInput(e,t){const r=o.checkForInput(this.inputs,e);o.updateInput(t,r);return this}updateOutput(e,t){const r=o.checkForOutput(this.outputs,e);o.updateOutput(t,r);return this}addUnknownKeyValToGlobal(e){o.checkHasKey(e,this.globalMap.unknownKeyVals,o.getEnumLength(n.GlobalTypes));if(!this.globalMap.unknownKeyVals)this.globalMap.unknownKeyVals=[];this.globalMap.unknownKeyVals.push(e);return this}addUnknownKeyValToInput(e,t){const r=o.checkForInput(this.inputs,e);o.checkHasKey(t,r.unknownKeyVals,o.getEnumLength(n.InputTypes));if(!r.unknownKeyVals)r.unknownKeyVals=[];r.unknownKeyVals.push(t);return this}addUnknownKeyValToOutput(e,t){const r=o.checkForOutput(this.outputs,e);o.checkHasKey(t,r.unknownKeyVals,o.getEnumLength(n.OutputTypes));if(!r.unknownKeyVals)r.unknownKeyVals=[];r.unknownKeyVals.push(t);return this}addInput(e){this.globalMap.unsignedTx.addInput(e);this.inputs.push({unknownKeyVals:[]});const t=e.unknownKeyVals||[];const r=this.inputs.length-1;if(!Array.isArray(t)){throw new Error("unknownKeyVals must be an Array")}t.forEach(e=>this.addUnknownKeyValToInput(r,e));o.addInputAttributes(this.inputs,e);return this}addOutput(e){this.globalMap.unsignedTx.addOutput(e);this.outputs.push({unknownKeyVals:[]});const t=e.unknownKeyVals||[];const r=this.outputs.length-1;if(!Array.isArray(t)){throw new Error("unknownKeyVals must be an Array")}t.forEach(e=>this.addUnknownKeyValToOutput(r,e));o.addOutputAttributes(this.outputs,e);return this}clearFinalizedInput(e){const t=o.checkForInput(this.inputs,e);o.inputCheckUncleanFinalized(e,t);for(const r of Object.keys(t)){if(!["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(r)){delete t[r]}}return this}combine(...e){const t=r.combine([this].concat(e));Object.assign(this,t);return this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}}s.Psbt=e}).call(this)}).call(this,t("buffer").Buffer)},{"./combiner":2,"./parser":27,"./typeFields":29,"./utils":30,buffer:31}]},{},[])("bip174")});