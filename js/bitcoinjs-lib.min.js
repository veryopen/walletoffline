(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.bitcoin=e()}})(function(){var e,t,r;return function(){function c(o,s,u){function f(r,e){if(!s[r]){if(!o[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(a)return a(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[r]={exports:{}};o[r][0].call(i.exports,function(e){var t=o[r][1][e];return f(t||e)},i,i.exports,c,o,s,u)}return s[r].exports}for(var a="function"==typeof require&&require,e=0;e<u.length;e++)f(u[e]);return f}return c}()({1:[function(e,t,r){t.exports=e("bitcoinjs-lib")},{"bitcoinjs-lib":48}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.anumber=n;r.abytes=o;r.ahash=s;r.aexists=u;r.aoutput=f;function n(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function i(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function o(e,...t){if(!i(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function s(e){if(typeof e!=="function"||typeof e.create!=="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");n(e.outputLen);n(e.blockLen)}function u(e,t=true){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function f(e,t){o(e);const r=t.outputLen;if(e.length<r){throw new Error("digestInto() expects output buffer of length at least "+r)}}},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.HashMD=void 0;r.setBigUint64=h;r.Chi=n;r.Maj=i;const c=e("./_assert.js");const p=e("./utils.js");function h(e,t,r,n){if(typeof e.setBigUint64==="function")return e.setBigUint64(t,r,n);const i=BigInt(32);const o=BigInt(4294967295);const s=Number(r>>i&o);const u=Number(r&o);const f=n?4:0;const a=n?0:4;e.setUint32(t+f,s,n);e.setUint32(t+a,u,n)}function n(e,t,r){return e&t^~e&r}function i(e,t,r){return e&t^e&r^t&r}class o extends p.Hash{constructor(e,t,r,n){super();this.blockLen=e;this.outputLen=t;this.padOffset=r;this.isLE=n;this.finished=false;this.length=0;this.pos=0;this.destroyed=false;this.buffer=new Uint8Array(e);this.view=(0,p.createView)(this.buffer)}update(t){(0,c.aexists)(this);const{view:r,buffer:n,blockLen:i}=this;t=(0,p.toBytes)(t);const o=t.length;for(let e=0;e<o;){const s=Math.min(i-this.pos,o-e);if(s===i){const u=(0,p.createView)(t);for(;i<=o-e;e+=i)this.process(u,e);continue}n.set(t.subarray(e,e+s),this.pos);this.pos+=s;e+=s;if(this.pos===i){this.process(r,0);this.pos=0}}this.length+=t.length;this.roundClean();return this}digestInto(e){(0,c.aexists)(this);(0,c.aoutput)(e,this);this.finished=true;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;t[o++]=128;this.buffer.subarray(o).fill(0);if(this.padOffset>n-o){this.process(r,0);o=0}for(let e=o;e<n;e++)t[e]=0;h(r,n-8,BigInt(this.length*8),i);this.process(r,0);const s=(0,p.createView)(e);const u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=u/4;const a=this.get();if(f>a.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<f;e++)s.setUint32(4*e,a[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);this.destroy();return r}_cloneInto(e){e||(e=new this.constructor);e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;e.length=n;e.pos=s;e.finished=i;e.destroyed=o;if(n%t)e.buffer.set(r);return e}}r.HashMD=o},{"./_assert.js":2,"./utils.js":8}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.crypto=void 0;r.crypto=typeof globalThis==="object"&&"crypto"in globalThis?globalThis.crypto:undefined},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.ripemd160=r.RIPEMD160=void 0;const n=e("./_md.js");const _=e("./utils.js");const i=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]);const o=new Uint8Array(new Array(16).fill(0).map((e,t)=>t));const s=o.map(e=>(9*e+5)%16);let T=[o];let v=[s];for(let t=0;t<4;t++)for(let e of[T,v])e.push(e[t].map(e=>i[e]));const u=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e));const I=T.map((e,t)=>e.map(e=>u[t][e]));const k=v.map((e,t)=>e.map(e=>u[t][e]));const O=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]);const P=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function A(e,t,r,n){if(e===0)return t^r^n;else if(e===1)return t&r|~t&n;else if(e===2)return(t|~r)^n;else if(e===3)return t&n|r&~n;else return t^(r|~n)}const B=new Uint32Array(16);class f extends n.HashMD{constructor(){super(64,20,8,true);this.h0=1732584193|0;this.h1=4023233417|0;this.h2=2562383102|0;this.h3=271733878|0;this.h4=3285377520|0}get(){const{h0:e,h1:t,h2:r,h3:n,h4:i}=this;return[e,t,r,n,i]}set(e,t,r,n,i){this.h0=e|0;this.h1=t|0;this.h2=r|0;this.h3=n|0;this.h4=i|0}process(t,r){for(let e=0;e<16;e++,r+=4)B[e]=t.getUint32(r,true);let n=this.h0|0,i=n,o=this.h1|0,s=o,u=this.h2|0,f=u,a=this.h3|0,c=a,p=this.h4|0,h=p;for(let t=0;t<5;t++){const l=4-t;const d=O[t],y=P[t];const w=T[t],g=v[t];const b=I[t],m=k[t];for(let e=0;e<16;e++){const E=(0,_.rotl)(n+A(t,o,u,a)+B[w[e]]+d,b[e])+p|0;n=p,p=a,a=(0,_.rotl)(u,10)|0,u=o,o=E}for(let e=0;e<16;e++){const S=(0,_.rotl)(i+A(l,s,f,c)+B[g[e]]+y,m[e])+h|0;i=h,h=c,c=(0,_.rotl)(f,10)|0,f=s,s=S}}this.set(this.h1+u+c|0,this.h2+a+h|0,this.h3+p+i|0,this.h4+n+s|0,this.h0+o+f|0)}roundClean(){B.fill(0)}destroy(){this.destroyed=true;this.buffer.fill(0);this.set(0,0,0,0,0)}}r.RIPEMD160=f;r.ripemd160=(0,_.wrapConstructor)(()=>new f)},{"./_md.js":3,"./utils.js":8}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.sha1=r.SHA1=void 0;const a=e("./_md.js");const c=e("./utils.js");const n=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]);const p=new Uint32Array(80);class i extends a.HashMD{constructor(){super(64,20,8,false);this.A=n[0]|0;this.B=n[1]|0;this.C=n[2]|0;this.D=n[3]|0;this.E=n[4]|0}get(){const{A:e,B:t,C:r,D:n,E:i}=this;return[e,t,r,n,i]}set(e,t,r,n,i){this.A=e|0;this.B=t|0;this.C=r|0;this.D=n|0;this.E=i|0}process(t,r){for(let e=0;e<16;e++,r+=4)p[e]=t.getUint32(r,false);for(let e=16;e<80;e++)p[e]=(0,c.rotl)(p[e-3]^p[e-8]^p[e-14]^p[e-16],1);let{A:n,B:i,C:o,D:s,E:u}=this;for(let r=0;r<80;r++){let e,t;if(r<20){e=(0,a.Chi)(i,o,s);t=1518500249}else if(r<40){e=i^o^s;t=1859775393}else if(r<60){e=(0,a.Maj)(i,o,s);t=2400959708}else{e=i^o^s;t=3395469782}const f=(0,c.rotl)(n,5)+e+u+t+p[r]|0;u=s;s=o;o=(0,c.rotl)(i,30);i=n;n=f}n=n+this.A|0;i=i+this.B|0;o=o+this.C|0;s=s+this.D|0;u=u+this.E|0;this.set(n,i,o,s,u)}roundClean(){p.fill(0)}destroy(){this.set(0,0,0,0,0);this.buffer.fill(0)}}r.SHA1=i;r.sha1=(0,c.wrapConstructor)(()=>new i)},{"./_md.js":3,"./utils.js":8}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.sha224=r.sha256=r.SHA256=void 0;const m=e("./_md.js");const E=e("./utils.js");const S=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);const n=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);const _=new Uint32Array(64);class i extends m.HashMD{constructor(){super(64,32,8,false);this.A=n[0]|0;this.B=n[1]|0;this.C=n[2]|0;this.D=n[3]|0;this.E=n[4]|0;this.F=n[5]|0;this.G=n[6]|0;this.H=n[7]|0}get(){const{A:e,B:t,C:r,D:n,E:i,F:o,G:s,H:u}=this;return[e,t,r,n,i,o,s,u]}set(e,t,r,n,i,o,s,u){this.A=e|0;this.B=t|0;this.C=r|0;this.D=n|0;this.E=i|0;this.F=o|0;this.G=s|0;this.H=u|0}process(t,r){for(let e=0;e<16;e++,r+=4)_[e]=t.getUint32(r,false);for(let e=16;e<64;e++){const p=_[e-15];const h=_[e-2];const l=(0,E.rotr)(p,7)^(0,E.rotr)(p,18)^p>>>3;const d=(0,E.rotr)(h,17)^(0,E.rotr)(h,19)^h>>>10;_[e]=d+_[e-7]+l+_[e-16]|0}let{A:n,B:i,C:o,D:s,E:u,F:f,G:a,H:c}=this;for(let e=0;e<64;e++){const y=(0,E.rotr)(u,6)^(0,E.rotr)(u,11)^(0,E.rotr)(u,25);const w=c+y+(0,m.Chi)(u,f,a)+S[e]+_[e]|0;const g=(0,E.rotr)(n,2)^(0,E.rotr)(n,13)^(0,E.rotr)(n,22);const b=g+(0,m.Maj)(n,i,o)|0;c=a;a=f;f=u;u=s+w|0;s=o;o=i;i=n;n=w+b|0}n=n+this.A|0;i=i+this.B|0;o=o+this.C|0;s=s+this.D|0;u=u+this.E|0;f=f+this.F|0;a=a+this.G|0;c=c+this.H|0;this.set(n,i,o,s,u,f,a,c)}roundClean(){_.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0);this.buffer.fill(0)}}r.SHA256=i;class o extends i{constructor(){super();this.A=3238371032|0;this.B=914150663|0;this.C=812702999|0;this.D=4144912697|0;this.E=4290775857|0;this.F=1750603025|0;this.G=1694076839|0;this.H=3204075428|0;this.outputLen=28}}r.sha256=(0,E.wrapConstructor)(()=>new i);r.sha224=(0,E.wrapConstructor)(()=>new o)},{"./_md.js":3,"./utils.js":8}],8:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:true});s.Hash=s.nextTick=s.byteSwapIfBE=s.isLE=void 0;s.isBytes=n;s.u8=i;s.u32=u;s.createView=f;s.rotr=a;s.rotl=c;s.byteSwap=p;s.byteSwap32=h;s.bytesToHex=d;s.hexToBytes=g;s.asyncLoop=m;s.utf8ToBytes=E;s.toBytes=S;s.concatBytes=_;s.checkOpts=v;s.wrapConstructor=I;s.wrapConstructorWithOpts=k;s.wrapXOFConstructorWithOpts=O;s.randomBytes=P;const r=e("@noble/hashes/crypto");const o=e("./_assert.js");function n(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function i(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function u(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function f(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function a(e,t){return e<<32-t|e>>>t}function c(e,t){return e<<t|e>>>32-t>>>0}s.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function p(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}s.byteSwapIfBE=s.isLE?e=>e:e=>p(e);function h(t){for(let e=0;e<t.length;e++){t[e]=p(t[e])}}const l=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function d(t){(0,o.abytes)(t);let r="";for(let e=0;e<t.length;e++){r+=l[t[e]]}return r}const y={_0:48,_9:57,A:65,F:70,a:97,f:102};function w(e){if(e>=y._0&&e<=y._9)return e-y._0;if(e>=y.A&&e<=y.F)return e-(y.A-10);if(e>=y.a&&e<=y.f)return e-(y.a-10);return}function g(r){if(typeof r!=="string")throw new Error("hex string expected, got "+typeof r);const e=r.length;const n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(n);for(let e=0,t=0;e<n;e++,t+=2){const o=w(r.charCodeAt(t));const s=w(r.charCodeAt(t+1));if(o===undefined||s===undefined){const u=r[t]+r[t+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+t)}i[e]=o*16+s}return i}const b=async()=>{};s.nextTick=b;async function m(t,r,n){let i=Date.now();for(let e=0;e<t;e++){n(e);const o=Date.now()-i;if(o>=0&&o<r)continue;await(0,s.nextTick)();i+=o}}function E(e){if(typeof e!=="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function S(e){if(typeof e==="string")e=E(e);(0,o.abytes)(e);return e}function _(...r){let t=0;for(let e=0;e<r.length;e++){const i=r[e];(0,o.abytes)(i);t+=i.length}const n=new Uint8Array(t);for(let e=0,t=0;e<r.length;e++){const i=r[e];n.set(i,t);t+=i.length}return n}class T{clone(){return this._cloneInto()}}s.Hash=T;function v(e,t){if(t!==undefined&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");const r=Object.assign(e,t);return r}function I(t){const e=e=>t().update(S(e)).digest();const r=t();e.outputLen=r.outputLen;e.blockLen=r.blockLen;e.create=()=>t();return e}function k(r){const e=(e,t)=>r(t).update(S(e)).digest();const t=r({});e.outputLen=t.outputLen;e.blockLen=t.blockLen;e.create=e=>r(e);return e}function O(r){const e=(e,t)=>r(t).update(S(e)).digest();const t=r({});e.outputLen=t.outputLen;e.blockLen=t.blockLen;e.create=e=>r(e);return e}function P(e=32){if(r.crypto&&typeof r.crypto.getRandomValues==="function"){return r.crypto.getRandomValues(new Uint8Array(e))}if(r.crypto&&typeof r.crypto.randomBytes==="function"){return r.crypto.randomBytes(e)}throw new Error("crypto.getRandomValues must be defined")}},{"./_assert.js":2,"@noble/hashes/crypto":4}],9:[function(e,t,r){"use strict";function n(h){if(h.length>=255){throw new TypeError("Alphabet too long")}var l=new Uint8Array(256);for(var e=0;e<l.length;e++){l[e]=255}for(var t=0;t<h.length;t++){var r=h.charAt(t);var n=r.charCodeAt(0);if(l[n]!==255){throw new TypeError(r+" is ambiguous")}l[n]=t}var d=h.length;var y=h.charAt(0);var w=Math.log(d)/Math.log(256);var g=Math.log(256)/Math.log(d);function i(e){if(e instanceof Uint8Array){}else if(ArrayBuffer.isView(e)){e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}else if(Array.isArray(e)){e=Uint8Array.from(e)}if(!(e instanceof Uint8Array)){throw new TypeError("Expected Uint8Array")}if(e.length===0){return""}var t=0;var r=0;var n=0;var i=e.length;while(n!==i&&e[n]===0){n++;t++}var o=(i-n)*g+1>>>0;var s=new Uint8Array(o);while(n!==i){var u=e[n];var f=0;for(var a=o-1;(u!==0||f<r)&&a!==-1;a--,f++){u+=256*s[a]>>>0;s[a]=u%d>>>0;u=u/d>>>0}if(u!==0){throw new Error("Non-zero carry")}r=f;n++}var c=o-r;while(c!==o&&s[c]===0){c++}var p=y.repeat(t);for(;c<o;++c){p+=h.charAt(s[c])}return p}function o(e){if(typeof e!=="string"){throw new TypeError("Expected String")}if(e.length===0){return new Uint8Array}var t=0;var r=0;var n=0;while(e[t]===y){r++;t++}var i=(e.length-t)*w+1>>>0;var o=new Uint8Array(i);while(e[t]){var s=l[e.charCodeAt(t)];if(s===255){return}var u=0;for(var f=i-1;(s!==0||u<n)&&f!==-1;f--,u++){s+=d*o[f]>>>0;o[f]=s%256>>>0;s=s/256>>>0}if(s!==0){throw new Error("Non-zero carry")}n=u;t++}var a=i-n;while(a!==i&&o[a]===0){a++}var c=new Uint8Array(r+(i-a));var p=r;while(a!==i){c[p++]=o[a++]}return c}function s(e){var t=o(e);if(t){return t}throw new Error("Non-base"+d+" character")}return{encode:i,decodeUnsafe:o,decode:s}}t.exports=n},{}],10:[function(e,t,r){"use strict";r.byteLength=s;r.toByteArray=u;r.fromByteArray=y;var f=[];var a=[];var c=typeof Uint8Array!=="undefined"?Uint8Array:Array;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,o=n.length;i<o;++i){f[i]=n[i];a[n.charCodeAt(i)]=i}a["-".charCodeAt(0)]=62;a["_".charCodeAt(0)]=63;function p(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var r=e.indexOf("=");if(r===-1)r=t;var n=r===t?0:4-r%4;return[r,n]}function s(e){var t=p(e);var r=t[0];var n=t[1];return(r+n)*3/4-n}function h(e,t,r){return(t+r)*3/4-r}function u(e){var t;var r=p(e);var n=r[0];var i=r[1];var o=new c(h(e,n,i));var s=0;var u=i>0?n-4:n;var f;for(f=0;f<u;f+=4){t=a[e.charCodeAt(f)]<<18|a[e.charCodeAt(f+1)]<<12|a[e.charCodeAt(f+2)]<<6|a[e.charCodeAt(f+3)];o[s++]=t>>16&255;o[s++]=t>>8&255;o[s++]=t&255}if(i===2){t=a[e.charCodeAt(f)]<<2|a[e.charCodeAt(f+1)]>>4;o[s++]=t&255}if(i===1){t=a[e.charCodeAt(f)]<<10|a[e.charCodeAt(f+1)]<<4|a[e.charCodeAt(f+2)]>>2;o[s++]=t>>8&255;o[s++]=t&255}return o}function l(e){return f[e>>18&63]+f[e>>12&63]+f[e>>6&63]+f[e&63]}function d(e,t,r){var n;var i=[];for(var o=t;o<r;o+=3){n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255);i.push(l(n))}return i.join("")}function y(e){var t;var r=e.length;var n=r%3;var i=[];var o=16383;for(var s=0,u=r-n;s<u;s+=o){i.push(d(e,s,s+o>u?u:s+o))}if(n===1){t=e[r-1];i.push(f[t>>2]+f[t<<4&63]+"==")}else if(n===2){t=(e[r-2]<<8)+e[r-1];i.push(f[t>>10]+f[t>>4&63]+f[t<<2&63]+"=")}return i.join("")}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.bech32m=r.bech32=void 0;const s="qpzry9x8gf2tvdw0s3jn54khce6mua7l";const h={};for(let e=0;e<s.length;e++){const a=s.charAt(e);h[a]=e}function l(e){const t=e>>25;return(e&33554431)<<5^-(t>>0&1)&996825010^-(t>>1&1)&642813549^-(t>>2&1)&513874426^-(t>>3&1)&1027748829^-(t>>4&1)&705979059}function d(t){let r=1;for(let e=0;e<t.length;++e){const n=t.charCodeAt(e);if(n<33||n>126)return"Invalid prefix ("+t+")";r=l(r)^n>>5}r=l(r);for(let e=0;e<t.length;++e){const i=t.charCodeAt(e);r=l(r)^i&31}return r}function n(t,r,n,e){let i=0;let o=0;const s=(1<<n)-1;const u=[];for(let e=0;e<t.length;++e){i=i<<r|t[e];o+=r;while(o>=n){o-=n;u.push(i>>o&s)}}if(e){if(o>0){u.push(i<<n-o&s)}}else{if(o>=r)return"Excess padding";if(i<<n-o&s)return"Non-zero padding"}return u}function o(e){return n(e,8,5,true)}function u(e){const t=n(e,5,8,false);if(Array.isArray(t))return t}function f(e){const t=n(e,5,8,false);if(Array.isArray(t))return t;throw new Error(t)}function i(e){let p;if(e==="bech32"){p=1}else{p=734539939}function t(e,r,t){t=t||90;if(e.length+7+r.length>t)throw new TypeError("Exceeds length limit");e=e.toLowerCase();let n=d(e);if(typeof n==="string")throw new Error(n);let i=e+"1";for(let t=0;t<r.length;++t){const e=r[t];if(e>>5!==0)throw new Error("Non 5-bit word");n=l(n)^e;i+=s.charAt(e)}for(let e=0;e<6;++e){n=l(n)}n^=p;for(let e=0;e<6;++e){const o=n>>(5-e)*5&31;i+=s.charAt(o)}return i}function n(e,t){t=t||90;if(e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";const r=e.toLowerCase();const n=e.toUpperCase();if(e!==r&&e!==n)return"Mixed-case string "+e;e=r;const i=e.lastIndexOf("1");if(i===-1)return"No separator character for "+e;if(i===0)return"Missing prefix for "+e;const o=e.slice(0,i);const s=e.slice(i+1);if(s.length<6)return"Data too short";let u=d(o);if(typeof u==="string")return u;const f=[];for(let e=0;e<s.length;++e){const a=s.charAt(e);const c=h[a];if(c===undefined)return"Unknown character "+a;u=l(u)^c;if(e+6>=s.length)continue;f.push(c)}if(u!==p)return"Invalid checksum for "+e;return{prefix:o,words:f}}function r(e,t){const r=n(e,t);if(typeof r==="object")return r}function i(e,t){const r=n(e,t);if(typeof r==="object")return r;throw new Error(r)}return{decodeUnsafe:r,decode:i,encode:t,toWords:o,fromWordsUnsafe:u,fromWords:f}}r.bech32=i("bech32");r.bech32m=i("bech32m")},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});const d=e("../parser");function n(e){const t=e[0];const r=d.psbtToKeyVals(t);const n=e.slice(1);if(n.length===0)throw new Error("Combine: Nothing to combine");const i=w(t);if(i===undefined){throw new Error("Combine: Self missing transaction")}const o=g(r.globalKeyVals);const s=r.inputKeyVals.map(g);const u=r.outputKeyVals.map(g);for(const f of n){const a=w(f);if(a===undefined||!a.toBuffer().equals(i.toBuffer())){throw new Error("Combine: One of the Psbts does not have the same transaction.")}const c=d.psbtToKeyVals(f);const p=g(c.globalKeyVals);p.forEach(y(o,r.globalKeyVals,c.globalKeyVals));const h=c.inputKeyVals.map(g);h.forEach((e,t)=>e.forEach(y(s[t],r.inputKeyVals[t],c.inputKeyVals[t])));const l=c.outputKeyVals.map(g);l.forEach((e,t)=>e.forEach(y(u[t],r.outputKeyVals[t],c.outputKeyVals[t])))}return d.psbtFromKeyVals(i,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}r.combine=n;function y(r,n,i){return t=>{if(r.has(t))return;const e=i.filter(e=>e.key.toString("hex")===t)[0];n.push(e);r.add(t)}}function w(e){return e.globalMap.unsignedTx}function g(e){const r=new Set;e.forEach(e=>{const t=e.key.toString("hex");if(r.has(t))throw new Error("Combine: KeyValue Map keys should be unique");r.add(t)});return r}},{"../parser":37}],13:[function(i,e,o){(function(s){(function(){"use strict";Object.defineProperty(o,"__esModule",{value:true});const u=i("../../typeFields");const f=e=>[...Array(e).keys()];function e(e){if(e.key[0]!==u.GlobalTypes.GLOBAL_XPUB){throw new Error("Decode Error: could not decode globalXpub with key 0x"+e.key.toString("hex"))}if(e.key.length!==79||![2,3].includes(e.key[46])){throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+e.key.toString("hex"))}if(e.value.length/4%1!==0){throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4")}const t=e.key.slice(1);const r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(const n of f(e.value.length/4-1)){const i=e.value.readUInt32LE(n*4+4);const o=!!(i&2147483648);const s=i&2147483647;r.path+="/"+s.toString(10)+(o?"'":"")}return r}o.decode=e;function t(e){const t=s.from([u.GlobalTypes.GLOBAL_XPUB]);const r=s.concat([t,e.extendedPubkey]);const n=e.path.split("/");const i=s.allocUnsafe(n.length*4);e.masterFingerprint.copy(i,0);let o=4;n.slice(1).forEach(e=>{const t=e.slice(-1)==="'";let r=2147483647&parseInt(t?e.slice(0,-1):e,10);if(t)r+=2147483648;i.writeUInt32LE(r,o);o+=4});return{key:r,value:i}}o.encode=t;o.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }";function r(e){const t=e.extendedPubkey;const r=e.masterFingerprint;const n=e.path;return s.isBuffer(t)&&t.length===78&&[2,3].indexOf(t[45])>-1&&s.isBuffer(r)&&r.length===4&&typeof n==="string"&&!!n.match(/^m(\/\d+'?)*$/)}o.check=r;function n(e,t,r){const n=t.extendedPubkey.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.extendedPubkey.equals(t.extendedPubkey)).length===0}o.canAddToArray=n}).call(this)}).call(this,i("buffer").Buffer)},{"../../typeFields":40,buffer:75}],14:[function(n,e,i){(function(r){(function(){"use strict";Object.defineProperty(i,"__esModule",{value:true});const t=n("../../typeFields");function e(e){return{key:r.from([t.GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}i.encode=e}).call(this)}).call(this,n("buffer").Buffer)},{"../../typeFields":40,buffer:75}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});const n=e("../typeFields");const i=e("./global/globalXpub");const o=e("./global/unsignedTx");const s=e("./input/finalScriptSig");const u=e("./input/finalScriptWitness");const f=e("./input/nonWitnessUtxo");const a=e("./input/partialSig");const c=e("./input/porCommitment");const p=e("./input/sighashType");const h=e("./input/tapKeySig");const l=e("./input/tapLeafScript");const d=e("./input/tapMerkleRoot");const y=e("./input/tapScriptSig");const w=e("./input/witnessUtxo");const g=e("./output/tapTree");const b=e("./shared/bip32Derivation");const m=e("./shared/checkPubkey");const E=e("./shared/redeemScript");const S=e("./shared/tapBip32Derivation");const _=e("./shared/tapInternalKey");const T=e("./shared/witnessScript");const v={unsignedTx:o,globalXpub:i,checkPubkey:m.makeChecker([])};r.globals=v;const I={nonWitnessUtxo:f,partialSig:a,sighashType:p,finalScriptSig:s,finalScriptWitness:u,porCommitment:c,witnessUtxo:w,bip32Derivation:b.makeConverter(n.InputTypes.BIP32_DERIVATION),redeemScript:E.makeConverter(n.InputTypes.REDEEM_SCRIPT),witnessScript:T.makeConverter(n.InputTypes.WITNESS_SCRIPT),checkPubkey:m.makeChecker([n.InputTypes.PARTIAL_SIG,n.InputTypes.BIP32_DERIVATION]),tapKeySig:h,tapScriptSig:y,tapLeafScript:l,tapBip32Derivation:S.makeConverter(n.InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:_.makeConverter(n.InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot:d};r.inputs=I;const k={bip32Derivation:b.makeConverter(n.OutputTypes.BIP32_DERIVATION),redeemScript:E.makeConverter(n.OutputTypes.REDEEM_SCRIPT),witnessScript:T.makeConverter(n.OutputTypes.WITNESS_SCRIPT),checkPubkey:m.makeChecker([n.OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:S.makeConverter(n.OutputTypes.TAP_BIP32_DERIVATION),tapTree:g,tapInternalKey:_.makeConverter(n.OutputTypes.TAP_INTERNAL_KEY)};r.outputs=k},{"../typeFields":40,"./global/globalXpub":13,"./global/unsignedTx":14,"./input/finalScriptSig":16,"./input/finalScriptWitness":17,"./input/nonWitnessUtxo":18,"./input/partialSig":19,"./input/porCommitment":20,"./input/sighashType":21,"./input/tapKeySig":22,"./input/tapLeafScript":23,"./input/tapMerkleRoot":24,"./input/tapScriptSig":25,"./input/witnessUtxo":26,"./output/tapTree":27,"./shared/bip32Derivation":28,"./shared/checkPubkey":29,"./shared/redeemScript":30,"./shared/tapBip32Derivation":31,"./shared/tapInternalKey":32,"./shared/witnessScript":33}],16:[function(s,e,u){(function(o){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const r=s("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.FINAL_SCRIPTSIG){throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+e.key.toString("hex"))}return e.value}u.decode=e;function t(e){const t=o.from([r.InputTypes.FINAL_SCRIPTSIG]);return{key:t,value:e}}u.encode=t;u.expected="Buffer";function n(e){return o.isBuffer(e)}u.check=n;function i(e,t){return!!e&&!!t&&e.finalScriptSig===undefined}u.canAdd=i}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":40,buffer:75}],17:[function(s,e,u){(function(o){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const r=s("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.FINAL_SCRIPTWITNESS){throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+e.key.toString("hex"))}return e.value}u.decode=e;function t(e){const t=o.from([r.InputTypes.FINAL_SCRIPTWITNESS]);return{key:t,value:e}}u.encode=t;u.expected="Buffer";function n(e){return o.isBuffer(e)}u.check=n;function i(e,t){return!!e&&!!t&&e.finalScriptWitness===undefined}u.canAdd=i}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":40,buffer:75}],18:[function(s,e,u){(function(o){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const t=s("../../typeFields");function e(e){if(e.key[0]!==t.InputTypes.NON_WITNESS_UTXO){throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+e.key.toString("hex"))}return e.value}u.decode=e;function r(e){return{key:o.from([t.InputTypes.NON_WITNESS_UTXO]),value:e}}u.encode=r;u.expected="Buffer";function n(e){return o.isBuffer(e)}u.check=n;function i(e,t){return!!e&&!!t&&e.nonWitnessUtxo===undefined}u.canAdd=i}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":40,buffer:75}],19:[function(u,e,f){(function(s){(function(){"use strict";Object.defineProperty(f,"__esModule",{value:true});const r=u("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.PARTIAL_SIG){throw new Error("Decode Error: could not decode partialSig with key 0x"+e.key.toString("hex"))}if(!(e.key.length===34||e.key.length===66)||![2,3,4].includes(e.key[1])){throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+e.key.toString("hex"))}const t=e.key.slice(1);return{pubkey:t,signature:e.value}}f.decode=e;function t(e){const t=s.from([r.InputTypes.PARTIAL_SIG]);return{key:s.concat([t,e.pubkey]),value:e.signature}}f.encode=t;f.expected="{ pubkey: Buffer; signature: Buffer; }";function n(e){return s.isBuffer(e.pubkey)&&s.isBuffer(e.signature)&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&i(e.signature)}f.check=n;function i(e){if(!s.isBuffer(e)||e.length<9)return false;if(e[0]!==48)return false;if(e.length!==e[1]+3)return false;if(e[2]!==2)return false;const t=e[3];if(t>33||t<1)return false;if(e[3+t+1]!==2)return false;const r=e[3+t+2];if(r>33||r<1)return false;if(e.length!==3+t+2+r+2)return false;return true}function o(e,t,r){const n=t.pubkey.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.pubkey.equals(t.pubkey)).length===0}f.canAddToArray=o}).call(this)}).call(this,u("buffer").Buffer)},{"../../typeFields":40,buffer:75}],20:[function(s,e,u){(function(o){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const r=s("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.POR_COMMITMENT){throw new Error("Decode Error: could not decode porCommitment with key 0x"+e.key.toString("hex"))}return e.value.toString("utf8")}u.decode=e;function t(e){const t=o.from([r.InputTypes.POR_COMMITMENT]);return{key:t,value:o.from(e,"utf8")}}u.encode=t;u.expected="string";function n(e){return typeof e==="string"}u.check=n;function i(e,t){return!!e&&!!t&&e.porCommitment===undefined}u.canAdd=i}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":40,buffer:75}],21:[function(s,e,u){(function(o){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const n=s("../../typeFields");function e(e){if(e.key[0]!==n.InputTypes.SIGHASH_TYPE){throw new Error("Decode Error: could not decode sighashType with key 0x"+e.key.toString("hex"))}return e.value.readUInt32LE(0)}u.decode=e;function t(e){const t=o.from([n.InputTypes.SIGHASH_TYPE]);const r=o.allocUnsafe(4);r.writeUInt32LE(e,0);return{key:t,value:r}}u.encode=t;u.expected="number";function r(e){return typeof e==="number"}u.check=r;function i(e,t){return!!e&&!!t&&e.sighashType===undefined}u.canAdd=i}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":40,buffer:75}],22:[function(s,e,u){(function(o){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const r=s("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.TAP_KEY_SIG||e.key.length!==1){throw new Error("Decode Error: could not decode tapKeySig with key 0x"+e.key.toString("hex"))}if(!n(e.value)){throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature")}return e.value}u.decode=e;function t(e){const t=o.from([r.InputTypes.TAP_KEY_SIG]);return{key:t,value:e}}u.encode=t;u.expected="Buffer";function n(e){return o.isBuffer(e)&&(e.length===64||e.length===65)}u.check=n;function i(e,t){return!!e&&!!t&&e.tapKeySig===undefined}u.canAdd=i}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":40,buffer:75}],23:[function(s,e,u){(function(o){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const i=s("../../typeFields");function e(e){if(e.key[0]!==i.InputTypes.TAP_LEAF_SCRIPT){throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+e.key.toString("hex"))}if((e.key.length-2)%32!==0){throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+e.key.toString("hex"))}const t=e.value[e.value.length-1];if((e.key[1]&254)!==t){throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+e.key.toString("hex"))}const r=e.value.slice(0,-1);const n=e.key.slice(1);return{controlBlock:n,script:r,leafVersion:t}}u.decode=e;function t(e){const t=o.from([i.InputTypes.TAP_LEAF_SCRIPT]);const r=o.from([e.leafVersion]);return{key:o.concat([t,e.controlBlock]),value:o.concat([e.script,r])}}u.encode=t;u.expected="{ controlBlock: Buffer; leafVersion: number, script: Buffer; }";function r(e){return o.isBuffer(e.controlBlock)&&(e.controlBlock.length-1)%32===0&&(e.controlBlock[0]&254)===e.leafVersion&&o.isBuffer(e.script)}u.check=r;function n(e,t,r){const n=t.controlBlock.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.controlBlock.equals(t.controlBlock)).length===0}u.canAddToArray=n}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":40,buffer:75}],24:[function(s,e,u){(function(o){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const r=s("../../typeFields");function e(e){if(e.key[0]!==r.InputTypes.TAP_MERKLE_ROOT||e.key.length!==1){throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+e.key.toString("hex"))}if(!n(e.value)){throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash")}return e.value}u.decode=e;function t(e){const t=o.from([r.InputTypes.TAP_MERKLE_ROOT]);return{key:t,value:e}}u.encode=t;u.expected="Buffer";function n(e){return o.isBuffer(e)&&e.length===32}u.check=n;function i(e,t){return!!e&&!!t&&e.tapMerkleRoot===undefined}u.canAdd=i}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":40,buffer:75}],25:[function(s,e,u){(function(o){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const n=s("../../typeFields");function e(e){if(e.key[0]!==n.InputTypes.TAP_SCRIPT_SIG){throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+e.key.toString("hex"))}if(e.key.length!==65){throw new Error("Decode Error: tapScriptSig has invalid key 0x"+e.key.toString("hex"))}if(e.value.length!==64&&e.value.length!==65){throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+e.key.toString("hex"))}const t=e.key.slice(1,33);const r=e.key.slice(33);return{pubkey:t,leafHash:r,signature:e.value}}u.decode=e;function t(e){const t=o.from([n.InputTypes.TAP_SCRIPT_SIG]);return{key:o.concat([t,e.pubkey,e.leafHash]),value:e.signature}}u.encode=t;u.expected="{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }";function r(e){return o.isBuffer(e.pubkey)&&o.isBuffer(e.leafHash)&&o.isBuffer(e.signature)&&e.pubkey.length===32&&e.leafHash.length===32&&(e.signature.length===64||e.signature.length===65)}u.check=r;function i(e,t,r){const n=t.pubkey.toString("hex")+t.leafHash.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.pubkey.equals(t.pubkey)&&e.leafHash.equals(t.leafHash)).length===0}u.canAddToArray=i}).call(this)}).call(this,s("buffer").Buffer)},{"../../typeFields":40,buffer:75}],26:[function(i,e,a){(function(f){(function(){"use strict";Object.defineProperty(a,"__esModule",{value:true});const o=i("../../typeFields");const s=i("../tools");const u=i("../varint");function e(e){if(e.key[0]!==o.InputTypes.WITNESS_UTXO){throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+e.key.toString("hex"))}const t=s.readUInt64LE(e.value,0);let r=8;const n=u.decode(e.value,r);r+=u.encodingLength(n);const i=e.value.slice(r);if(i.length!==n){throw new Error("Decode Error: WITNESS_UTXO script is not proper length")}return{script:i,value:t}}a.decode=e;function t(e){const{script:t,value:r}=e;const n=u.encodingLength(t.length);const i=f.allocUnsafe(8+n+t.length);s.writeUInt64LE(i,r,0);u.encode(t.length,i,8);t.copy(i,8+n);return{key:f.from([o.InputTypes.WITNESS_UTXO]),value:i}}a.encode=t;a.expected="{ script: Buffer; value: number; }";function r(e){return f.isBuffer(e.script)&&typeof e.value==="number"}a.check=r;function n(e,t){return!!e&&!!t&&e.witnessUtxo===undefined}a.canAdd=n}).call(this)}).call(this,i("buffer").Buffer)},{"../../typeFields":40,"../tools":34,"../varint":35,buffer:75}],27:[function(o,e,f){(function(i){(function(){"use strict";Object.defineProperty(f,"__esModule",{value:true});const s=o("../../typeFields");const u=o("../varint");function e(e){if(e.key[0]!==s.OutputTypes.TAP_TREE||e.key.length!==1){throw new Error("Decode Error: could not decode tapTree with key 0x"+e.key.toString("hex"))}let t=0;const r=[];while(t<e.value.length){const n=e.value[t++];const i=e.value[t++];const o=u.decode(e.value,t);t+=u.encodingLength(o);r.push({depth:n,leafVersion:i,script:e.value.slice(t,t+o)});t+=o}return{leaves:r}}f.decode=e;function t(e){const t=i.from([s.OutputTypes.TAP_TREE]);const r=[].concat(...e.leaves.map(e=>[i.of(e.depth,e.leafVersion),u.encode(e.script.length),e.script]));return{key:t,value:i.concat(r)}}f.encode=t;f.expected="{ leaves: [{ depth: number; leafVersion: number, script: Buffer; }] }";function r(e){return Array.isArray(e.leaves)&&e.leaves.every(e=>e.depth>=0&&e.depth<=128&&(e.leafVersion&254)===e.leafVersion&&i.isBuffer(e.script))}f.check=r;function n(e,t){return!!e&&!!t&&e.tapTree===undefined}f.canAdd=n}).call(this)}).call(this,o("buffer").Buffer)},{"../../typeFields":40,"../varint":35,buffer:75}],28:[function(e,t,r){(function(s){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const a=e=>[...Array(e).keys()];const o=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&4===e[0];function e(u,f=o){function e(e){if(e.key[0]!==u){throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+e.key.toString("hex"))}const t=e.key.slice(1);if(!f(t)){throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+e.key.toString("hex"))}if(e.value.length/4%1!==0){throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4")}const r={masterFingerprint:e.value.slice(0,4),pubkey:t,path:"m"};for(const n of a(e.value.length/4-1)){const i=e.value.readUInt32LE(n*4+4);const o=!!(i&2147483648);const s=i&2147483647;r.path+="/"+s.toString(10)+(o?"'":"")}return r}function t(e){const t=s.from([u]);const r=s.concat([t,e.pubkey]);const n=e.path.split("/");const i=s.allocUnsafe(n.length*4);e.masterFingerprint.copy(i,0);let o=4;n.slice(1).forEach(e=>{const t=e.slice(-1)==="'";let r=2147483647&parseInt(t?e.slice(0,-1):e,10);if(t)r+=2147483648;i.writeUInt32LE(r,o);o+=4});return{key:r,value:i}}const r="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }";function n(e){return s.isBuffer(e.pubkey)&&s.isBuffer(e.masterFingerprint)&&typeof e.path==="string"&&f(e.pubkey)&&e.masterFingerprint.length===4}function i(e,t,r){const n=t.pubkey.toString("hex");if(r.has(n))return false;r.add(n);return e.filter(e=>e.pubkey.equals(t.pubkey)).length===0}return{decode:e,encode:t,check:n,expected:r,canAddToArray:i}}r.makeConverter=e}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});function n(r){return e;function e(e){let t;if(r.includes(e.key[0])){t=e.key.slice(1);if(!(t.length===33||t.length===65)||![2,3,4].includes(t[0])){throw new Error("Format Error: invalid pubkey in key 0x"+e.key.toString("hex"))}}return t}}r.makeChecker=n},{}],30:[function(e,t,r){(function(s){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});function e(r){function e(e){if(e.key[0]!==r){throw new Error("Decode Error: could not decode redeemScript with key 0x"+e.key.toString("hex"))}return e.value}function t(e){const t=s.from([r]);return{key:t,value:e}}const n="Buffer";function i(e){return s.isBuffer(e)}function o(e,t){return!!e&&!!t&&e.redeemScript===undefined}return{decode:e,encode:t,check:i,expected:n,canAdd:o}}r.makeConverter=e}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],31:[function(t,e,r){(function(a){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const u=t("../varint");const o=t("./bip32Derivation");const f=e=>e.length===32;function e(e){const s=o.makeConverter(e,f);function t(r){const n=u.decode(r.value);const i=u.encodingLength(n);const e=s.decode({key:r.key,value:r.value.slice(i+n*32)});const o=new Array(n);for(let e=0,t=i;e<n;e++,t+=32){o[e]=r.value.slice(t,t+32)}return Object.assign({},e,{leafHashes:o})}function r(e){const t=s.encode(e);const r=u.encodingLength(e.leafHashes.length);const n=a.allocUnsafe(r);u.encode(e.leafHashes.length,n);const i=a.concat([n,...e.leafHashes,t.value]);return Object.assign({},t,{value:i})}const n="{ "+"masterFingerprint: Buffer; "+"pubkey: Buffer; "+"path: string; "+"leafHashes: Buffer[]; "+"}";function i(e){return Array.isArray(e.leafHashes)&&e.leafHashes.every(e=>a.isBuffer(e)&&e.length===32)&&s.check(e)}return{decode:t,encode:r,check:i,expected:n,canAddToArray:s.canAddToArray}}r.makeConverter=e}).call(this)}).call(this,t("buffer").Buffer)},{"../varint":35,"./bip32Derivation":28,buffer:75}],32:[function(e,t,r){(function(s){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});function e(r){function e(e){if(e.key[0]!==r||e.key.length!==1){throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+e.key.toString("hex"))}if(e.value.length!==32){throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey")}return e.value}function t(e){const t=s.from([r]);return{key:t,value:e}}const n="Buffer";function i(e){return s.isBuffer(e)&&e.length===32}function o(e,t){return!!e&&!!t&&e.tapInternalKey===undefined}return{decode:e,encode:t,check:i,expected:n,canAdd:o}}r.makeConverter=e}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],33:[function(e,t,r){(function(s){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});function e(r){function e(e){if(e.key[0]!==r){throw new Error("Decode Error: could not decode witnessScript with key 0x"+e.key.toString("hex"))}return e.value}function t(e){const t=s.from([r]);return{key:t,value:e}}const n="Buffer";function i(e){return s.isBuffer(e)}function o(e,t){return!!e&&!!t&&e.witnessScript===undefined}return{decode:e,encode:t,check:i,expected:n,canAdd:o}}r.makeConverter=e}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],34:[function(f,e,a){(function(u){(function(){"use strict";Object.defineProperty(a,"__esModule",{value:true});const s=f("./varint");a.range=e=>[...Array(e).keys()];function e(t){if(t.length<1)return t;let r=t.length-1;let n=0;for(let e=0;e<t.length/2;e++){n=t[e];t[e]=t[r];t[r]=n;r--}return t}a.reverseBuffer=e;function t(e){const t=e.map(r);t.push(u.from([0]));return u.concat(t)}a.keyValsToBuffer=t;function r(e){const t=e.key.length;const r=e.value.length;const n=s.encodingLength(t);const i=s.encodingLength(r);const o=u.allocUnsafe(n+t+i+r);s.encode(t,o,0);e.key.copy(o,n);s.encode(r,o,n+t);e.value.copy(o,n+t+i);return o}a.keyValToBuffer=r;function i(e,t){if(typeof e!=="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function n(e,t){const r=e.readUInt32LE(t);let n=e.readUInt32LE(t+4);n*=4294967296;i(n+r,9007199254740991);return n+r}a.readUInt64LE=n;function o(e,t,r){i(t,9007199254740991);e.writeInt32LE(t&-1,r);e.writeUInt32LE(Math.floor(t/4294967296),r+4);return r+8}a.writeUInt64LE=o}).call(this)}).call(this,f("buffer").Buffer)},{"./varint":35,buffer:75}],35:[function(e,t,r){(function(f){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const t=9007199254740991;function s(e){if(e<0||e>t||e%1!==0)throw new RangeError("value out of range")}function n(e,t,r){s(e);if(!t)t=f.allocUnsafe(i(e));if(!f.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(!r)r=0;if(e<253){t.writeUInt8(e,r);Object.assign(n,{bytes:1})}else if(e<=65535){t.writeUInt8(253,r);t.writeUInt16LE(e,r+1);Object.assign(n,{bytes:3})}else if(e<=4294967295){t.writeUInt8(254,r);t.writeUInt32LE(e,r+1);Object.assign(n,{bytes:5})}else{t.writeUInt8(255,r);t.writeUInt32LE(e>>>0,r+1);t.writeUInt32LE(e/4294967296|0,r+5);Object.assign(n,{bytes:9})}return t}r.encode=n;function u(e,t){if(!f.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(!t)t=0;const r=e.readUInt8(t);if(r<253){Object.assign(u,{bytes:1});return r}else if(r===253){Object.assign(u,{bytes:3});return e.readUInt16LE(t+1)}else if(r===254){Object.assign(u,{bytes:5});return e.readUInt32LE(t+1)}else{Object.assign(u,{bytes:9});const n=e.readUInt32LE(t+1);const i=e.readUInt32LE(t+5);const o=i*4294967296+n;s(o);return o}}r.decode=u;function i(e){s(e);return e<253?1:e<=65535?3:e<=4294967295?5:9}r.encodingLength=i}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],36:[function(t,e,r){(function(n){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const d=t("../converter");const T=t("../converter/tools");const v=t("../converter/varint");const I=t("../typeFields");function e(r,e){let n=0;function i(){const e=v.decode(r,n);n+=v.encodingLength(e);const t=r.slice(n,n+e);n+=e;return t}function t(){const e=r.readUInt32BE(n);n+=4;return e}function o(){const e=r.readUInt8(n);n+=1;return e}function s(){const e=i();const t=i();return{key:e,value:t}}function u(){if(n>=r.length){throw new Error("Format Error: Unexpected End of PSBT")}const e=r.readUInt8(n)===0;if(e){n++}return e}if(t()!==1886610036){throw new Error("Format Error: Invalid Magic Number")}if(o()!==255){throw new Error("Format Error: Magic Number must be followed by 0xff separator")}const f=[];const a={};while(!u()){const w=s();const g=w.key.toString("hex");if(a[g]){throw new Error("Format Error: Keys must be unique for global keymap: key "+g)}a[g]=1;f.push(w)}const c=f.filter(e=>e.key[0]===I.GlobalTypes.UNSIGNED_TX);if(c.length!==1){throw new Error("Format Error: Only one UNSIGNED_TX allowed")}const p=e(c[0].value);const{inputCount:h,outputCount:l}=p.getInputOutputCounts();const d=[];const y=[];for(const b of T.range(h)){const m={};const E=[];while(!u()){const w=s();const g=w.key.toString("hex");if(m[g]){throw new Error("Format Error: Keys must be unique for each input: "+"input index "+b+" key "+g)}m[g]=1;E.push(w)}d.push(E)}for(const b of T.range(l)){const S={};const _=[];while(!u()){const w=s();const g=w.key.toString("hex");if(S[g]){throw new Error("Format Error: Keys must be unique for each output: "+"output index "+b+" key "+g)}S[g]=1;_.push(w)}y.push(_)}return k(p,{globalMapKeyVals:f,inputKeyVals:d,outputKeyVals:y})}r.psbtFromBuffer=e;function y(e,t,r){if(!t.equals(n.from([r]))){throw new Error(`Format Error: Invalid ${e} key: ${t.toString("hex")}`)}}r.checkKeyBuffer=y;function k(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:n}){const i={unsignedTx:e};let o=0;for(const c of t){switch(c.key[0]){case I.GlobalTypes.UNSIGNED_TX:y("global",c.key,I.GlobalTypes.UNSIGNED_TX);if(o>0){throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX")}o++;break;case I.GlobalTypes.GLOBAL_XPUB:if(i.globalXpub===undefined){i.globalXpub=[]}i.globalXpub.push(d.globals.globalXpub.decode(c));break;default:if(!i.unknownKeyVals)i.unknownKeyVals=[];i.unknownKeyVals.push(c)}}const s=r.length;const u=n.length;const f=[];const a=[];for(const p of T.range(s)){const h={};for(const c of r[p]){d.inputs.checkPubkey(c);switch(c.key[0]){case I.InputTypes.NON_WITNESS_UTXO:y("input",c.key,I.InputTypes.NON_WITNESS_UTXO);if(h.nonWitnessUtxo!==undefined){throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO")}h.nonWitnessUtxo=d.inputs.nonWitnessUtxo.decode(c);break;case I.InputTypes.WITNESS_UTXO:y("input",c.key,I.InputTypes.WITNESS_UTXO);if(h.witnessUtxo!==undefined){throw new Error("Format Error: Input has multiple WITNESS_UTXO")}h.witnessUtxo=d.inputs.witnessUtxo.decode(c);break;case I.InputTypes.PARTIAL_SIG:if(h.partialSig===undefined){h.partialSig=[]}h.partialSig.push(d.inputs.partialSig.decode(c));break;case I.InputTypes.SIGHASH_TYPE:y("input",c.key,I.InputTypes.SIGHASH_TYPE);if(h.sighashType!==undefined){throw new Error("Format Error: Input has multiple SIGHASH_TYPE")}h.sighashType=d.inputs.sighashType.decode(c);break;case I.InputTypes.REDEEM_SCRIPT:y("input",c.key,I.InputTypes.REDEEM_SCRIPT);if(h.redeemScript!==undefined){throw new Error("Format Error: Input has multiple REDEEM_SCRIPT")}h.redeemScript=d.inputs.redeemScript.decode(c);break;case I.InputTypes.WITNESS_SCRIPT:y("input",c.key,I.InputTypes.WITNESS_SCRIPT);if(h.witnessScript!==undefined){throw new Error("Format Error: Input has multiple WITNESS_SCRIPT")}h.witnessScript=d.inputs.witnessScript.decode(c);break;case I.InputTypes.BIP32_DERIVATION:if(h.bip32Derivation===undefined){h.bip32Derivation=[]}h.bip32Derivation.push(d.inputs.bip32Derivation.decode(c));break;case I.InputTypes.FINAL_SCRIPTSIG:y("input",c.key,I.InputTypes.FINAL_SCRIPTSIG);h.finalScriptSig=d.inputs.finalScriptSig.decode(c);break;case I.InputTypes.FINAL_SCRIPTWITNESS:y("input",c.key,I.InputTypes.FINAL_SCRIPTWITNESS);h.finalScriptWitness=d.inputs.finalScriptWitness.decode(c);break;case I.InputTypes.POR_COMMITMENT:y("input",c.key,I.InputTypes.POR_COMMITMENT);h.porCommitment=d.inputs.porCommitment.decode(c);break;case I.InputTypes.TAP_KEY_SIG:y("input",c.key,I.InputTypes.TAP_KEY_SIG);h.tapKeySig=d.inputs.tapKeySig.decode(c);break;case I.InputTypes.TAP_SCRIPT_SIG:if(h.tapScriptSig===undefined){h.tapScriptSig=[]}h.tapScriptSig.push(d.inputs.tapScriptSig.decode(c));break;case I.InputTypes.TAP_LEAF_SCRIPT:if(h.tapLeafScript===undefined){h.tapLeafScript=[]}h.tapLeafScript.push(d.inputs.tapLeafScript.decode(c));break;case I.InputTypes.TAP_BIP32_DERIVATION:if(h.tapBip32Derivation===undefined){h.tapBip32Derivation=[]}h.tapBip32Derivation.push(d.inputs.tapBip32Derivation.decode(c));break;case I.InputTypes.TAP_INTERNAL_KEY:y("input",c.key,I.InputTypes.TAP_INTERNAL_KEY);h.tapInternalKey=d.inputs.tapInternalKey.decode(c);break;case I.InputTypes.TAP_MERKLE_ROOT:y("input",c.key,I.InputTypes.TAP_MERKLE_ROOT);h.tapMerkleRoot=d.inputs.tapMerkleRoot.decode(c);break;default:if(!h.unknownKeyVals)h.unknownKeyVals=[];h.unknownKeyVals.push(c)}}f.push(h)}for(const p of T.range(u)){const l={};for(const c of n[p]){d.outputs.checkPubkey(c);switch(c.key[0]){case I.OutputTypes.REDEEM_SCRIPT:y("output",c.key,I.OutputTypes.REDEEM_SCRIPT);if(l.redeemScript!==undefined){throw new Error("Format Error: Output has multiple REDEEM_SCRIPT")}l.redeemScript=d.outputs.redeemScript.decode(c);break;case I.OutputTypes.WITNESS_SCRIPT:y("output",c.key,I.OutputTypes.WITNESS_SCRIPT);if(l.witnessScript!==undefined){throw new Error("Format Error: Output has multiple WITNESS_SCRIPT")}l.witnessScript=d.outputs.witnessScript.decode(c);break;case I.OutputTypes.BIP32_DERIVATION:if(l.bip32Derivation===undefined){l.bip32Derivation=[]}l.bip32Derivation.push(d.outputs.bip32Derivation.decode(c));break;case I.OutputTypes.TAP_INTERNAL_KEY:y("output",c.key,I.OutputTypes.TAP_INTERNAL_KEY);l.tapInternalKey=d.outputs.tapInternalKey.decode(c);break;case I.OutputTypes.TAP_TREE:y("output",c.key,I.OutputTypes.TAP_TREE);l.tapTree=d.outputs.tapTree.decode(c);break;case I.OutputTypes.TAP_BIP32_DERIVATION:if(l.tapBip32Derivation===undefined){l.tapBip32Derivation=[]}l.tapBip32Derivation.push(d.outputs.tapBip32Derivation.decode(c));break;default:if(!l.unknownKeyVals)l.unknownKeyVals=[];l.unknownKeyVals.push(c)}}a.push(l)}return{globalMap:i,inputs:f,outputs:a}}r.psbtFromKeyVals=k}).call(this)}).call(this,t("buffer").Buffer)},{"../converter":15,"../converter/tools":34,"../converter/varint":35,"../typeFields":40,buffer:75}],37:[function(e,t,r){"use strict";function n(e){for(var t in e)if(!r.hasOwnProperty(t))r[t]=e[t]}Object.defineProperty(r,"__esModule",{value:true});n(e("./fromBuffer"));n(e("./toBuffer"))},{"./fromBuffer":36,"./toBuffer":38}],38:[function(t,e,r){(function(l){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});const n=t("../converter");const p=t("../converter/tools");function e({globalMap:e,inputs:t,outputs:r}){const{globalKeyVals:n,inputKeyVals:i,outputKeyVals:o}=h({globalMap:e,inputs:t,outputs:r});const s=p.keyValsToBuffer(n);const u=e=>e.length===0?[l.from([0])]:e.map(p.keyValsToBuffer);const f=u(i);const a=u(o);const c=l.allocUnsafe(5);c.writeUIntBE(482972169471,0,5);return l.concat([c,s].concat(f,a))}r.psbtToBuffer=e;const i=(e,t)=>{return e.key.compare(t.key)};function o(e,s){const u=new Set;const t=Object.entries(e).reduce((e,[t,r])=>{if(t==="unknownKeyVals")return e;const n=s[t];if(n===undefined)return e;const i=(Array.isArray(r)?r:[r]).map(n.encode);const o=i.map(e=>e.key.toString("hex"));o.forEach(e=>{if(u.has(e))throw new Error("Serialize Error: Duplicate key: "+e);u.add(e)});return e.concat(i)},[]);const r=e.unknownKeyVals?e.unknownKeyVals.filter(e=>{return!u.has(e.key.toString("hex"))}):[];return t.concat(r).sort(i)}function h({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:o(e,n.globals),inputKeyVals:t.map(e=>o(e,n.inputs)),outputKeyVals:r.map(e=>o(e,n.outputs))}}r.psbtToKeyVals=h}).call(this)}).call(this,t("buffer").Buffer)},{"../converter":15,"../converter/tools":34,buffer:75}],39:[function(t,e,u){(function(s){(function(){"use strict";Object.defineProperty(u,"__esModule",{value:true});const r=t("./combiner");const i=t("./parser");const n=t("./typeFields");const o=t("./utils");class e{constructor(e){this.inputs=[];this.outputs=[];this.globalMap={unsignedTx:e}}static fromBase64(e,t){const r=s.from(e,"base64");return this.fromBuffer(r,t)}static fromHex(e,t){const r=s.from(e,"hex");return this.fromBuffer(r,t)}static fromBuffer(e,t){const r=i.psbtFromBuffer(e,t);const n=new this(r.globalMap.unsignedTx);Object.assign(n,r);return n}toBase64(){const e=this.toBuffer();return e.toString("base64")}toHex(){const e=this.toBuffer();return e.toString("hex")}toBuffer(){return i.psbtToBuffer(this)}updateGlobal(e){o.updateGlobal(e,this.globalMap);return this}updateInput(e,t){const r=o.checkForInput(this.inputs,e);o.updateInput(t,r);return this}updateOutput(e,t){const r=o.checkForOutput(this.outputs,e);o.updateOutput(t,r);return this}addUnknownKeyValToGlobal(e){o.checkHasKey(e,this.globalMap.unknownKeyVals,o.getEnumLength(n.GlobalTypes));if(!this.globalMap.unknownKeyVals)this.globalMap.unknownKeyVals=[];this.globalMap.unknownKeyVals.push(e);return this}addUnknownKeyValToInput(e,t){const r=o.checkForInput(this.inputs,e);o.checkHasKey(t,r.unknownKeyVals,o.getEnumLength(n.InputTypes));if(!r.unknownKeyVals)r.unknownKeyVals=[];r.unknownKeyVals.push(t);return this}addUnknownKeyValToOutput(e,t){const r=o.checkForOutput(this.outputs,e);o.checkHasKey(t,r.unknownKeyVals,o.getEnumLength(n.OutputTypes));if(!r.unknownKeyVals)r.unknownKeyVals=[];r.unknownKeyVals.push(t);return this}addInput(e){this.globalMap.unsignedTx.addInput(e);this.inputs.push({unknownKeyVals:[]});const t=e.unknownKeyVals||[];const r=this.inputs.length-1;if(!Array.isArray(t)){throw new Error("unknownKeyVals must be an Array")}t.forEach(e=>this.addUnknownKeyValToInput(r,e));o.addInputAttributes(this.inputs,e);return this}addOutput(e){this.globalMap.unsignedTx.addOutput(e);this.outputs.push({unknownKeyVals:[]});const t=e.unknownKeyVals||[];const r=this.outputs.length-1;if(!Array.isArray(t)){throw new Error("unknownKeyVals must be an Array")}t.forEach(e=>this.addUnknownKeyValToOutput(r,e));o.addOutputAttributes(this.outputs,e);return this}clearFinalizedInput(e){const t=o.checkForInput(this.inputs,e);o.inputCheckUncleanFinalized(e,t);for(const r of Object.keys(t)){if(!["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(r)){delete t[r]}}return this}combine(...e){const t=r.combine([this].concat(e));Object.assign(this,t);return this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}}u.Psbt=e}).call(this)}).call(this,t("buffer").Buffer)},{"./combiner":12,"./parser":37,"./typeFields":40,"./utils":41,buffer:75}],40:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var n;(function(e){e[e["UNSIGNED_TX"]=0]="UNSIGNED_TX";e[e["GLOBAL_XPUB"]=1]="GLOBAL_XPUB"})(n=r.GlobalTypes||(r.GlobalTypes={}));r.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"];var i;(function(e){e[e["NON_WITNESS_UTXO"]=0]="NON_WITNESS_UTXO";e[e["WITNESS_UTXO"]=1]="WITNESS_UTXO";e[e["PARTIAL_SIG"]=2]="PARTIAL_SIG";e[e["SIGHASH_TYPE"]=3]="SIGHASH_TYPE";e[e["REDEEM_SCRIPT"]=4]="REDEEM_SCRIPT";e[e["WITNESS_SCRIPT"]=5]="WITNESS_SCRIPT";e[e["BIP32_DERIVATION"]=6]="BIP32_DERIVATION";e[e["FINAL_SCRIPTSIG"]=7]="FINAL_SCRIPTSIG";e[e["FINAL_SCRIPTWITNESS"]=8]="FINAL_SCRIPTWITNESS";e[e["POR_COMMITMENT"]=9]="POR_COMMITMENT";e[e["TAP_KEY_SIG"]=19]="TAP_KEY_SIG";e[e["TAP_SCRIPT_SIG"]=20]="TAP_SCRIPT_SIG";e[e["TAP_LEAF_SCRIPT"]=21]="TAP_LEAF_SCRIPT";e[e["TAP_BIP32_DERIVATION"]=22]="TAP_BIP32_DERIVATION";e[e["TAP_INTERNAL_KEY"]=23]="TAP_INTERNAL_KEY";e[e["TAP_MERKLE_ROOT"]=24]="TAP_MERKLE_ROOT"})(i=r.InputTypes||(r.InputTypes={}));r.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment","tapKeySig","tapScriptSig","tapLeafScript","tapBip32Derivation","tapInternalKey","tapMerkleRoot"];var o;(function(e){e[e["REDEEM_SCRIPT"]=0]="REDEEM_SCRIPT";e[e["WITNESS_SCRIPT"]=1]="WITNESS_SCRIPT";e[e["BIP32_DERIVATION"]=2]="BIP32_DERIVATION";e[e["TAP_INTERNAL_KEY"]=5]="TAP_INTERNAL_KEY";e[e["TAP_TREE"]=6]="TAP_TREE";e[e["TAP_BIP32_DERIVATION"]=7]="TAP_BIP32_DERIVATION"})(o=r.OutputTypes||(r.OutputTypes={}));r.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation","tapInternalKey","tapTree","tapBip32Derivation"]},{}],41:[function(p,e,d){(function(c){(function(){"use strict";Object.defineProperty(d,"__esModule",{value:true});const h=p("./converter");function i(e,t){const r=e[t];if(r===undefined)throw new Error(`No input #${t}`);return r}d.checkForInput=i;function o(e,t){const r=e[t];if(r===undefined)throw new Error(`No output #${t}`);return r}d.checkForOutput=o;function e(t,e,r){if(t.key[0]<r){throw new Error(`Use the method for your specific key instead of addUnknownKeyVal*`)}if(e&&e.filter(e=>e.key.equals(t.key)).length!==0){throw new Error(`Duplicate Key: ${t.key.toString("hex")}`)}}d.checkHasKey=e;function t(e){let t=0;Object.keys(e).forEach(e=>{if(Number(isNaN(Number(e)))){t++}});return t}d.getEnumLength=t;function r(e,t){let r=false;if(t.nonWitnessUtxo||t.witnessUtxo){const n=!!t.redeemScript;const i=!!t.witnessScript;const o=!n||!!t.finalScriptSig;const s=!i||!!t.finalScriptWitness;const u=!!t.finalScriptSig||!!t.finalScriptWitness;r=o&&s&&u}if(r===false){throw new Error(`Input #${e} has too much or too little data to clean`)}}d.inputCheckUncleanFinalized=r;function l(e,t,r,n){throw new Error(`Data for ${e} key ${t} is incorrect: Expected `+`${r} and got ${JSON.stringify(n)}`)}function n(p){return(e,t)=>{for(const r of Object.keys(e)){const n=e[r];const{canAdd:i,canAddToArray:o,check:s,expected:u}=h[p+"s"][r]||{};const f=!!o;if(s){if(f){if(!Array.isArray(n)||t[r]&&!Array.isArray(t[r])){throw new Error(`Key type ${r} must be an array`)}if(!n.every(s)){l(p,r,u,n)}const a=t[r]||[];const c=new Set;if(!n.every(e=>o(a,e,c))){throw new Error("Can not add duplicate data to array")}t[r]=a.concat(n)}else{if(!s(n)){l(p,r,u,n)}if(!i(t,n)){throw new Error(`Can not add duplicate data to ${p}`)}t[r]=n}}}}}d.updateGlobal=n("global");d.updateInput=n("input");d.updateOutput=n("output");function s(e,t){const r=e.length-1;const n=i(e,r);d.updateInput(t,n)}d.addInputAttributes=s;function u(e,t){const r=e.length-1;const n=o(e,r);d.updateOutput(t,n)}d.addOutputAttributes=u;function f(e,t){if(!c.isBuffer(t)||t.length<4){throw new Error("Set Version: Invalid Transaction")}t.writeUInt32LE(e,0);return t}d.defaultVersionSetter=f;function a(e,t){if(!c.isBuffer(t)||t.length<4){throw new Error("Set Locktime: Invalid Transaction")}t.writeUInt32LE(e,t.length-4);return t}d.defaultLocktimeSetter=a}).call(this)}).call(this,{isBuffer:p("../../../is-buffer/index.js")})},{"../../../is-buffer/index.js":77,"./converter":15}],42:[function(E,e,S){(function(m){(function(){"use strict";Object.defineProperty(S,"__esModule",{value:true});S.toOutputScript=S.fromOutputScript=S.toBech32=S.toBase58Check=S.fromBech32=S.fromBase58Check=void 0;const i=E("./networks");const o=E("./payments");const s=E("./script");const n=E("./types");const u=E("bech32");const f=E("bs58check");const a=40;const c=2;const p=16;const h=2;const l=80;const d="WARNING: Sending to a future segwit version address can lead to loss of funds. "+"End users MUST be warned carefully in the GUI and asked if they wish to proceed "+"with caution. Wallets should verify the segwit version from the output of fromBech32, "+"then decide when it is safe to use which version of segwit.";function r(e,t){const r=e.slice(2);if(r.length<c||r.length>a)throw new TypeError("Invalid program length for segwit address");const n=e[0]-l;if(n<h||n>p)throw new TypeError("Invalid version for segwit address");if(e[1]!==r.length)throw new TypeError("Invalid script for segwit address");console.warn(d);return g(r,n,t.bech32)}function y(e){const t=m.from(f.decode(e));if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");const r=t.readUInt8(0);const n=t.slice(1);return{version:r,hash:n}}S.fromBase58Check=y;function w(e){let t;let r;try{t=u.bech32.decode(e)}catch(e){}if(t){r=t.words[0];if(r!==0)throw new TypeError(e+" uses wrong encoding")}else{t=u.bech32m.decode(e);r=t.words[0];if(r===0)throw new TypeError(e+" uses wrong encoding")}const n=u.bech32.fromWords(t.words.slice(1));return{version:r,prefix:t.prefix,data:m.from(n)}}S.fromBech32=w;function e(e,t){(0,n.typeforce)((0,n.tuple)(n.Hash160bit,n.UInt8),arguments);const r=m.allocUnsafe(21);r.writeUInt8(t,0);e.copy(r,1);return f.encode(r)}S.toBase58Check=e;function g(e,t,r){const n=u.bech32.toWords(e);n.unshift(t);return t===0?u.bech32.encode(r,n):u.bech32m.encode(r,n)}S.toBech32=g;function t(e,t){t=t||i.bitcoin;try{return o.p2pkh({output:e,network:t}).address}catch(e){}try{return o.p2sh({output:e,network:t}).address}catch(e){}try{return o.p2wpkh({output:e,network:t}).address}catch(e){}try{return o.p2wsh({output:e,network:t}).address}catch(e){}try{return o.p2tr({output:e,network:t}).address}catch(e){}try{return r(e,t)}catch(e){}throw new Error(s.toASM(e)+" has no matching Address")}S.fromOutputScript=t;function b(e,t){t=t||i.bitcoin;let r;let n;try{r=y(e)}catch(e){}if(r){if(r.version===t.pubKeyHash)return o.p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return o.p2sh({hash:r.hash}).output}else{try{n=w(e)}catch(e){}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0){if(n.data.length===20)return o.p2wpkh({hash:n.data}).output;if(n.data.length===32)return o.p2wsh({hash:n.data}).output}else if(n.version===1){if(n.data.length===32)return o.p2tr({pubkey:n.data}).output}else if(n.version>=h&&n.version<=p&&n.data.length>=c&&n.data.length<=a){console.warn(d);return s.compile([n.version+l,n.data])}}}throw new Error(e+" has no matching Script")}S.toOutputScript=b}).call(this)}).call(this,E("buffer").Buffer)},{"./networks":50,"./payments":54,"./script":67,"./types":71,bech32:11,bs58check:74,buffer:75}],43:[function(e,t,n){(function(o){(function(){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.encode=n.decode=n.check=void 0;function e(e){if(e.length<8)return false;if(e.length>72)return false;if(e[0]!==48)return false;if(e[1]!==e.length-2)return false;if(e[2]!==2)return false;const t=e[3];if(t===0)return false;if(5+t>=e.length)return false;if(e[4+t]!==2)return false;const r=e[5+t];if(r===0)return false;if(6+t+r!==e.length)return false;if(e[4]&128)return false;if(t>1&&e[4]===0&&!(e[5]&128))return false;if(e[t+6]&128)return false;if(r>1&&e[t+6]===0&&!(e[t+7]&128))return false;return true}n.check=e;function t(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(e[0]!==48)throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(e[2]!==2)throw new Error("Expected DER integer");const t=e[3];if(t===0)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(e[4+t]!==2)throw new Error("Expected DER integer (2)");const r=e[5+t];if(r===0)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(e[4]&128)throw new Error("R value is negative");if(t>1&&e[4]===0&&!(e[5]&128))throw new Error("R value excessively padded");if(e[t+6]&128)throw new Error("S value is negative");if(r>1&&e[t+6]===0&&!(e[t+7]&128))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}}n.decode=t;function r(e,t){const r=e.length;const n=t.length;if(r===0)throw new Error("R length is zero");if(n===0)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(n>33)throw new Error("S length is too long");if(e[0]&128)throw new Error("R value is negative");if(t[0]&128)throw new Error("S value is negative");if(r>1&&e[0]===0&&!(e[1]&128))throw new Error("R value excessively padded");if(n>1&&t[0]===0&&!(t[1]&128))throw new Error("S value excessively padded");const i=o.allocUnsafe(6+r+n);i[0]=48;i[1]=i.length-2;i[2]=2;i[3]=e.length;e.copy(i,4);i[4+r]=2;i[5+r]=t.length;t.copy(i,6+r);return i}n.encode=r}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],44:[function(t,e,r){(function(d){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.Block=void 0;const u=t("./bufferutils");const i=t("./crypto");const o=t("./merkle");const f=t("./transaction");const s=t("./types");const{typeforce:a}=s;const c=new TypeError("Cannot compute merkle root for zero transactions");const p=new TypeError("Cannot compute witness commit for non-segwit block");class h{constructor(){this.version=1;this.prevHash=undefined;this.merkleRoot=undefined;this.timestamp=0;this.witnessCommit=undefined;this.bits=0;this.nonce=0;this.transactions=undefined}static fromBuffer(e){if(e.length<80)throw new Error("Buffer too small (< 80 bytes)");const t=new u.BufferReader(e);const r=new h;r.version=t.readInt32();r.prevHash=t.readSlice(32);r.merkleRoot=t.readSlice(32);r.timestamp=t.readUInt32();r.bits=t.readUInt32();r.nonce=t.readUInt32();if(e.length===80)return r;const n=()=>{const e=f.Transaction.fromBuffer(t.buffer.slice(t.offset),true);t.offset+=e.byteLength();return e};const i=t.readVarInt();r.transactions=[];for(let e=0;e<i;++e){const s=n();r.transactions.push(s)}const o=r.getWitnessCommit();if(o)r.witnessCommit=o;return r}static fromHex(e){return h.fromBuffer(d.from(e,"hex"))}static calculateTarget(e){const t=((e&4278190080)>>24)-3;const r=e&8388607;const n=d.alloc(32,0);n.writeUIntBE(r,29-t,3);return n}static calculateMerkleRoot(e,t){a([{getHash:s.Function}],e);if(e.length===0)throw c;if(t&&!l(e))throw p;const r=e.map(e=>e.getHash(t));const n=(0,o.fastMerkleRoot)(r,i.hash256);return t?i.hash256(d.concat([n,e[0].ins[0].witness[0]])):n}getWitnessCommit(){if(!l(this.transactions))return null;const e=this.transactions[0].outs.filter(e=>e.script.slice(0,6).equals(d.from("6a24aa21a9ed","hex"))).map(e=>e.script.slice(6,38));if(e.length===0)return null;const t=e[e.length-1];if(!(t instanceof d&&t.length===32))return null;return t}hasWitnessCommit(){if(this.witnessCommit instanceof d&&this.witnessCommit.length===32)return true;if(this.getWitnessCommit()!==null)return true;return false}hasWitness(){return e(this.transactions)}weight(){const e=this.byteLength(false,false);const t=this.byteLength(false,true);return e*3+t}byteLength(e,r=true){if(e||!this.transactions)return 80;return 80+u.varuint.encodingLength(this.transactions.length)+this.transactions.reduce((e,t)=>e+t.byteLength(r),0)}getHash(){return i.hash256(this.toBuffer(true))}getId(){return(0,u.reverseBuffer)(this.getHash()).toString("hex")}getUTCDate(){const e=new Date(0);e.setUTCSeconds(this.timestamp);return e}toBuffer(e){const r=d.allocUnsafe(this.byteLength(e));const n=new u.BufferWriter(r);n.writeInt32(this.version);n.writeSlice(this.prevHash);n.writeSlice(this.merkleRoot);n.writeUInt32(this.timestamp);n.writeUInt32(this.bits);n.writeUInt32(this.nonce);if(e||!this.transactions)return r;u.varuint.encode(this.transactions.length,r,n.offset);n.offset+=u.varuint.encode.bytes;this.transactions.forEach(e=>{const t=e.byteLength();e.toBuffer(r,n.offset);n.offset+=t});return r}toHex(e){return this.toBuffer(e).toString("hex")}checkTxRoots(){const e=this.hasWitnessCommit();if(!e&&this.hasWitness())return false;return this.__checkMerkleRoot()&&(e?this.__checkWitnessCommit():true)}checkProofOfWork(){const e=(0,u.reverseBuffer)(this.getHash());const t=h.calculateTarget(this.bits);return e.compare(t)<=0}__checkMerkleRoot(){if(!this.transactions)throw c;const e=h.calculateMerkleRoot(this.transactions);return this.merkleRoot.compare(e)===0}__checkWitnessCommit(){if(!this.transactions)throw c;if(!this.hasWitnessCommit())throw p;const e=h.calculateMerkleRoot(this.transactions,true);return this.witnessCommit.compare(e)===0}}r.Block=h;function l(e){return e instanceof Array&&e[0]&&e[0].ins&&e[0].ins instanceof Array&&e[0].ins[0]&&e[0].ins[0].witness&&e[0].ins[0].witness instanceof Array&&e[0].ins[0].witness.length>0}function e(e){return e instanceof Array&&e.some(e=>typeof e==="object"&&e.ins instanceof Array&&e.ins.some(e=>typeof e==="object"&&e.witness instanceof Array&&e.witness.length>0))}}).call(this)}).call(this,t("buffer").Buffer)},{"./bufferutils":45,"./crypto":46,"./merkle":49,"./transaction":70,"./types":71,buffer:75}],45:[function(p,e,h){(function(c){(function(){"use strict";Object.defineProperty(h,"__esModule",{value:true});h.BufferReader=h.BufferWriter=h.cloneBuffer=h.reverseBuffer=h.writeUInt64LE=h.readUInt64LE=h.varuint=void 0;const r=p("./types");const{typeforce:n}=r;const t=p("varuint-bitcoin");h.varuint=t;function i(e,t){if(typeof e!=="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function o(e,t){const r=e.readUInt32LE(t);let n=e.readUInt32LE(t+4);n*=4294967296;i(n+r,9007199254740991);return n+r}h.readUInt64LE=o;function s(e,t,r){i(t,9007199254740991);e.writeInt32LE(t&-1,r);e.writeUInt32LE(Math.floor(t/4294967296),r+4);return r+8}h.writeUInt64LE=s;function e(t){if(t.length<1)return t;let r=t.length-1;let n=0;for(let e=0;e<t.length/2;e++){n=t[e];t[e]=t[r];t[r]=n;r--}return t}h.reverseBuffer=e;function u(e){const t=c.allocUnsafe(e.length);e.copy(t);return t}h.cloneBuffer=u;class f{static withCapacity(e){return new f(c.alloc(e))}constructor(e,t=0){this.buffer=e;this.offset=t;n(r.tuple(r.Buffer,r.UInt32),[e,t])}writeUInt8(e){this.offset=this.buffer.writeUInt8(e,this.offset)}writeInt32(e){this.offset=this.buffer.writeInt32LE(e,this.offset)}writeUInt32(e){this.offset=this.buffer.writeUInt32LE(e,this.offset)}writeUInt64(e){this.offset=s(this.buffer,e,this.offset)}writeVarInt(e){t.encode(e,this.buffer,this.offset);this.offset+=t.encode.bytes}writeSlice(e){if(this.buffer.length<this.offset+e.length){throw new Error("Cannot write slice out of bounds")}this.offset+=e.copy(this.buffer,this.offset)}writeVarSlice(e){this.writeVarInt(e.length);this.writeSlice(e)}writeVector(e){this.writeVarInt(e.length);e.forEach(e=>this.writeVarSlice(e))}end(){if(this.buffer.length===this.offset){return this.buffer}throw new Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}}h.BufferWriter=f;class a{constructor(e,t=0){this.buffer=e;this.offset=t;n(r.tuple(r.Buffer,r.UInt32),[e,t])}readUInt8(){const e=this.buffer.readUInt8(this.offset);this.offset++;return e}readInt32(){const e=this.buffer.readInt32LE(this.offset);this.offset+=4;return e}readUInt32(){const e=this.buffer.readUInt32LE(this.offset);this.offset+=4;return e}readUInt64(){const e=o(this.buffer,this.offset);this.offset+=8;return e}readVarInt(){const e=t.decode(this.buffer,this.offset);this.offset+=t.decode.bytes;return e}readSlice(e){if(this.buffer.length<this.offset+e){throw new Error("Cannot read slice out of bounds")}const t=this.buffer.slice(this.offset,this.offset+e);this.offset+=e;return t}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){const t=this.readVarInt();const r=[];for(let e=0;e<t;e++)r.push(this.readVarSlice());return r}}h.BufferReader=a}).call(this)}).call(this,p("buffer").Buffer)},{"./types":71,buffer:75,"varuint-bitcoin":83}],46:[function(c,e,p){(function(a){(function(){"use strict";Object.defineProperty(p,"__esModule",{value:true});p.taggedHash=p.TAGGED_HASH_PREFIXES=p.TAGS=p.hash256=p.hash160=p.sha256=p.sha1=p.ripemd160=void 0;const t=c("@noble/hashes/ripemd160");const r=c("@noble/hashes/sha1");const n=c("@noble/hashes/sha256");function e(e){return a.from((0,t.ripemd160)(Uint8Array.from(e)))}p.ripemd160=e;function i(e){return a.from((0,r.sha1)(Uint8Array.from(e)))}p.sha1=i;function o(e){return a.from((0,n.sha256)(Uint8Array.from(e)))}p.sha256=o;function s(e){return a.from((0,t.ripemd160)((0,n.sha256)(Uint8Array.from(e))))}p.hash160=s;function u(e){return a.from((0,n.sha256)((0,n.sha256)(Uint8Array.from(e))))}p.hash256=u;p.TAGS=["BIP0340/challenge","BIP0340/aux","BIP0340/nonce","TapLeaf","TapBranch","TapSighash","TapTweak","KeyAgg list","KeyAgg coefficient"];p.TAGGED_HASH_PREFIXES={"BIP0340/challenge":a.from([123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124,123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124]),"BIP0340/aux":a.from([241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144,241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144]),"BIP0340/nonce":a.from([7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47,7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47]),TapLeaf:a.from([174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238,174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238]),TapBranch:a.from([25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21,25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21]),TapSighash:a.from([244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49,244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49]),TapTweak:a.from([232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233,232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233]),"KeyAgg list":a.from([72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240,72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240]),"KeyAgg coefficient":a.from([191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129,191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129])};function f(e,t){return o(a.concat([p.TAGGED_HASH_PREFIXES[e],t]))}p.taggedHash=f}).call(this)}).call(this,c("buffer").Buffer)},{"@noble/hashes/ripemd160":5,"@noble/hashes/sha1":6,"@noble/hashes/sha256":7,buffer:75}],47:[function(e,t,f){(function(u){(function(){"use strict";Object.defineProperty(f,"__esModule",{value:true});f.getEccLib=f.initEccLib=void 0;const r={};function e(e,t){if(!e){r.eccLib=e}else if(e!==r.eccLib){if(!t?.DANGER_DO_NOT_VERIFY_ECCLIB)i(e);r.eccLib=e}}f.initEccLib=e;function t(){if(!r.eccLib)throw new Error("No ECC Library provided. You must call initEccLib() with a valid TinySecp256k1Interface instance");return r.eccLib}f.getEccLib=t;const n=e=>u.from(e,"hex");function i(r){o(typeof r.isXOnlyPoint==="function");o(r.isXOnlyPoint(n("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798")));o(r.isXOnlyPoint(n("fffffffffffffffffffffffffffffffffffffffffffffffffffffffeeffffc2e")));o(r.isXOnlyPoint(n("f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9")));o(r.isXOnlyPoint(n("0000000000000000000000000000000000000000000000000000000000000001")));o(!r.isXOnlyPoint(n("0000000000000000000000000000000000000000000000000000000000000000")));o(!r.isXOnlyPoint(n("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f")));o(typeof r.xOnlyPointAddTweak==="function");s.forEach(e=>{const t=r.xOnlyPointAddTweak(n(e.pubkey),n(e.tweak));if(e.result===null){o(t===null)}else{o(t!==null);o(t.parity===e.parity);o(u.from(t.xOnlyPubkey).equals(n(e.result)))}})}function o(e){if(!e)throw new Error("ecc library invalid")}const s=[{pubkey:"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",tweak:"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140",parity:-1,result:null},{pubkey:"1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b",tweak:"a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac",parity:1,result:"e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"},{pubkey:"2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991",tweak:"823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47",parity:0,result:"9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"}]}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],48:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.initEccLib=r.Transaction=r.opcodes=r.Psbt=r.Block=r.script=r.payments=r.networks=r.crypto=r.address=void 0;const n=e("./address");r.address=n;const i=e("./crypto");r.crypto=i;const o=e("./networks");r.networks=o;const s=e("./payments");r.payments=s;const u=e("./script");r.script=u;var f=e("./block");Object.defineProperty(r,"Block",{enumerable:true,get:function(){return f.Block}});var a=e("./psbt");Object.defineProperty(r,"Psbt",{enumerable:true,get:function(){return a.Psbt}});var c=e("./ops");Object.defineProperty(r,"opcodes",{enumerable:true,get:function(){return c.OPS}});var p=e("./transaction");Object.defineProperty(r,"Transaction",{enumerable:true,get:function(){return p.Transaction}});var h=e("./ecc_lib");Object.defineProperty(r,"initEccLib",{enumerable:true,get:function(){return h.initEccLib}})},{"./address":42,"./block":44,"./crypto":46,"./ecc_lib":47,"./networks":50,"./ops":51,"./payments":54,"./psbt":63,"./script":67,"./transaction":70}],49:[function(e,t,r){(function(f){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.fastMerkleRoot=void 0;function e(e,r){if(!Array.isArray(e))throw TypeError("Expected values Array");if(typeof r!=="function")throw TypeError("Expected digest Function");let n=e.length;const i=e.concat();while(n>1){let t=0;for(let e=0;e<n;e+=2,++t){const o=i[e];const s=e+1===n?o:i[e+1];const u=f.concat([o,s]);i[t]=r(u)}n=t}return i[0]}r.fastMerkleRoot=e}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],50:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.testnet=r.regtest=r.bitcoin=void 0;r.bitcoin={messagePrefix:"Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};r.regtest={messagePrefix:"Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239};r.testnet={messagePrefix:"Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},{}],51:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.REVERSE_OPS=r.OPS=void 0;const n={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP3:178,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};r.OPS=n;const i={};r.REVERSE_OPS=i;for(const o of Object.keys(n)){const s=n[o];i[s]=o}},{}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.tweakKey=r.tapTweakHash=r.tapleafHash=r.findScriptPath=r.toHashTree=r.rootHashFromPath=r.MAX_TAPTREE_DEPTH=r.LEAF_VERSION_TAPSCRIPT=void 0;const i=e("buffer");const o=e("../ecc_lib");const n=e("../crypto");const s=e("../bufferutils");const u=e("../types");r.LEAF_VERSION_TAPSCRIPT=192;r.MAX_TAPTREE_DEPTH=128;const f=e=>"left"in e&&"right"in e;function a(t,e){if(t.length<33)throw new TypeError(`The control-block length is too small. Got ${t.length}, expected min 33.`);const r=(t.length-33)/32;let n=e;for(let e=0;e<r;e++){const i=t.slice(33+32*e,65+32*e);if(n.compare(i)<0){n=y(n,i)}else{n=y(i,n)}}return n}r.rootHashFromPath=a;function c(e){if((0,u.isTapleaf)(e))return{hash:h(e)};const t=[c(e[0]),c(e[1])];t.sort((e,t)=>e.hash.compare(t.hash));const[r,n]=t;return{hash:y(r.hash,n.hash),left:r,right:n}}r.toHashTree=c;function p(e,t){if(f(e)){const r=p(e.left,t);if(r!==undefined)return[...r,e.right.hash];const n=p(e.right,t);if(n!==undefined)return[...n,e.left.hash]}else if(e.hash.equals(t)){return[]}return undefined}r.findScriptPath=p;function h(e){const t=e.version||r.LEAF_VERSION_TAPSCRIPT;return n.taggedHash("TapLeaf",i.Buffer.concat([i.Buffer.from([t]),w(e.output)]))}r.tapleafHash=h;function l(e,t){return n.taggedHash("TapTweak",i.Buffer.concat(t?[e,t]:[e]))}r.tapTweakHash=l;function d(e,t){if(!i.Buffer.isBuffer(e))return null;if(e.length!==32)return null;if(t&&t.length!==32)return null;const r=l(e,t);const n=(0,o.getEccLib)().xOnlyPointAddTweak(e,r);if(!n||n.xOnlyPubkey===null)return null;return{parity:n.parity,x:i.Buffer.from(n.xOnlyPubkey)}}r.tweakKey=d;function y(e,t){return n.taggedHash("TapBranch",i.Buffer.concat([e,t]))}function w(e){const t=s.varuint.encodingLength(e.length);const r=i.Buffer.allocUnsafe(t);s.varuint.encode(e.length,r);return i.Buffer.concat([r,e])}},{"../bufferutils":45,"../crypto":46,"../ecc_lib":47,"../types":71,buffer:75}],53:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.p2data=void 0;const o=e("../networks");const s=e("../script");const u=e("../types");const f=e("./lazy");const a=s.OPS;function n(e,t){if(!e.data&&!e.output)throw new TypeError("Not enough data");t=Object.assign({validate:true},t||{});(0,u.typeforce)({network:u.typeforce.maybe(u.typeforce.Object),output:u.typeforce.maybe(u.typeforce.Buffer),data:u.typeforce.maybe(u.typeforce.arrayOf(u.typeforce.Buffer))},e);const r=e.network||o.bitcoin;const n={name:"embed",network:r};f.prop(n,"output",()=>{if(!e.data)return;return s.compile([a.OP_RETURN].concat(e.data))});f.prop(n,"data",()=>{if(!e.output)return;return s.decompile(e.output).slice(1)});if(t.validate){if(e.output){const i=s.decompile(e.output);if(i[0]!==a.OP_RETURN)throw new TypeError("Output is invalid");if(!i.slice(1).every(u.typeforce.Buffer))throw new TypeError("Output is invalid");if(e.data&&!(0,u.stacksEqual)(e.data,n.data))throw new TypeError("Data mismatch")}}return Object.assign(n,e)}r.p2data=n},{"../networks":50,"../script":67,"../types":71,"./lazy":55}],54:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.p2tr=r.p2wsh=r.p2wpkh=r.p2sh=r.p2pkh=r.p2pk=r.p2ms=r.embed=void 0;const n=e("./embed");Object.defineProperty(r,"embed",{enumerable:true,get:function(){return n.p2data}});const i=e("./p2ms");Object.defineProperty(r,"p2ms",{enumerable:true,get:function(){return i.p2ms}});const o=e("./p2pk");Object.defineProperty(r,"p2pk",{enumerable:true,get:function(){return o.p2pk}});const s=e("./p2pkh");Object.defineProperty(r,"p2pkh",{enumerable:true,get:function(){return s.p2pkh}});const u=e("./p2sh");Object.defineProperty(r,"p2sh",{enumerable:true,get:function(){return u.p2sh}});const f=e("./p2wpkh");Object.defineProperty(r,"p2wpkh",{enumerable:true,get:function(){return f.p2wpkh}});const a=e("./p2wsh");Object.defineProperty(r,"p2wsh",{enumerable:true,get:function(){return a.p2wsh}});const c=e("./p2tr");Object.defineProperty(r,"p2tr",{enumerable:true,get:function(){return c.p2tr}})},{"./embed":53,"./p2ms":56,"./p2pk":57,"./p2pkh":58,"./p2sh":59,"./p2tr":60,"./p2wpkh":61,"./p2wsh":62}],55:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.value=r.prop=void 0;function n(e,t,r){Object.defineProperty(e,t,{configurable:true,enumerable:true,get(){const e=r.call(this);this[t]=e;return e},set(e){Object.defineProperty(this,t,{configurable:true,enumerable:true,value:e,writable:true})}})}r.prop=n;function i(e){let t;return()=>{if(t!==undefined)return t;t=e();return t}}r.value=i},{}],56:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.p2ms=void 0;const f=e("../networks");const a=e("../script");const c=e("../types");const p=e("./lazy");const h=a.OPS;const l=h.OP_RESERVED;function n(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&e.m!==undefined)&&!e.signatures)throw new TypeError("Not enough data");t=Object.assign({validate:true},t||{});function r(e){return a.isCanonicalScriptSignature(e)||(t.allowIncomplete&&e===h.OP_0)!==undefined}(0,c.typeforce)({network:c.typeforce.maybe(c.typeforce.Object),m:c.typeforce.maybe(c.typeforce.Number),n:c.typeforce.maybe(c.typeforce.Number),output:c.typeforce.maybe(c.typeforce.Buffer),pubkeys:c.typeforce.maybe(c.typeforce.arrayOf(c.isPoint)),signatures:c.typeforce.maybe(c.typeforce.arrayOf(r)),input:c.typeforce.maybe(c.typeforce.Buffer)},e);const n=e.network||f.bitcoin;const i={network:n};let o=[];let s=false;function u(e){if(s)return;s=true;o=a.decompile(e);i.m=o[0]-l;i.n=o[o.length-2]-l;i.pubkeys=o.slice(1,-2)}p.prop(i,"output",()=>{if(!e.m)return;if(!i.n)return;if(!e.pubkeys)return;return a.compile([].concat(l+e.m,e.pubkeys,l+i.n,h.OP_CHECKMULTISIG))});p.prop(i,"m",()=>{if(!i.output)return;u(i.output);return i.m});p.prop(i,"n",()=>{if(!i.pubkeys)return;return i.pubkeys.length});p.prop(i,"pubkeys",()=>{if(!e.output)return;u(e.output);return i.pubkeys});p.prop(i,"signatures",()=>{if(!e.input)return;return a.decompile(e.input).slice(1)});p.prop(i,"input",()=>{if(!e.signatures)return;return a.compile([h.OP_0].concat(e.signatures))});p.prop(i,"witness",()=>{if(!i.input)return;return[]});p.prop(i,"name",()=>{if(!i.m||!i.n)return;return`p2ms(${i.m} of ${i.n})`});if(t.validate){if(e.output){u(e.output);if(!c.typeforce.Number(o[0]))throw new TypeError("Output is invalid");if(!c.typeforce.Number(o[o.length-2]))throw new TypeError("Output is invalid");if(o[o.length-1]!==h.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(i.m<=0||i.n>16||i.m>i.n||i.n!==o.length-3)throw new TypeError("Output is invalid");if(!i.pubkeys.every(e=>(0,c.isPoint)(e)))throw new TypeError("Output is invalid");if(e.m!==undefined&&e.m!==i.m)throw new TypeError("m mismatch");if(e.n!==undefined&&e.n!==i.n)throw new TypeError("n mismatch");if(e.pubkeys&&!(0,c.stacksEqual)(e.pubkeys,i.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(e.n!==undefined&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");i.n=e.pubkeys.length;if(i.n<i.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<i.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>i.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==h.OP_0)throw new TypeError("Input is invalid");if(i.signatures.length===0||!i.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!(0,c.stacksEqual)(e.signatures,i.signatures))throw new TypeError("Signature mismatch");if(e.m!==undefined&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(i,e)}r.p2ms=n},{"../networks":50,"../script":67,"../types":71,"./lazy":55}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.p2pk=void 0;const o=e("../networks");const s=e("../script");const u=e("../types");const f=e("./lazy");const a=s.OPS;function n(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:true},t||{});(0,u.typeforce)({network:u.typeforce.maybe(u.typeforce.Object),output:u.typeforce.maybe(u.typeforce.Buffer),pubkey:u.typeforce.maybe(u.isPoint),signature:u.typeforce.maybe(s.isCanonicalScriptSignature),input:u.typeforce.maybe(u.typeforce.Buffer)},e);const r=f.value(()=>{return s.decompile(e.input)});const n=e.network||o.bitcoin;const i={name:"p2pk",network:n};f.prop(i,"output",()=>{if(!e.pubkey)return;return s.compile([e.pubkey,a.OP_CHECKSIG])});f.prop(i,"pubkey",()=>{if(!e.output)return;return e.output.slice(1,-1)});f.prop(i,"signature",()=>{if(!e.input)return;return r()[0]});f.prop(i,"input",()=>{if(!e.signature)return;return s.compile([e.signature])});f.prop(i,"witness",()=>{if(!i.input)return;return[]});if(t.validate){if(e.output){if(e.output[e.output.length-1]!==a.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!(0,u.isPoint)(i.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&!e.pubkey.equals(i.pubkey))throw new TypeError("Pubkey mismatch")}if(e.signature){if(e.input&&!e.input.equals(i.input))throw new TypeError("Signature mismatch")}if(e.input){if(r().length!==1)throw new TypeError("Input is invalid");if(!s.isCanonicalScriptSignature(i.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(i,e)}r.p2pk=n},{"../networks":50,"../script":67,"../types":71,"./lazy":55}],58:[function(t,e,r){(function(w){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.p2pkh=void 0;const a=t("../crypto");const c=t("../networks");const p=t("../script");const h=t("../types");const l=t("./lazy");const d=t("bs58check");const y=p.OPS;function e(n,e){if(!n.address&&!n.hash&&!n.output&&!n.pubkey&&!n.input)throw new TypeError("Not enough data");e=Object.assign({validate:true},e||{});(0,h.typeforce)({network:h.typeforce.maybe(h.typeforce.Object),address:h.typeforce.maybe(h.typeforce.String),hash:h.typeforce.maybe(h.typeforce.BufferN(20)),output:h.typeforce.maybe(h.typeforce.BufferN(25)),pubkey:h.typeforce.maybe(h.isPoint),signature:h.typeforce.maybe(p.isCanonicalScriptSignature),input:h.typeforce.maybe(h.typeforce.Buffer)},n);const t=l.value(()=>{const e=w.from(d.decode(n.address));const t=e.readUInt8(0);const r=e.slice(1);return{version:t,hash:r}});const r=l.value(()=>{return p.decompile(n.input)});const i=n.network||c.bitcoin;const o={name:"p2pkh",network:i};l.prop(o,"address",()=>{if(!o.hash)return;const e=w.allocUnsafe(21);e.writeUInt8(i.pubKeyHash,0);o.hash.copy(e,1);return d.encode(e)});l.prop(o,"hash",()=>{if(n.output)return n.output.slice(3,23);if(n.address)return t().hash;if(n.pubkey||o.pubkey)return a.hash160(n.pubkey||o.pubkey)});l.prop(o,"output",()=>{if(!o.hash)return;return p.compile([y.OP_DUP,y.OP_HASH160,o.hash,y.OP_EQUALVERIFY,y.OP_CHECKSIG])});l.prop(o,"pubkey",()=>{if(!n.input)return;return r()[1]});l.prop(o,"signature",()=>{if(!n.input)return;return r()[0]});l.prop(o,"input",()=>{if(!n.pubkey)return;if(!n.signature)return;return p.compile([n.signature,n.pubkey])});l.prop(o,"witness",()=>{if(!o.input)return;return[]});if(e.validate){let e=w.from([]);if(n.address){if(t().version!==i.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(t().hash.length!==20)throw new TypeError("Invalid address");e=t().hash}if(n.hash){if(e.length>0&&!e.equals(n.hash))throw new TypeError("Hash mismatch");else e=n.hash}if(n.output){if(n.output.length!==25||n.output[0]!==y.OP_DUP||n.output[1]!==y.OP_HASH160||n.output[2]!==20||n.output[23]!==y.OP_EQUALVERIFY||n.output[24]!==y.OP_CHECKSIG)throw new TypeError("Output is invalid");const s=n.output.slice(3,23);if(e.length>0&&!e.equals(s))throw new TypeError("Hash mismatch");else e=s}if(n.pubkey){const u=a.hash160(n.pubkey);if(e.length>0&&!e.equals(u))throw new TypeError("Hash mismatch");else e=u}if(n.input){const f=r();if(f.length!==2)throw new TypeError("Input is invalid");if(!p.isCanonicalScriptSignature(f[0]))throw new TypeError("Input has invalid signature");if(!(0,h.isPoint)(f[1]))throw new TypeError("Input has invalid pubkey");if(n.signature&&!n.signature.equals(f[0]))throw new TypeError("Signature mismatch");if(n.pubkey&&!n.pubkey.equals(f[1]))throw new TypeError("Pubkey mismatch");const u=a.hash160(f[1]);if(e.length>0&&!e.equals(u))throw new TypeError("Hash mismatch")}}return Object.assign(o,n)}r.p2pkh=e}).call(this)}).call(this,t("buffer").Buffer)},{"../crypto":46,"../networks":50,"../script":67,"../types":71,"./lazy":55,bs58check:74,buffer:75}],59:[function(t,e,r){(function(b){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.p2sh=void 0;const h=t("../crypto");const o=t("../networks");const l=t("../script");const d=t("../types");const y=t("./lazy");const w=t("bs58check");const g=l.OPS;function e(n,e){if(!n.address&&!n.hash&&!n.output&&!n.redeem&&!n.input)throw new TypeError("Not enough data");e=Object.assign({validate:true},e||{});(0,d.typeforce)({network:d.typeforce.maybe(d.typeforce.Object),address:d.typeforce.maybe(d.typeforce.String),hash:d.typeforce.maybe(d.typeforce.BufferN(20)),output:d.typeforce.maybe(d.typeforce.BufferN(23)),redeem:d.typeforce.maybe({network:d.typeforce.maybe(d.typeforce.Object),output:d.typeforce.maybe(d.typeforce.Buffer),input:d.typeforce.maybe(d.typeforce.Buffer),witness:d.typeforce.maybe(d.typeforce.arrayOf(d.typeforce.Buffer))}),input:d.typeforce.maybe(d.typeforce.Buffer),witness:d.typeforce.maybe(d.typeforce.arrayOf(d.typeforce.Buffer))},n);let r=n.network;if(!r){r=n.redeem&&n.redeem.network||o.bitcoin}const t={network:r};const i=y.value(()=>{const e=b.from(w.decode(n.address));const t=e.readUInt8(0);const r=e.slice(1);return{version:t,hash:r}});const s=y.value(()=>{return l.decompile(n.input)});const u=y.value(()=>{const e=s();const t=e[e.length-1];return{network:r,output:t===g.OP_FALSE?b.from([]):t,input:l.compile(e.slice(0,-1)),witness:n.witness||[]}});y.prop(t,"address",()=>{if(!t.hash)return;const e=b.allocUnsafe(21);e.writeUInt8(t.network.scriptHash,0);t.hash.copy(e,1);return w.encode(e)});y.prop(t,"hash",()=>{if(n.output)return n.output.slice(2,22);if(n.address)return i().hash;if(t.redeem&&t.redeem.output)return h.hash160(t.redeem.output)});y.prop(t,"output",()=>{if(!t.hash)return;return l.compile([g.OP_HASH160,t.hash,g.OP_EQUAL])});y.prop(t,"redeem",()=>{if(!n.input)return;return u()});y.prop(t,"input",()=>{if(!n.redeem||!n.redeem.input||!n.redeem.output)return;return l.compile([].concat(l.decompile(n.redeem.input),n.redeem.output))});y.prop(t,"witness",()=>{if(t.redeem&&t.redeem.witness)return t.redeem.witness;if(t.input)return[]});y.prop(t,"name",()=>{const e=["p2sh"];if(t.redeem!==undefined&&t.redeem.name!==undefined)e.push(t.redeem.name);return e.join("-")});if(e.validate){let o=b.from([]);if(n.address){if(i().version!==r.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(i().hash.length!==20)throw new TypeError("Invalid address");o=i().hash}if(n.hash){if(o.length>0&&!o.equals(n.hash))throw new TypeError("Hash mismatch");else o=n.hash}if(n.output){if(n.output.length!==23||n.output[0]!==g.OP_HASH160||n.output[1]!==20||n.output[22]!==g.OP_EQUAL)throw new TypeError("Output is invalid");const a=n.output.slice(2,22);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");else o=a}const f=t=>{if(t.output){const r=l.decompile(t.output);if(!r||r.length<1)throw new TypeError("Redeem.output too short");if(t.output.byteLength>520)throw new TypeError("Redeem.output unspendable if larger than 520 bytes");if(l.countNonPushOnlyOPs(r)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const e=h.hash160(t.output);if(o.length>0&&!o.equals(e))throw new TypeError("Hash mismatch");else o=e}if(t.input){const e=t.input.length>0;const n=t.witness&&t.witness.length>0;if(!e&&!n)throw new TypeError("Empty input");if(e&&n)throw new TypeError("Input and witness provided");if(e){const i=l.decompile(t.input);if(!l.isPushOnly(i))throw new TypeError("Non push-only scriptSig")}}};if(n.input){const c=s();if(!c||c.length<1)throw new TypeError("Input too short");if(!b.isBuffer(u().output))throw new TypeError("Input is invalid");f(u())}if(n.redeem){if(n.redeem.network&&n.redeem.network!==r)throw new TypeError("Network mismatch");if(n.input){const p=u();if(n.redeem.output&&!n.redeem.output.equals(p.output))throw new TypeError("Redeem.output mismatch");if(n.redeem.input&&!n.redeem.input.equals(p.input))throw new TypeError("Redeem.input mismatch")}f(n.redeem)}if(n.witness){if(n.redeem&&n.redeem.witness&&!(0,d.stacksEqual)(n.redeem.witness,n.witness))throw new TypeError("Witness and redeem.witness mismatch")}}return Object.assign(t,n)}r.p2sh=e}).call(this)}).call(this,t("buffer").Buffer)},{"../crypto":46,"../networks":50,"../script":67,"../types":71,"./lazy":55,bs58check:74,buffer:75}],60:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.p2tr=void 0;const b=e("buffer");const m=e("../networks");const E=e("../script");const S=e("../types");const _=e("../ecc_lib");const T=e("./bip341");const v=e("./lazy");const I=e("bech32");const k=e("../address");const O=E.OPS;const P=1;const A=80;function n(o,e){if(!o.address&&!o.output&&!o.pubkey&&!o.internalPubkey&&!(o.witness&&o.witness.length>1))throw new TypeError("Not enough data");e=Object.assign({validate:true},e||{});(0,S.typeforce)({address:S.typeforce.maybe(S.typeforce.String),input:S.typeforce.maybe(S.typeforce.BufferN(0)),network:S.typeforce.maybe(S.typeforce.Object),output:S.typeforce.maybe(S.typeforce.BufferN(34)),internalPubkey:S.typeforce.maybe(S.typeforce.BufferN(32)),hash:S.typeforce.maybe(S.typeforce.BufferN(32)),pubkey:S.typeforce.maybe(S.typeforce.BufferN(32)),signature:S.typeforce.maybe(S.typeforce.anyOf(S.typeforce.BufferN(64),S.typeforce.BufferN(65))),witness:S.typeforce.maybe(S.typeforce.arrayOf(S.typeforce.Buffer)),scriptTree:S.typeforce.maybe(S.isTaptree),redeem:S.typeforce.maybe({output:S.typeforce.maybe(S.typeforce.Buffer),redeemVersion:S.typeforce.maybe(S.typeforce.Number),witness:S.typeforce.maybe(S.typeforce.arrayOf(S.typeforce.Buffer))}),redeemVersion:S.typeforce.maybe(S.typeforce.Number)},o);const t=v.value(()=>{return(0,k.fromBech32)(o.address)});const s=v.value(()=>{if(!o.witness||!o.witness.length)return;if(o.witness.length>=2&&o.witness[o.witness.length-1][0]===A){return o.witness.slice(0,-1)}return o.witness.slice()});const u=v.value(()=>{if(o.scriptTree)return(0,T.toHashTree)(o.scriptTree);if(o.hash)return{hash:o.hash};return});const r=o.network||m.bitcoin;const f={name:"p2tr",network:r};v.prop(f,"address",()=>{if(!f.pubkey)return;const e=I.bech32m.toWords(f.pubkey);e.unshift(P);return I.bech32m.encode(r.bech32,e)});v.prop(f,"hash",()=>{const e=u();if(e)return e.hash;const t=s();if(t&&t.length>1){const r=t[t.length-1];const n=r[0]&S.TAPLEAF_VERSION_MASK;const i=t[t.length-2];const o=(0,T.tapleafHash)({output:i,version:n});return(0,T.rootHashFromPath)(r,o)}return null});v.prop(f,"output",()=>{if(!f.pubkey)return;return E.compile([O.OP_1,f.pubkey])});v.prop(f,"redeemVersion",()=>{if(o.redeemVersion)return o.redeemVersion;if(o.redeem&&o.redeem.redeemVersion!==undefined&&o.redeem.redeemVersion!==null){return o.redeem.redeemVersion}return T.LEAF_VERSION_TAPSCRIPT});v.prop(f,"redeem",()=>{const e=s();if(!e||e.length<2)return;return{output:e[e.length-2],witness:e.slice(0,-2),redeemVersion:e[e.length-1][0]&S.TAPLEAF_VERSION_MASK}});v.prop(f,"pubkey",()=>{if(o.pubkey)return o.pubkey;if(o.output)return o.output.slice(2);if(o.address)return t().data;if(f.internalPubkey){const e=(0,T.tweakKey)(f.internalPubkey,f.hash);if(e)return e.x}});v.prop(f,"internalPubkey",()=>{if(o.internalPubkey)return o.internalPubkey;const e=s();if(e&&e.length>1)return e[e.length-1].slice(1,33)});v.prop(f,"signature",()=>{if(o.signature)return o.signature;const e=s();if(!e||e.length!==1)return;return e[0]});v.prop(f,"witness",()=>{if(o.witness)return o.witness;const e=u();if(e&&o.redeem&&o.redeem.output&&o.internalPubkey){const t=(0,T.tapleafHash)({output:o.redeem.output,version:f.redeemVersion});const r=(0,T.findScriptPath)(e,t);if(!r)return;const n=(0,T.tweakKey)(o.internalPubkey,e.hash);if(!n)return;const i=b.Buffer.concat([b.Buffer.from([f.redeemVersion|n.parity]),o.internalPubkey].concat(r));return[o.redeem.output,i]}if(o.signature)return[o.signature]});if(e.validate){let e=b.Buffer.from([]);if(o.address){if(r&&r.bech32!==t().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(t().version!==P)throw new TypeError("Invalid address version");if(t().data.length!==32)throw new TypeError("Invalid address data");e=t().data}if(o.pubkey){if(e.length>0&&!e.equals(o.pubkey))throw new TypeError("Pubkey mismatch");else e=o.pubkey}if(o.output){if(o.output.length!==34||o.output[0]!==O.OP_1||o.output[1]!==32)throw new TypeError("Output is invalid");if(e.length>0&&!e.equals(o.output.slice(2)))throw new TypeError("Pubkey mismatch");else e=o.output.slice(2)}if(o.internalPubkey){const a=(0,T.tweakKey)(o.internalPubkey,f.hash);if(e.length>0&&!e.equals(a.x))throw new TypeError("Pubkey mismatch");else e=a.x}if(e&&e.length){if(!(0,_.getEccLib)().isXOnlyPoint(e))throw new TypeError("Invalid pubkey for p2tr")}const n=u();if(o.hash&&n){if(!o.hash.equals(n.hash))throw new TypeError("Hash mismatch")}if(o.redeem&&o.redeem.output&&n){const c=(0,T.tapleafHash)({output:o.redeem.output,version:f.redeemVersion});if(!(0,T.findScriptPath)(n,c))throw new TypeError("Redeem script not in tree")}const i=s();if(o.redeem&&f.redeem){if(o.redeem.redeemVersion){if(o.redeem.redeemVersion!==f.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch")}if(o.redeem.output){if(E.decompile(o.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");if(f.redeem.output&&!o.redeem.output.equals(f.redeem.output))throw new TypeError("Redeem.output and witness mismatch")}if(o.redeem.witness){if(f.redeem.witness&&!(0,S.stacksEqual)(o.redeem.witness,f.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}}if(i&&i.length){if(i.length===1){if(o.signature&&!o.signature.equals(i[0]))throw new TypeError("Signature mismatch")}else{const p=i[i.length-1];if(p.length<33)throw new TypeError(`The control-block length is too small. Got ${p.length}, expected min 33.`);if((p.length-33)%32!==0)throw new TypeError(`The control-block length of ${p.length} is incorrect!`);const h=(p.length-33)/32;if(h>128)throw new TypeError(`The script path is too long. Got ${h}, expected max 128.`);const l=p.slice(1,33);if(o.internalPubkey&&!o.internalPubkey.equals(l))throw new TypeError("Internal pubkey mismatch");if(!(0,_.getEccLib)().isXOnlyPoint(l))throw new TypeError("Invalid internalPubkey for p2tr witness");const d=p[0]&S.TAPLEAF_VERSION_MASK;const y=i[i.length-2];const c=(0,T.tapleafHash)({output:y,version:d});const w=(0,T.rootHashFromPath)(p,c);const g=(0,T.tweakKey)(l,w);if(!g)throw new TypeError("Invalid outputKey for p2tr witness");if(e.length&&!e.equals(g.x))throw new TypeError("Pubkey mismatch for p2tr witness");if(g.parity!==(p[0]&1))throw new Error("Incorrect parity")}}}return Object.assign(f,o)}r.p2tr=n},{"../address":42,"../ecc_lib":47,"../networks":50,"../script":67,"../types":71,"./bip341":52,"./lazy":55,bech32:11,buffer:75}],61:[function(t,e,r){(function(d){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.p2wpkh=void 0;const s=t("../crypto");const u=t("../networks");const f=t("../script");const a=t("../types");const c=t("./lazy");const p=t("bech32");const h=f.OPS;const l=d.alloc(0);function e(n,e){if(!n.address&&!n.hash&&!n.output&&!n.pubkey&&!n.witness)throw new TypeError("Not enough data");e=Object.assign({validate:true},e||{});(0,a.typeforce)({address:a.typeforce.maybe(a.typeforce.String),hash:a.typeforce.maybe(a.typeforce.BufferN(20)),input:a.typeforce.maybe(a.typeforce.BufferN(0)),network:a.typeforce.maybe(a.typeforce.Object),output:a.typeforce.maybe(a.typeforce.BufferN(22)),pubkey:a.typeforce.maybe(a.isPoint),signature:a.typeforce.maybe(f.isCanonicalScriptSignature),witness:a.typeforce.maybe(a.typeforce.arrayOf(a.typeforce.Buffer))},n);const t=c.value(()=>{const e=p.bech32.decode(n.address);const t=e.words.shift();const r=p.bech32.fromWords(e.words);return{version:t,prefix:e.prefix,data:d.from(r)}});const r=n.network||u.bitcoin;const i={name:"p2wpkh",network:r};c.prop(i,"address",()=>{if(!i.hash)return;const e=p.bech32.toWords(i.hash);e.unshift(0);return p.bech32.encode(r.bech32,e)});c.prop(i,"hash",()=>{if(n.output)return n.output.slice(2,22);if(n.address)return t().data;if(n.pubkey||i.pubkey)return s.hash160(n.pubkey||i.pubkey)});c.prop(i,"output",()=>{if(!i.hash)return;return f.compile([h.OP_0,i.hash])});c.prop(i,"pubkey",()=>{if(n.pubkey)return n.pubkey;if(!n.witness)return;return n.witness[1]});c.prop(i,"signature",()=>{if(!n.witness)return;return n.witness[0]});c.prop(i,"input",()=>{if(!i.witness)return;return l});c.prop(i,"witness",()=>{if(!n.pubkey)return;if(!n.signature)return;return[n.signature,n.pubkey]});if(e.validate){let e=d.from([]);if(n.address){if(r&&r.bech32!==t().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(t().version!==0)throw new TypeError("Invalid address version");if(t().data.length!==20)throw new TypeError("Invalid address data");e=t().data}if(n.hash){if(e.length>0&&!e.equals(n.hash))throw new TypeError("Hash mismatch");else e=n.hash}if(n.output){if(n.output.length!==22||n.output[0]!==h.OP_0||n.output[1]!==20)throw new TypeError("Output is invalid");if(e.length>0&&!e.equals(n.output.slice(2)))throw new TypeError("Hash mismatch");else e=n.output.slice(2)}if(n.pubkey){const o=s.hash160(n.pubkey);if(e.length>0&&!e.equals(o))throw new TypeError("Hash mismatch");else e=o;if(!(0,a.isPoint)(n.pubkey)||n.pubkey.length!==33)throw new TypeError("Invalid pubkey for p2wpkh")}if(n.witness){if(n.witness.length!==2)throw new TypeError("Witness is invalid");if(!f.isCanonicalScriptSignature(n.witness[0]))throw new TypeError("Witness has invalid signature");if(!(0,a.isPoint)(n.witness[1])||n.witness[1].length!==33)throw new TypeError("Witness has invalid pubkey");if(n.signature&&!n.signature.equals(n.witness[0]))throw new TypeError("Signature mismatch");if(n.pubkey&&!n.pubkey.equals(n.witness[1]))throw new TypeError("Pubkey mismatch");const o=s.hash160(n.witness[1]);if(e.length>0&&!e.equals(o))throw new TypeError("Hash mismatch")}}return Object.assign(i,n)}r.p2wpkh=e}).call(this)}).call(this,t("buffer").Buffer)},{"../crypto":46,"../networks":50,"../script":67,"../types":71,"./lazy":55,bech32:11,buffer:75}],62:[function(t,e,r){(function(b){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.p2wsh=void 0;const a=t("../crypto");const c=t("../networks");const p=t("../script");const h=t("../types");const l=t("./lazy");const d=t("bech32");const y=p.OPS;const w=b.alloc(0);function g(e){if(b.isBuffer(e)&&e.length===65&&e[0]===4&&(0,h.isPoint)(e)){return true}else{return false}}function e(n,e){if(!n.address&&!n.hash&&!n.output&&!n.redeem&&!n.witness)throw new TypeError("Not enough data");e=Object.assign({validate:true},e||{});(0,h.typeforce)({network:h.typeforce.maybe(h.typeforce.Object),address:h.typeforce.maybe(h.typeforce.String),hash:h.typeforce.maybe(h.typeforce.BufferN(32)),output:h.typeforce.maybe(h.typeforce.BufferN(34)),redeem:h.typeforce.maybe({input:h.typeforce.maybe(h.typeforce.Buffer),network:h.typeforce.maybe(h.typeforce.Object),output:h.typeforce.maybe(h.typeforce.Buffer),witness:h.typeforce.maybe(h.typeforce.arrayOf(h.typeforce.Buffer))}),input:h.typeforce.maybe(h.typeforce.BufferN(0)),witness:h.typeforce.maybe(h.typeforce.arrayOf(h.typeforce.Buffer))},n);const t=l.value(()=>{const e=d.bech32.decode(n.address);const t=e.words.shift();const r=d.bech32.fromWords(e.words);return{version:t,prefix:e.prefix,data:b.from(r)}});const r=l.value(()=>{return p.decompile(n.redeem.input)});let i=n.network;if(!i){i=n.redeem&&n.redeem.network||c.bitcoin}const o={network:i};l.prop(o,"address",()=>{if(!o.hash)return;const e=d.bech32.toWords(o.hash);e.unshift(0);return d.bech32.encode(i.bech32,e)});l.prop(o,"hash",()=>{if(n.output)return n.output.slice(2);if(n.address)return t().data;if(o.redeem&&o.redeem.output)return a.sha256(o.redeem.output)});l.prop(o,"output",()=>{if(!o.hash)return;return p.compile([y.OP_0,o.hash])});l.prop(o,"redeem",()=>{if(!n.witness)return;return{output:n.witness[n.witness.length-1],input:w,witness:n.witness.slice(0,-1)}});l.prop(o,"input",()=>{if(!o.witness)return;return w});l.prop(o,"witness",()=>{if(n.redeem&&n.redeem.input&&n.redeem.input.length>0&&n.redeem.output&&n.redeem.output.length>0){const e=p.toStack(r());o.redeem=Object.assign({witness:e},n.redeem);o.redeem.input=w;return[].concat(e,n.redeem.output)}if(!n.redeem)return;if(!n.redeem.output)return;if(!n.redeem.witness)return;return[].concat(n.redeem.witness,n.redeem.output)});l.prop(o,"name",()=>{const e=["p2wsh"];if(o.redeem!==undefined&&o.redeem.name!==undefined)e.push(o.redeem.name);return e.join("-")});if(e.validate){let e=b.from([]);if(n.address){if(t().prefix!==i.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(t().version!==0)throw new TypeError("Invalid address version");if(t().data.length!==32)throw new TypeError("Invalid address data");e=t().data}if(n.hash){if(e.length>0&&!e.equals(n.hash))throw new TypeError("Hash mismatch");else e=n.hash}if(n.output){if(n.output.length!==34||n.output[0]!==y.OP_0||n.output[1]!==32)throw new TypeError("Output is invalid");const s=n.output.slice(2);if(e.length>0&&!e.equals(s))throw new TypeError("Hash mismatch");else e=s}if(n.redeem){if(n.redeem.network&&n.redeem.network!==i)throw new TypeError("Network mismatch");if(n.redeem.input&&n.redeem.input.length>0&&n.redeem.witness&&n.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(n.redeem.output){const u=p.decompile(n.redeem.output);if(!u||u.length<1)throw new TypeError("Redeem.output is invalid");if(n.redeem.output.byteLength>3600)throw new TypeError("Redeem.output unspendable if larger than 3600 bytes");if(p.countNonPushOnlyOPs(u)>201)throw new TypeError("Redeem.output unspendable with more than 201 non-push ops");const s=a.sha256(n.redeem.output);if(e.length>0&&!e.equals(s))throw new TypeError("Hash mismatch");else e=s}if(n.redeem.input&&!p.isPushOnly(r()))throw new TypeError("Non push-only scriptSig");if(n.witness&&n.redeem.witness&&!(0,h.stacksEqual)(n.witness,n.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(n.redeem.input&&r().some(g)||n.redeem.output&&(p.decompile(n.redeem.output)||[]).some(g)){throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}}if(n.witness&&n.witness.length>0){const f=n.witness[n.witness.length-1];if(n.redeem&&n.redeem.output&&!n.redeem.output.equals(f))throw new TypeError("Witness and redeem.output mismatch");if(n.witness.some(g)||(p.decompile(f)||[]).some(g))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(o,n)}r.p2wsh=e}).call(this)}).call(this,t("buffer").Buffer)},{"../crypto":46,"../networks":50,"../script":67,"../types":71,"./lazy":55,bech32:11,buffer:75}],63:[function(pe,e,he){(function(ce){(function(){"use strict";Object.defineProperty(he,"__esModule",{value:true});he.Psbt=void 0;const i=pe("bip174");const s=pe("bip174/src/lib/converter/varint");const a=pe("bip174/src/lib/utils");const o=pe("./address");const n=pe("./bufferutils");const L=pe("./networks");const w=pe("./payments");const R=pe("./payments/bip341");const d=pe("./script");const g=pe("./transaction");const b=pe("./psbt/bip371");const m=pe("./psbt/psbtutils");const F={network:L.bitcoin,maximumFeeRate:5e3};class u{static fromBase64(e,t={}){const r=ce.from(e,"base64");return this.fromBuffer(r,t)}static fromHex(e,t={}){const r=ce.from(e,"hex");return this.fromBuffer(r,t)}static fromBuffer(e,t={}){const r=i.Psbt.fromBuffer(e,M);const n=new u(t,r);W(n.__CACHE.__TX,n.__CACHE);return n}constructor(e={},t=new i.Psbt(new f)){this.data=t;this.opts=Object.assign({},F,e);this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:false};if(this.data.inputs.length===0)this.setVersion(2);const r=(e,t,r,n)=>Object.defineProperty(e,t,{enumerable:r,writable:n});r(this,"__CACHE",false,true);r(this,"opts",false,true)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(e){this.setVersion(e)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(e){this.setLocktime(e)}get txInputs(){return this.__CACHE.__TX.ins.map(e=>({hash:(0,n.cloneBuffer)(e.hash),index:e.index,sequence:e.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(e=>{let t;try{t=(0,o.fromOutputScript)(e.script,this.opts.network)}catch(e){}return{script:(0,n.cloneBuffer)(e.script),value:e.value,address:t}})}combine(...e){this.data.combine(...e.map(e=>e.data));return this}clone(){const e=u.fromBuffer(this.data.toBuffer());e.opts=JSON.parse(JSON.stringify(this.opts));return e}setMaximumFeeRate(e){l(e);this.opts.maximumFeeRate=e}setVersion(e){l(e);y(this.data.inputs,"setVersion");const t=this.__CACHE;t.__TX.version=e;t.__EXTRACTED_TX=undefined;return this}setLocktime(e){l(e);y(this.data.inputs,"setLocktime");const t=this.__CACHE;t.__TX.locktime=e;t.__EXTRACTED_TX=undefined;return this}setInputSequence(e,t){l(t);y(this.data.inputs,"setInputSequence");const r=this.__CACHE;if(r.__TX.ins.length<=e){throw new Error("Input index too high")}r.__TX.ins[e].sequence=t;r.__EXTRACTED_TX=undefined;return this}addInputs(e){e.forEach(e=>this.addInput(e));return this}addInput(e){if(arguments.length>1||!e||e.hash===undefined||e.index===undefined){throw new Error(`Invalid arguments for Psbt.addInput. `+`Requires single object with at least [hash] and [index]`)}(0,b.checkTaprootInputFields)(e,e,"addInput");y(this.data.inputs,"addInput");if(e.witnessScript)C(e.witnessScript);const t=this.__CACHE;this.data.addInput(e);const r=t.__TX.ins[t.__TX.ins.length-1];S(t,r);const n=this.data.inputs.length-1;const i=this.data.inputs[n];if(i.nonWitnessUtxo){B(this.__CACHE,i,n)}t.__FEE=undefined;t.__FEE_RATE=undefined;t.__EXTRACTED_TX=undefined;return this}addOutputs(e){e.forEach(e=>this.addOutput(e));return this}addOutput(e){if(arguments.length>1||!e||e.value===undefined||e.address===undefined&&e.script===undefined){throw new Error(`Invalid arguments for Psbt.addOutput. `+`Requires single object with at least [script or address] and [value]`)}y(this.data.inputs,"addOutput");const{address:t}=e;if(typeof t==="string"){const{network:n}=this.opts;const i=(0,o.toOutputScript)(t,n);e=Object.assign({},e,{script:i})}(0,b.checkTaprootOutputFields)(e,e,"addOutput");const r=this.__CACHE;this.data.addOutput(e);r.__FEE=undefined;r.__FEE_RATE=undefined;r.__EXTRACTED_TX=undefined;return this}extractTransaction(e){if(!this.data.inputs.every(p))throw new Error("Not finalized");const t=this.__CACHE;if(!e){K(this,t,this.opts)}if(t.__EXTRACTED_TX)return t.__EXTRACTED_TX;const r=t.__TX.clone();ee(this.data.inputs,r,t,true);return r}getFeeRate(){return r("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return r("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){(0,a.checkForInput)(this.data.inputs,0);x(this.data.inputs.length).forEach(e=>this.finalizeInput(e));return this}finalizeInput(e,t){const r=(0,a.checkForInput)(this.data.inputs,e);if((0,b.isTaprootInput)(r))return this._finalizeTaprootInput(e,r,undefined,t);return this._finalizeInput(e,r,t)}finalizeTaprootInput(e,t,r=b.tapScriptFinalizer){const n=(0,a.checkForInput)(this.data.inputs,e);if((0,b.isTaprootInput)(n))return this._finalizeTaprootInput(e,n,t,r);throw new Error(`Cannot finalize input #${e}. Not Taproot.`)}_finalizeInput(e,t,r=G){const{script:n,isP2SH:i,isP2WSH:o,isSegwit:s}=Y(e,t,this.__CACHE);if(!n)throw new Error(`No script found for input #${e}`);V(t);const{finalScriptSig:u,finalScriptWitness:f}=r(e,t,n,s,i,o);if(u)this.data.updateInput(e,{finalScriptSig:u});if(f)this.data.updateInput(e,{finalScriptWitness:f});if(!u&&!f)throw new Error(`Unknown error finalizing input #${e}`);this.data.clearFinalizedInput(e);return this}_finalizeTaprootInput(e,t,r,n=b.tapScriptFinalizer){if(!t.witnessUtxo)throw new Error(`Cannot finalize input #${e}. Missing withness utxo.`);if(t.tapKeySig){const i=w.p2tr({output:t.witnessUtxo.script,signature:t.tapKeySig});const o=(0,m.witnessStackToScriptWitness)(i.witness);this.data.updateInput(e,{finalScriptWitness:o})}else{const{finalScriptWitness:o}=n(e,t,r);this.data.updateInput(e,{finalScriptWitness:o})}this.data.clearFinalizedInput(e);return this}getInputType(e){const t=(0,a.checkForInput)(this.data.inputs,e);const r=te(e,t,this.__CACHE);const n=H(r,e,"input",t.redeemScript||ie(t.finalScriptSig),t.witnessScript||oe(t.finalScriptWitness));const i=n.type==="raw"?"":n.type+"-";const o=ae(n.meaningfulScript);return i+o}inputHasPubkey(e,t){const r=(0,a.checkForInput)(this.data.inputs,e);return re(t,r,e,this.__CACHE)}inputHasHDKey(e,t){const r=(0,a.checkForInput)(this.data.inputs,e);const n=h(t);return!!r.bip32Derivation&&r.bip32Derivation.some(n)}outputHasPubkey(e,t){const r=(0,a.checkForOutput)(this.data.outputs,e);return ne(t,r,e,this.__CACHE)}outputHasHDKey(e,t){const r=(0,a.checkForOutput)(this.data.outputs,e);const n=h(t);return!!r.bip32Derivation&&r.bip32Derivation.some(n)}validateSignaturesOfAllInputs(t){(0,a.checkForInput)(this.data.inputs,0);const e=x(this.data.inputs.length).map(e=>this.validateSignaturesOfInput(e,t));return e.reduce((e,t)=>t===true&&e,true)}validateSignaturesOfInput(e,t,r){const n=this.data.inputs[e];if((0,b.isTaprootInput)(n))return this.validateSignaturesOfTaprootInput(e,t,r);return this._validateSignaturesOfInput(e,t,r)}_validateSignaturesOfInput(e,t,r){const n=this.data.inputs[e];const i=(n||{}).partialSig;if(!n||!i||i.length<1)throw new Error("No signatures to validate");if(typeof t!=="function")throw new Error("Need validator function to validate signatures");const o=r?i.filter(e=>e.pubkey.equals(r)):i;if(o.length<1)throw new Error("No signatures for this pubkey");const s=[];let u;let f;let a;for(const c of o){const p=d.signature.decode(c.signature);const{hash:h,script:l}=a!==p.hashType?I(e,Object.assign({},n,{sighashType:p.hashType}),this.__CACHE,true):{hash:u,script:f};a=p.hashType;u=h;f=l;E(c.pubkey,l,"verify");s.push(t(c.pubkey,h,p.signature))}return s.every(e=>e===true)}validateSignaturesOfTaprootInput(e,t,r){const n=this.data.inputs[e];const i=(n||{}).tapKeySig;const o=(n||{}).tapScriptSig;if(!n&&!i&&!(o&&!o.length))throw new Error("No signatures to validate");if(typeof t!=="function")throw new Error("Need validator function to validate signatures");r=r&&(0,b.toXOnly)(r);const s=r?P(e,n,this.data.inputs,r,this.__CACHE):q(e,n,this.data.inputs,this.__CACHE);if(!s.length)throw new Error("No signatures for this pubkey");const u=s.find(e=>!e.leafHash);let f=0;if(i&&u){const a=t(u.pubkey,u.hash,O(i));if(!a)return false;f++}if(o){for(const c of o){const p=s.find(e=>c.pubkey.equals(e.pubkey));if(p){const h=t(c.pubkey,p.hash,O(c.signature));if(!h)return false;f++}}}return f>0}signAllInputsHD(e,t=[g.Transaction.SIGHASH_ALL]){if(!e||!e.publicKey||!e.fingerprint){throw new Error("Need HDSigner to sign input")}const r=[];for(const n of x(this.data.inputs.length)){try{this.signInputHD(n,e,t);r.push(true)}catch(e){r.push(false)}}if(r.every(e=>e===false)){throw new Error("No inputs were signed")}return this}signAllInputsHDAsync(o,s=[g.Transaction.SIGHASH_ALL]){return new Promise((e,t)=>{if(!o||!o.publicKey||!o.fingerprint){return t(new Error("Need HDSigner to sign input"))}const r=[];const n=[];for(const i of x(this.data.inputs.length)){n.push(this.signInputHDAsync(i,o,s).then(()=>{r.push(true)},()=>{r.push(false)}))}return Promise.all(n).then(()=>{if(r.every(e=>e===false)){return t(new Error("No inputs were signed"))}e()})})}signInputHD(t,e,r=[g.Transaction.SIGHASH_ALL]){if(!e||!e.publicKey||!e.fingerprint){throw new Error("Need HDSigner to sign input")}const n=$(t,this.data.inputs,e);n.forEach(e=>this.signInput(t,e,r));return this}signInputHDAsync(i,o,s=[g.Transaction.SIGHASH_ALL]){return new Promise((e,t)=>{if(!o||!o.publicKey||!o.fingerprint){return t(new Error("Need HDSigner to sign input"))}const r=$(i,this.data.inputs,o);const n=r.map(e=>this.signInputAsync(i,e,s));return Promise.all(n).then(()=>{e()}).catch(t)})}signAllInputs(e,t){if(!e||!e.publicKey)throw new Error("Need Signer to sign input");const r=[];for(const n of x(this.data.inputs.length)){try{this.signInput(n,e,t);r.push(true)}catch(e){r.push(false)}}if(r.every(e=>e===false)){throw new Error("No inputs were signed")}return this}signAllInputsAsync(o,s){return new Promise((e,t)=>{if(!o||!o.publicKey)return t(new Error("Need Signer to sign input"));const r=[];const n=[];for(const[i]of this.data.inputs.entries()){n.push(this.signInputAsync(i,o,s).then(()=>{r.push(true)},()=>{r.push(false)}))}return Promise.all(n).then(()=>{if(r.every(e=>e===false)){return t(new Error("No inputs were signed"))}e()})})}signInput(e,t,r){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const n=(0,a.checkForInput)(this.data.inputs,e);if((0,b.isTaprootInput)(n)){return this._signTaprootInput(e,n,t,undefined,r)}return this._signInput(e,t,r)}signTaprootInput(e,t,r,n){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const i=(0,a.checkForInput)(this.data.inputs,e);if((0,b.isTaprootInput)(i))return this._signTaprootInput(e,i,t,r,n);throw new Error(`Input #${e} is not of type Taproot.`)}_signInput(e,t,r=[g.Transaction.SIGHASH_ALL]){const{hash:n,sighashType:i}=v(this.data.inputs,e,t.publicKey,this.__CACHE,r);const o=[{pubkey:t.publicKey,signature:d.signature.encode(t.sign(n),i)}];this.data.updateInput(e,{partialSig:o});return this}_signTaprootInput(e,t,r,n,i=[g.Transaction.SIGHASH_DEFAULT]){const o=this.checkTaprootHashesForSig(e,t,r,n,i);const s=o.filter(e=>!e.leafHash).map(e=>(0,b.serializeTaprootSignature)(r.signSchnorr(e.hash),t.sighashType))[0];const u=o.filter(e=>!!e.leafHash).map(e=>({pubkey:(0,b.toXOnly)(r.publicKey),signature:(0,b.serializeTaprootSignature)(r.signSchnorr(e.hash),t.sighashType),leafHash:e.leafHash}));if(s){this.data.updateInput(e,{tapKeySig:s})}if(u.length){this.data.updateInput(e,{tapScriptSig:u})}return this}signInputAsync(t,r,n){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const e=(0,a.checkForInput)(this.data.inputs,t);if((0,b.isTaprootInput)(e))return this._signTaprootInputAsync(t,e,r,undefined,n);return this._signInputAsync(t,r,n)})}signTaprootInputAsync(t,r,n,i){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");const e=(0,a.checkForInput)(this.data.inputs,t);if((0,b.isTaprootInput)(e))return this._signTaprootInputAsync(t,e,r,n,i);throw new Error(`Input #${t} is not of type Taproot.`)})}_signInputAsync(r,n,e=[g.Transaction.SIGHASH_ALL]){const{hash:t,sighashType:i}=v(this.data.inputs,r,n.publicKey,this.__CACHE,e);return Promise.resolve(n.sign(t)).then(e=>{const t=[{pubkey:n.publicKey,signature:d.signature.encode(e,i)}];this.data.updateInput(r,{partialSig:t})})}async _signTaprootInputAsync(t,n,i,e,r=[g.Transaction.SIGHASH_DEFAULT]){const o=this.checkTaprootHashesForSig(t,n,i,e,r);const s=[];const u=o.filter(e=>!e.leafHash)[0];if(u){const a=Promise.resolve(i.signSchnorr(u.hash)).then(e=>{return{tapKeySig:(0,b.serializeTaprootSignature)(e,n.sighashType)}});s.push(a)}const f=o.filter(e=>!!e.leafHash);if(f.length){const c=f.map(r=>{return Promise.resolve(i.signSchnorr(r.hash)).then(e=>{const t=[{pubkey:(0,b.toXOnly)(i.publicKey),signature:(0,b.serializeTaprootSignature)(e,n.sighashType),leafHash:r.leafHash}];return{tapScriptSig:t}})});s.push(...c)}return Promise.all(s).then(e=>{e.forEach(e=>this.data.updateInput(t,e))})}checkTaprootHashesForSig(e,t,r,n,i){if(typeof r.signSchnorr!=="function")throw new Error(`Need Schnorr Signer to sign taproot input #${e}.`);const o=P(e,t,this.data.inputs,r.publicKey,this.__CACHE,n,i);if(!o||!o.length)throw new Error(`Can not sign for input #${e} with the key ${r.publicKey.toString("hex")}`);return o}toBuffer(){e(this.__CACHE);return this.data.toBuffer()}toHex(){e(this.__CACHE);return this.data.toHex()}toBase64(){e(this.__CACHE);return this.data.toBase64()}updateGlobal(e){this.data.updateGlobal(e);return this}updateInput(e,t){if(t.witnessScript)C(t.witnessScript);(0,b.checkTaprootInputFields)(this.data.inputs[e],t,"updateInput");this.data.updateInput(e,t);if(t.nonWitnessUtxo){B(this.__CACHE,this.data.inputs[e],e)}return this}updateOutput(e,t){const r=this.data.outputs[e];(0,b.checkTaprootOutputFields)(r,t,"updateOutput");this.data.updateOutput(e,t);return this}addUnknownKeyValToGlobal(e){this.data.addUnknownKeyValToGlobal(e);return this}addUnknownKeyValToInput(e,t){this.data.addUnknownKeyValToInput(e,t);return this}addUnknownKeyValToOutput(e,t){this.data.addUnknownKeyValToOutput(e,t);return this}clearFinalizedInput(e){this.data.clearFinalizedInput(e);return this}}he.Psbt=u;const M=e=>new f(e);class f{constructor(e=ce.from([2,0,0,0,0,0,0,0,0,0])){this.tx=g.Transaction.fromBuffer(e);j(this.tx);Object.defineProperty(this,"tx",{enumerable:false,writable:true})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(e){if(e.hash===undefined||e.index===undefined||!ce.isBuffer(e.hash)&&typeof e.hash!=="string"||typeof e.index!=="number"){throw new Error("Error adding input.")}const t=typeof e.hash==="string"?(0,n.reverseBuffer)(ce.from(e.hash,"hex")):e.hash;this.tx.addInput(t,e.index,e.sequence)}addOutput(e){if(e.script===undefined||e.value===undefined||!ce.isBuffer(e.script)||typeof e.value!=="number"){throw new Error("Error adding output.")}this.tx.addOutput(e.script,e.value)}toBuffer(){return this.tx.toBuffer()}}function D(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return c(1,e.partialSig);case"multisig":const n=w.p2ms({output:t});return c(n.m,e.partialSig,n.pubkeys);default:return false}}function e(e){if(e.__UNSAFE_SIGN_NONSEGWIT!==false){throw new Error("Not BIP174 compliant, can not export")}}function c(e,r,t){if(!r)return false;let n;if(t){n=t.map(e=>{const t=se(e);return r.find(e=>e.pubkey.equals(t))}).filter(e=>!!e)}else{n=r}if(n.length>e)throw new Error("Too many signatures");return n.length===e}function p(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function h(t){return e=>{if(!e.masterFingerprint.equals(t.fingerprint))return false;if(!t.derivePath(e.path).publicKey.equals(e.pubkey))return false;return true}}function l(e){if(typeof e!=="number"||e!==Math.floor(e)||e>4294967295||e<0){throw new Error("Invalid 32 bit integer")}}function K(e,t,r){const n=t.__FEE_RATE||e.getFeeRate();const i=t.__EXTRACTED_TX.virtualSize();const o=n*i;if(n>=r.maximumFeeRate){throw new Error(`Warning: You are paying around ${(o/1e8).toFixed(8)} in `+`fees, which is ${n} satoshi per byte for a transaction `+`with a VSize of ${i} bytes (segwit counted as 0.25 byte per `+`byte). Use setMaximumFeeRate method to raise your threshold, or `+`pass true to the first arg of extractTransaction.`)}}function y(e,r){e.forEach(e=>{const t=(0,b.isTaprootInput)(e)?(0,b.checkTaprootInputForSigs)(e,r):(0,m.checkInputForSig)(e,r);if(t)throw new Error("Can not modify transaction, signatures exist.")})}function V(e){if(!e.sighashType||!e.partialSig)return;const{partialSig:t,sighashType:r}=e;t.forEach(e=>{const{hashType:t}=d.signature.decode(e.signature);if(r!==t){throw new Error("Signature sighash does not match input sighash type")}})}function E(e,t,r){if(!(0,m.pubkeyInScript)(e,t)){throw new Error(`Can not ${r} for this input with the key ${e.toString("hex")}`)}}function j(e){const t=e.ins.every(e=>e.script&&e.script.length===0&&e.witness&&e.witness.length===0);if(!t){throw new Error("Format Error: Transaction ScriptSigs are not empty")}}function W(e,t){e.ins.forEach(e=>{S(t,e)})}function S(e,t){const r=(0,n.reverseBuffer)(ce.from(t.hash)).toString("hex")+":"+t.index;if(e.__TX_IN_CACHE[r])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[r]=1}function t(o,s){return(e,t,r,n)=>{const i=o({redeem:{output:r}}).output;if(!t.equals(i)){throw new Error(`${s} for ${n} #${e} doesn't match the scriptPubKey in the prevout`)}}}const _=t(w.p2sh,"Redeem script");const T=t(w.p2wsh,"Witness script");function r(e,t,r,n){if(!r.every(p))throw new Error(`PSBT must be finalized to calculate ${t}`);if(e==="__FEE_RATE"&&n.__FEE_RATE)return n.__FEE_RATE;if(e==="__FEE"&&n.__FEE)return n.__FEE;let i;let o=true;if(n.__EXTRACTED_TX){i=n.__EXTRACTED_TX;o=false}else{i=n.__TX.clone()}ee(r,i,n,o);if(e==="__FEE_RATE")return n.__FEE_RATE;else if(e==="__FEE")return n.__FEE}function G(e,t,r,n,i,o){const s=ae(r);if(!D(t,r,s))throw new Error(`Can not finalize input #${e}`);return X(r,s,t.partialSig,n,i,o)}function X(e,t,r,n,i,o){let s;let u;const f=z(e,t,r);const a=!o?null:w.p2wsh({redeem:f});const c=!i?null:w.p2sh({redeem:a||f});if(n){if(a){u=(0,m.witnessStackToScriptWitness)(a.witness)}else{u=(0,m.witnessStackToScriptWitness)(f.witness)}if(c){s=c.input}}else{if(c){s=c.input}else{s=f.input}}return{finalScriptSig:s,finalScriptWitness:u}}function v(e,t,r,n,i){const o=(0,a.checkForInput)(e,t);const{hash:s,sighashType:u,script:f}=I(t,o,n,false,i);E(r,f,"sign");return{hash:s,sighashType:u}}function I(e,t,r,n,i){const o=r.__TX;const s=t.sighashType||g.Transaction.SIGHASH_ALL;A(s,i);let u;let f;if(t.nonWitnessUtxo){const p=U(r,t,e);const h=o.ins[e].hash;const l=p.getHash();if(!h.equals(l)){throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`)}const d=o.ins[e].index;f=p.outs[d]}else if(t.witnessUtxo){f=t.witnessUtxo}else{throw new Error("Need a Utxo input item for signing")}const{meaningfulScript:a,type:c}=H(f.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(c)>=0){u=o.hashForWitnessV0(e,a,f.value,s)}else if((0,m.isP2WPKH)(a)){const y=w.p2pkh({hash:a.slice(2)}).output;u=o.hashForWitnessV0(e,y,f.value,s)}else{if(t.nonWitnessUtxo===undefined&&r.__UNSAFE_SIGN_NONSEGWIT===false)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: `+`${a.toString("hex")}`);if(!n&&r.__UNSAFE_SIGN_NONSEGWIT!==false)console.warn("Warning: Signing non-segwit inputs without the full parent transaction "+"means there is a chance that a miner could feed you incorrect information "+"to trick you into paying large fees. This behavior is the same as Psbt's predecessor "+"(TransactionBuilder - now removed) when signing non-segwit scripts. You are not "+"able to export this Psbt with toBuffer|toBase64|toHex since it is not "+"BIP174 compliant.\n*********************\nPROCEED WITH CAUTION!\n"+"*********************");u=o.hashForSignature(e,a,s)}return{script:a,sighashType:s,hash:u}}function q(t,r,n,i){const e=[];if(r.tapInternalKey){const s=k(t,r,i);if(s){e.push(s)}}if(r.tapScriptSig){const u=r.tapScriptSig.map(e=>e.pubkey);e.push(...u)}const o=e.map(e=>P(t,r,n,e,i));return o.flat()}function k(e,t,r){const{script:n}=N(e,t,r);return(0,m.isP2TR)(n)?n.subarray(2,34):null}function O(e){return e.length===64?e:e.subarray(0,64)}function P(r,e,t,n,i,o,s){const u=i.__TX;const f=e.sighashType||g.Transaction.SIGHASH_DEFAULT;A(f,s);const a=t.map((e,t)=>N(t,e,i));const c=a.map(e=>e.script);const p=a.map(e=>e.value);const h=[];if(e.tapInternalKey&&!o){const d=k(r,e,i)||ce.from([]);if((0,b.toXOnly)(n).equals(d)){const y=u.hashForWitnessV1(r,c,p,f);h.push({pubkey:n,hash:y})}}const l=(e.tapLeafScript||[]).filter(e=>(0,m.pubkeyInScript)(n,e.script)).map(e=>{const t=(0,R.tapleafHash)({output:e.script,version:e.leafVersion});return Object.assign({hash:t},e)}).filter(e=>!o||o.equals(e.hash)).map(e=>{const t=u.hashForWitnessV1(r,c,p,f,e.hash);return{pubkey:n,hash:t,leafHash:e.hash}});return h.concat(l)}function A(e,t){if(t&&t.indexOf(e)<0){const r=Z(e);throw new Error(`Sighash type is not allowed. Retry the sign method passing the `+`sighashTypes array of whitelisted types. Sighash type: ${r}`)}}function z(e,t,r){let n;switch(t){case"multisig":const i=J(e,r);n=w.p2ms({output:e,signatures:i});break;case"pubkey":n=w.p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":n=w.p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=w.p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break}return n}function Y(e,t,r){const n=r.__TX;const i={script:null,isSegwit:false,isP2SH:false,isP2WSH:false};i.isP2SH=!!t.redeemScript;i.isP2WSH=!!t.witnessScript;if(t.witnessScript){i.script=t.witnessScript}else if(t.redeemScript){i.script=t.redeemScript}else{if(t.nonWitnessUtxo){const o=U(r,t,e);const s=n.ins[e].index;i.script=o.outs[s].script}else if(t.witnessUtxo){i.script=t.witnessUtxo.script}}if(t.witnessScript||(0,m.isP2WPKH)(i.script)){i.isSegwit=true}return i}function $(e,t,r){const n=(0,a.checkForInput)(t,e);if(!n.bip32Derivation||n.bip32Derivation.length===0){throw new Error("Need bip32Derivation to sign with HD")}const i=n.bip32Derivation.map(e=>{if(e.masterFingerprint.equals(r.fingerprint)){return e}else{return}}).filter(e=>!!e);if(i.length===0){throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint")}const o=i.map(e=>{const t=r.derivePath(e.path);if(!e.pubkey.equals(t.publicKey)){throw new Error("pubkey did not match bip32Derivation")}return t});return o}function J(e,r){const t=w.p2ms({output:e});return t.pubkeys.map(t=>{return(r.filter(e=>{return e.pubkey.equals(t)})[0]||{}).signature}).filter(e=>!!e)}function Q(t){let r=0;function e(e){r+=e;return t.slice(r-e,r)}function n(){const e=s.decode(t,r);r+=s.decode.bytes;return e}function i(){return e(n())}function o(){const t=n();const r=[];for(let e=0;e<t;e++)r.push(i());return r}return o()}function Z(e){let t=e&g.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";const r=e&31;switch(r){case g.Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case g.Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case g.Transaction.SIGHASH_NONE:t+="SIGHASH_NONE";break}return t}function B(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;const n=g.Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=n;const i=e;const o=r;delete t.nonWitnessUtxo;Object.defineProperty(t,"nonWitnessUtxo",{enumerable:true,get(){const e=i.__NON_WITNESS_UTXO_BUF_CACHE[o];const t=i.__NON_WITNESS_UTXO_TX_CACHE[o];if(e!==undefined){return e}else{const r=t.toBuffer();i.__NON_WITNESS_UTXO_BUF_CACHE[o]=r;return r}},set(e){i.__NON_WITNESS_UTXO_BUF_CACHE[o]=e}})}function ee(e,o,s,u){let f=0;e.forEach((e,t)=>{if(u&&e.finalScriptSig)o.ins[t].script=e.finalScriptSig;if(u&&e.finalScriptWitness){o.ins[t].witness=Q(e.finalScriptWitness)}if(e.witnessUtxo){f+=e.witnessUtxo.value}else if(e.nonWitnessUtxo){const r=U(s,e,t);const n=o.ins[t].index;const i=r.outs[n];f+=i.value}});const t=o.outs.reduce((e,t)=>e+t.value,0);const r=f-t;if(r<0){throw new Error("Outputs are spending more than Inputs")}const n=o.virtualSize();s.__FEE=r;s.__EXTRACTED_TX=o;s.__FEE_RATE=Math.floor(r/n)}function U(e,t,r){const n=e.__NON_WITNESS_UTXO_TX_CACHE;if(!n[r]){B(e,t,r)}return n[r]}function te(e,t,r){const{script:n}=N(e,t,r);return n}function N(e,t,r){if(t.witnessUtxo!==undefined){return{script:t.witnessUtxo.script,value:t.witnessUtxo.value}}else if(t.nonWitnessUtxo!==undefined){const n=U(r,t,e);const i=n.outs[r.__TX.ins[e].index];return{script:i.script,value:i.value}}else{throw new Error("Can't find pubkey in input without Utxo data")}}function re(e,t,r,n){const i=te(r,t,n);const{meaningfulScript:o}=H(i,r,"input",t.redeemScript,t.witnessScript);return(0,m.pubkeyInScript)(e,o)}function ne(e,t,r,n){const i=n.__TX.outs[r].script;const{meaningfulScript:o}=H(i,r,"output",t.redeemScript,t.witnessScript);return(0,m.pubkeyInScript)(e,o)}function ie(e){if(!e)return;const t=d.decompile(e);if(!t)return;const r=t[t.length-1];if(!ce.isBuffer(r)||ue(r)||fe(r))return;const n=d.decompile(r);if(!n)return;return r}function oe(e){if(!e)return;const t=Q(e);const r=t[t.length-1];if(ue(r))return;const n=d.decompile(r);if(!n)return;return r}function se(e){if(e.length===65){const t=e[64]&1;const r=e.slice(0,33);r[0]=2|t;return r}return e.slice()}function ue(e){return e.length===33&&d.isCanonicalPubKey(e)}function fe(e){return d.isCanonicalScriptSignature(e)}function H(e,t,r,n,i){const o=(0,m.isP2SHScript)(e);const s=o&&n&&(0,m.isP2WSHScript)(n);const u=(0,m.isP2WSHScript)(e);if(o&&n===undefined)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((u||s)&&i===undefined)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let f;if(s){f=i;_(t,e,n,r);T(t,n,i,r);C(f)}else if(u){f=i;T(t,e,i,r);C(f)}else if(o){f=n;_(t,e,n,r)}else{f=e}return{meaningfulScript:f,type:s?"p2sh-p2wsh":o?"p2sh":u?"p2wsh":"raw"}}function C(e){if((0,m.isP2WPKH)(e)||(0,m.isP2SHScript)(e)){throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}}function ae(e){if((0,m.isP2WPKH)(e))return"witnesspubkeyhash";if((0,m.isP2PKH)(e))return"pubkeyhash";if((0,m.isP2MS)(e))return"multisig";if((0,m.isP2PK)(e))return"pubkey";return"nonstandard"}function x(e){return[...Array(e).keys()]}}).call(this)}).call(this,pe("buffer").Buffer)},{"./address":42,"./bufferutils":45,"./networks":50,"./payments":54,"./payments/bip341":52,"./psbt/bip371":64,"./psbt/psbtutils":65,"./script":67,"./transaction":70,bip174:39,"bip174/src/lib/converter/varint":35,"bip174/src/lib/utils":41,buffer:75}],64:[function(x,e,L){(function(C){(function(){"use strict";Object.defineProperty(L,"__esModule",{value:true});L.checkTaprootInputForSigs=L.tapTreeFromList=L.tapTreeToList=L.tweakInternalPubKey=L.checkTaprootOutputFields=L.checkTaprootInputFields=L.isTaprootOutput=L.isTaprootInput=L.serializeTaprootSignature=L.tapScriptFinalizer=L.toXOnly=void 0;const o=x("../types");const t=x("../transaction");const s=x("./psbtutils");const u=x("../payments/bip341");const i=x("../payments");const n=x("./psbtutils");const e=e=>e.length===32?e:e.slice(1,33);L.toXOnly=e;function r(t,e,r){const n=U(e,t,r);try{const i=A(e,n);const o=i.concat(n.script).concat(n.controlBlock);return{finalScriptWitness:(0,s.witnessStackToScriptWitness)(o)}}catch(e){throw new Error(`Can not finalize taproot input #${t}: ${e}`)}}L.tapScriptFinalizer=r;function f(e,t){const r=t?C.from([t]):C.from([]);return C.concat([e,r])}L.serializeTaprootSignature=f;function a(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&(0,s.isP2TR)(e.witnessUtxo.script))}L.isTaprootInput=a;function c(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t&&(0,s.isP2TR)(t))}L.isTaprootOutput=c;function p(e,t,r){I(e,t,r);O(e,t,r)}L.checkTaprootInputFields=p;function h(e,t,r){k(e,t,r);l(e,t)}L.checkTaprootOutputFields=h;function l(e,t){if(!t.tapTree&&!t.tapInternalKey)return;const r=t.tapInternalKey||e.tapInternalKey;const n=t.tapTree||e.tapTree;if(r){const{script:i}=e;const o=d(r,n);if(i&&!i.equals(o))throw new Error("Error adding output. Script or address missmatch.")}}function d(e,t){const r=t&&g(t.leaves);const{output:n}=(0,i.p2tr)({internalPubkey:e,scriptTree:r});return n}function y(e,t){const r=t.tapInternalKey;const n=r&&(0,u.tweakKey)(r,t.tapMerkleRoot);if(!n)throw new Error(`Cannot tweak tap internal key for input #${e}. Public key: ${r&&r.toString("hex")}`);return n.x}L.tweakInternalPubKey=y;function w(e){if(!(0,o.isTaptree)(e))throw new Error("Cannot convert taptree to tapleaf list. Expecting a tapree structure.");return _(e)}L.tapTreeToList=w;function g(e=[]){if(e.length===1&&e[0].depth===0)return{output:e[0].script,version:e[0].leafVersion};return T(e)}L.tapTreeFromList=g;function b(e,t){const r=E(e);return r.some(e=>(0,n.signatureBlocksAction)(e,m,t))}L.checkTaprootInputForSigs=b;function m(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||t.Transaction.SIGHASH_DEFAULT}}function E(e){const t=[];if(e.tapKeySig)t.push(e.tapKeySig);if(e.tapScriptSig)t.push(...e.tapScriptSig.map(e=>e.signature));if(!t.length){const r=S(e.finalScriptWitness);if(r)t.push(r)}return t}function S(e){if(!e)return;const t=e.slice(2);if(t.length===64||t.length===65)return t}function _(e,t=[],r=0){if(r>u.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(!e)return[];if((0,o.isTapleaf)(e)){t.push({depth:r,leafVersion:e.version||u.LEAF_VERSION_TAPSCRIPT,script:e.output});return t}if(e[0])_(e[0],t,r+1);if(e[1])_(e[1],t,r+1);return t}function T(e){let t;for(const r of e){t=v(r,t);if(!t)throw new Error(`No room left to insert tapleaf in tree`)}return t}function v(e,t,r=0){if(r>u.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(e.depth===r){if(!t)return{output:e.script,version:e.leafVersion};return}if((0,o.isTapleaf)(t))return;const n=v(e,t&&t[0],r+1);if(n)return[n,t&&t[1]];const i=v(e,t&&t[1],r+1);if(i)return[t&&t[0],i]}function I(e,t,r){const n=a(e)&&H(t);const i=H(e)&&a(t);const o=e===t&&a(t)&&H(t);if(n||i||o)throw new Error(`Invalid arguments for Psbt.${r}. `+`Cannot use both taproot and non-taproot fields.`)}function k(e,t,r){const n=c(e)&&H(t);const i=H(e)&&c(t);const o=e===t&&c(t)&&H(t);if(n||i||o)throw new Error(`Invalid arguments for Psbt.${r}. `+`Cannot use both taproot and non-taproot fields.`)}function O(t,r,e){if(r.tapMerkleRoot){const n=(r.tapLeafScript||[]).every(e=>P(e,r.tapMerkleRoot));const i=(t.tapLeafScript||[]).every(e=>P(e,r.tapMerkleRoot));if(!n||!i)throw new Error(`Invalid arguments for Psbt.${e}. Tapleaf not part of taptree.`)}else if(t.tapMerkleRoot){const n=(r.tapLeafScript||[]).every(e=>P(e,t.tapMerkleRoot));if(!n)throw new Error(`Invalid arguments for Psbt.${e}. Tapleaf not part of taptree.`)}}function P(e,t){if(!t)return true;const r=(0,u.tapleafHash)({output:e.script,version:e.leafVersion});const n=(0,u.rootHashFromPath)(e.controlBlock,r);return n.equals(t)}function A(e,t){const r=(0,u.tapleafHash)({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(e=>e.leafHash.equals(r)).map(e=>B(t.script,e)).sort((e,t)=>t.positionInScript-e.positionInScript).map(e=>e.signature)}function B(e,t){return Object.assign({positionInScript:(0,s.pubkeyPositionInScript)(t.pubkey,e)},t)}function U(t,e,r){if(!t.tapScriptSig||!t.tapScriptSig.length)throw new Error(`Can not finalize taproot input #${e}. No tapleaf script signature provided.`);const n=(t.tapLeafScript||[]).sort((e,t)=>e.controlBlock.length-t.controlBlock.length).find(e=>N(e,t.tapScriptSig,r));if(!n)throw new Error(`Can not finalize taproot input #${e}. Signature for tapleaf script not found.`);return n}function N(e,t,r){const n=(0,u.tapleafHash)({output:e.script,version:e.leafVersion});const i=!r||r.equals(n);return i&&t.find(e=>e.leafHash.equals(n))!==undefined}function H(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}}).call(this)}).call(this,x("buffer").Buffer)},{"../payments":54,"../payments/bip341":52,"../transaction":70,"../types":71,"./psbtutils":65,buffer:75}],65:[function(d,e,y){(function(l){(function(){"use strict";Object.defineProperty(y,"__esModule",{value:true});y.signatureBlocksAction=y.checkInputForSig=y.pubkeyInScript=y.pubkeyPositionInScript=y.witnessStackToScriptWitness=y.isP2TR=y.isP2SHScript=y.isP2WSHScript=y.isP2WPKH=y.isP2PKH=y.isP2PK=y.isP2MS=void 0;const s=d("bip174/src/lib/converter/varint");const o=d("../script");const u=d("../transaction");const f=d("../crypto");const e=d("../payments");function t(t){return e=>{try{t({output:e});return true}catch(e){return false}}}y.isP2MS=t(e.p2ms);y.isP2PK=t(e.p2pk);y.isP2PKH=t(e.p2pkh);y.isP2WPKH=t(e.p2wpkh);y.isP2WSHScript=t(e.p2wsh);y.isP2SHScript=t(e.p2sh);y.isP2TR=t(e.p2tr);function r(e){let n=l.allocUnsafe(0);function t(e){n=l.concat([n,l.from(e)])}function r(e){const t=n.length;const r=s.encodingLength(e);n=l.concat([n,l.allocUnsafe(r)]);s.encode(e,n,t)}function i(e){r(e.length);t(e)}function o(e){r(e.length);e.forEach(i)}o(e);return n}y.witnessStackToScriptWitness=r;function n(t,e){const r=(0,f.hash160)(t);const n=t.slice(1,33);const i=o.decompile(e);if(i===null)throw new Error("Unknown script error");return i.findIndex(e=>{if(typeof e==="number")return false;return e.equals(t)||e.equals(r)||e.equals(n)})}y.pubkeyPositionInScript=n;function i(e,t){return n(e,t)!==-1}y.pubkeyInScript=i;function a(e,t){const r=p(e);return r.some(e=>c(e,o.signature.decode,t))}y.checkInputForSig=a;function c(e,t,r){const{hashType:n}=t(e);const i=[];const o=n&u.Transaction.SIGHASH_ANYONECANPAY;if(o)i.push("addInput");const s=n&31;switch(s){case u.Transaction.SIGHASH_ALL:break;case u.Transaction.SIGHASH_SINGLE:case u.Transaction.SIGHASH_NONE:i.push("addOutput");i.push("setInputSequence");break}if(i.indexOf(r)===-1){return true}return false}y.signatureBlocksAction=c;function p(e){let t=[];if((e.partialSig||[]).length===0){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=h(e)}else{t=e.partialSig}return t.map(e=>e.signature)}function h(e){const t=!e.finalScriptSig?[]:o.decompile(e.finalScriptSig)||[];const r=!e.finalScriptWitness?[]:o.decompile(e.finalScriptWitness)||[];return t.concat(r).filter(e=>{return l.isBuffer(e)&&o.isCanonicalScriptSignature(e)}).map(e=>({signature:e}))}}).call(this)}).call(this,d("buffer").Buffer)},{"../crypto":46,"../payments":54,"../script":67,"../transaction":70,"bip174/src/lib/converter/varint":35,buffer:75}],66:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.decode=r.encode=r.encodingLength=void 0;const o=e("./ops");function i(e){return e<o.OPS.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}r.encodingLength=i;function n(e,t,r){const n=i(t);if(n===1){e.writeUInt8(t,r)}else if(n===2){e.writeUInt8(o.OPS.OP_PUSHDATA1,r);e.writeUInt8(t,r+1)}else if(n===3){e.writeUInt8(o.OPS.OP_PUSHDATA2,r);e.writeUInt16LE(t,r+1)}else{e.writeUInt8(o.OPS.OP_PUSHDATA4,r);e.writeUInt32LE(t,r+1)}return n}r.encode=n;function s(e,t){const r=e.readUInt8(t);let n;let i;if(r<o.OPS.OP_PUSHDATA1){n=r;i=1}else if(r===o.OPS.OP_PUSHDATA1){if(t+2>e.length)return null;n=e.readUInt8(t+1);i=2}else if(r===o.OPS.OP_PUSHDATA2){if(t+3>e.length)return null;n=e.readUInt16LE(t+1);i=3}else{if(t+5>e.length)return null;if(r!==o.OPS.OP_PUSHDATA4)throw new Error("Unexpected opcode");n=e.readUInt32LE(t+1);i=5}return{opcode:r,number:n,size:i}}r.decode=s},{"./ops":51}],67:[function(I,e,k){(function(v){(function(){"use strict";Object.defineProperty(k,"__esModule",{value:true});k.signature=k.number=k.isCanonicalScriptSignature=k.isDefinedHashType=k.isCanonicalPubKey=k.toStack=k.fromASM=k.toASM=k.decompile=k.compile=k.countNonPushOnlyOPs=k.isPushOnly=k.OPS=void 0;const t=I("./bip66");const u=I("./ops");Object.defineProperty(k,"OPS",{enumerable:true,get:function(){return u.OPS}});const f=I("./push_data");const r=I("./script_number");const e=I("./script_signature");const a=I("./types");const{typeforce:c}=a;const n=u.OPS.OP_RESERVED;function i(e){return a.Number(e)&&(e===u.OPS.OP_0||e>=u.OPS.OP_1&&e<=u.OPS.OP_16||e===u.OPS.OP_1NEGATE)}function o(e){return a.Buffer(e)||i(e)}function s(e){return a.Array(e)&&e.every(o)}k.isPushOnly=s;function p(e){return e.length-e.filter(o).length}k.countNonPushOnlyOPs=p;function h(e){if(e.length===0)return u.OPS.OP_0;if(e.length!==1)return;if(e[0]>=1&&e[0]<=16)return n+e[0];if(e[0]===129)return u.OPS.OP_1NEGATE}function l(e){return v.isBuffer(e)}function d(e){return a.Array(e)}function y(e){return v.isBuffer(e)}function w(e){if(l(e))return e;c(a.Array,e);const t=e.reduce((e,t)=>{if(y(t)){if(t.length===1&&h(t)!==undefined){return e+1}return e+f.encodingLength(t.length)+t.length}return e+1},0);const r=v.allocUnsafe(t);let n=0;e.forEach(e=>{if(y(e)){const t=h(e);if(t!==undefined){r.writeUInt8(t,n);n+=1;return}n+=f.encode(r,e.length,n);e.copy(r,n);n+=e.length}else{r.writeUInt8(e,n);n+=1}});if(n!==r.length)throw new Error("Could not decode chunks");return r}k.compile=w;function g(e){if(d(e))return e;c(a.Buffer,e);const t=[];let r=0;while(r<e.length){const n=e[r];if(n>u.OPS.OP_0&&n<=u.OPS.OP_PUSHDATA4){const i=f.decode(e,r);if(i===null)return null;r+=i.size;if(r+i.number>e.length)return null;const o=e.slice(r,r+i.number);r+=i.number;const s=h(o);if(s!==undefined){t.push(s)}else{t.push(o)}}else{t.push(n);r+=1}}return t}k.decompile=g;function b(e){if(l(e)){e=g(e)}if(!e){throw new Error("Could not convert invalid chunks to ASM")}return e.map(e=>{if(y(e)){const t=h(e);if(t===undefined)return e.toString("hex");e=t}return u.REVERSE_OPS[e]}).join(" ")}k.toASM=b;function m(e){c(a.String,e);return w(e.split(" ").map(e=>{if(u.OPS[e]!==undefined)return u.OPS[e];c(a.Hex,e);return v.from(e,"hex")}))}k.fromASM=m;function E(e){e=g(e);c(s,e);return e.map(e=>{if(y(e))return e;if(e===u.OPS.OP_0)return v.allocUnsafe(0);return r.encode(e-n)})}k.toStack=E;function S(e){return a.isPoint(e)}k.isCanonicalPubKey=S;function _(e){const t=e&~128;return t>0&&t<4}k.isDefinedHashType=_;function T(e){if(!v.isBuffer(e))return false;if(!_(e[e.length-1]))return false;return t.check(e.slice(0,-1))}k.isCanonicalScriptSignature=T;k.number=r;k.signature=e}).call(this)}).call(this,I("buffer").Buffer)},{"./bip66":43,"./ops":51,"./push_data":66,"./script_number":68,"./script_signature":69,"./types":71,buffer:75}],68:[function(e,t,r){(function(s){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.encode=r.decode=void 0;function e(t,e,r){e=e||4;r=r===undefined?true:r;const n=t.length;if(n===0)return 0;if(n>e)throw new TypeError("Script number overflow");if(r){if((t[n-1]&127)===0){if(n<=1||(t[n-2]&128)===0)throw new Error("Non-minimally encoded script number")}}if(n===5){const o=t.readUInt32LE(0);const s=t.readUInt8(4);if(s&128)return-((s&~128)*4294967296+o);return s*4294967296+o}let i=0;for(let e=0;e<n;++e){i|=t[e]<<8*e}if(t[n-1]&128)return-(i&~(128<<8*(n-1)));return i}r.decode=e;function o(e){return e>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0}function t(e){let t=Math.abs(e);const r=o(t);const n=s.allocUnsafe(r);const i=e<0;for(let e=0;e<r;++e){n.writeUInt8(t&255,e);t>>=8}if(n[r-1]&128){n.writeUInt8(i?128:0,r-1)}else if(i){n[r-1]|=128}return n}r.encode=t}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],69:[function(n,e,i){(function(p){(function(){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.encode=i.decode=void 0;const s=n("./bip66");const u=n("./script");const o=n("./types");const{typeforce:f}=o;const r=p.alloc(1,0);function a(e){let t=0;while(e[t]===0)++t;if(t===e.length)return r;e=e.slice(t);if(e[0]&128)return p.concat([r,e],1+e.length);return e}function c(e){if(e[0]===0)e=e.slice(1);const t=p.alloc(32,0);const r=Math.max(0,32-e.length);e.copy(t,r);return t}function e(e){const t=e.readUInt8(e.length-1);if(!(0,u.isDefinedHashType)(t)){throw new Error("Invalid hashType "+t)}const r=s.decode(e.slice(0,-1));const n=c(r.r);const i=c(r.s);const o=p.concat([n,i],64);return{signature:o,hashType:t}}i.decode=e;function t(e,t){f({signature:o.BufferN(64),hashType:o.UInt8},{signature:e,hashType:t});if(!(0,u.isDefinedHashType)(t)){throw new Error("Invalid hashType "+t)}const r=p.allocUnsafe(1);r.writeUInt8(t,0);const n=a(e.slice(0,32));const i=a(e.slice(32,64));return p.concat([s.encode(n,i),r])}i.encode=t}).call(this)}).call(this,n("buffer").Buffer)},{"./bip66":43,"./script":67,"./types":71,buffer:75}],70:[function(t,e,n){(function(B){(function(){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.Transaction=void 0;const T=t("./bufferutils");const v=t("./crypto");const s=t("./script");const u=t("./script");const I=t("./types");const{typeforce:k}=I;function O(e){const t=e.length;return T.varuint.encodingLength(t)+t}function r(e){const t=e.length;return T.varuint.encodingLength(t)+e.reduce((e,t)=>{return e+O(t)},0)}const P=B.allocUnsafe(0);const a=[];const h=B.from("0000000000000000000000000000000000000000000000000000000000000000","hex");const f=B.from("0000000000000000000000000000000000000000000000000000000000000001","hex");const e=B.from("ffffffffffffffff","hex");const c={script:P,valueBuffer:e};function o(e){return e.value!==undefined}class A{constructor(){this.version=1;this.locktime=0;this.ins=[];this.outs=[]}static fromBuffer(e,t){const r=new T.BufferReader(e);const n=new A;n.version=r.readInt32();const i=r.readUInt8();const o=r.readUInt8();let s=false;if(i===A.ADVANCED_TRANSACTION_MARKER&&o===A.ADVANCED_TRANSACTION_FLAG){s=true}else{r.offset-=2}const u=r.readVarInt();for(let e=0;e<u;++e){n.ins.push({hash:r.readSlice(32),index:r.readUInt32(),script:r.readVarSlice(),sequence:r.readUInt32(),witness:a})}const f=r.readVarInt();for(let e=0;e<f;++e){n.outs.push({value:r.readUInt64(),script:r.readVarSlice()})}if(s){for(let e=0;e<u;++e){n.ins[e].witness=r.readVector()}if(!n.hasWitnesses())throw new Error("Transaction has superfluous witness data")}n.locktime=r.readUInt32();if(t)return n;if(r.offset!==e.length)throw new Error("Transaction has unexpected data");return n}static fromHex(e){return A.fromBuffer(B.from(e,"hex"),false)}static isCoinbaseHash(t){k(I.Hash256bit,t);for(let e=0;e<32;++e){if(t[e]!==0)return false}return true}isCoinbase(){return this.ins.length===1&&A.isCoinbaseHash(this.ins[0].hash)}addInput(e,t,r,n){k(I.tuple(I.Hash256bit,I.UInt32,I.maybe(I.UInt32),I.maybe(I.Buffer)),arguments);if(I.Null(r)){r=A.DEFAULT_SEQUENCE}return this.ins.push({hash:e,index:t,script:n||P,sequence:r,witness:a})-1}addOutput(e,t){k(I.tuple(I.Buffer,I.Satoshi),arguments);return this.outs.push({script:e,value:t})-1}hasWitnesses(){return this.ins.some(e=>{return e.witness.length!==0})}stripWitnesses(){this.ins.forEach(e=>{e.witness=a})}weight(){const e=this.byteLength(false);const t=this.byteLength(true);return e*3+t}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(e=true){const t=e&&this.hasWitnesses();return(t?10:8)+T.varuint.encodingLength(this.ins.length)+T.varuint.encodingLength(this.outs.length)+this.ins.reduce((e,t)=>{return e+40+O(t.script)},0)+this.outs.reduce((e,t)=>{return e+8+O(t.script)},0)+(t?this.ins.reduce((e,t)=>{return e+r(t.witness)},0):0)}clone(){const e=new A;e.version=this.version;e.locktime=this.locktime;e.ins=this.ins.map(e=>{return{hash:e.hash,index:e.index,script:e.script,sequence:e.sequence,witness:e.witness}});e.outs=this.outs.map(e=>{return{script:e.script,value:e.value}});return e}hashForSignature(r,e,t){k(I.tuple(I.UInt32,I.Buffer,I.Number),arguments);if(r>=this.ins.length)return f;const n=s.compile(s.decompile(e).filter(e=>{return e!==u.OPS.OP_CODESEPARATOR}));const i=this.clone();if((t&31)===A.SIGHASH_NONE){i.outs=[];i.ins.forEach((e,t)=>{if(t===r)return;e.sequence=0})}else if((t&31)===A.SIGHASH_SINGLE){if(r>=this.outs.length)return f;i.outs.length=r+1;for(let e=0;e<r;e++){i.outs[e]=c}i.ins.forEach((e,t)=>{if(t===r)return;e.sequence=0})}if(t&A.SIGHASH_ANYONECANPAY){i.ins=[i.ins[r]];i.ins[0].script=n}else{i.ins.forEach(e=>{e.script=P});i.ins[r].script=n}const o=B.allocUnsafe(i.byteLength(false)+4);o.writeInt32LE(t,o.length-4);i.__toBuffer(o,0,false);return v.hash256(o)}hashForWitnessV1(e,r,n,t,i,o){k(I.tuple(I.UInt32,k.arrayOf(I.Buffer),k.arrayOf(I.Satoshi),I.UInt32),arguments);if(n.length!==this.ins.length||r.length!==this.ins.length){throw new Error("Must supply prevout script and value for all inputs")}const s=t===A.SIGHASH_DEFAULT?A.SIGHASH_ALL:t&A.SIGHASH_OUTPUT_MASK;const u=t&A.SIGHASH_INPUT_MASK;const f=u===A.SIGHASH_ANYONECANPAY;const a=s===A.SIGHASH_NONE;const c=s===A.SIGHASH_SINGLE;let p=P;let h=P;let l=P;let d=P;let y=P;if(!f){let t=T.BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(e=>{t.writeSlice(e.hash);t.writeUInt32(e.index)});p=v.sha256(t.end());t=T.BufferWriter.withCapacity(8*this.ins.length);n.forEach(e=>t.writeUInt64(e));h=v.sha256(t.end());t=T.BufferWriter.withCapacity(r.map(O).reduce((e,t)=>e+t));r.forEach(e=>t.writeVarSlice(e));l=v.sha256(t.end());t=T.BufferWriter.withCapacity(4*this.ins.length);this.ins.forEach(e=>t.writeUInt32(e.sequence));d=v.sha256(t.end())}if(!(a||c)){const m=this.outs.map(e=>8+O(e.script)).reduce((e,t)=>e+t);const E=T.BufferWriter.withCapacity(m);this.outs.forEach(e=>{E.writeUInt64(e.value);E.writeVarSlice(e.script)});y=v.sha256(E.end())}else if(c&&e<this.outs.length){const S=this.outs[e];const E=T.BufferWriter.withCapacity(8+O(S.script));E.writeUInt64(S.value);E.writeVarSlice(S.script);y=v.sha256(E.end())}const w=(i?2:0)+(o?1:0);const g=174-(f?49:0)-(a?32:0)+(o?32:0)+(i?37:0);const b=T.BufferWriter.withCapacity(g);b.writeUInt8(t);b.writeInt32(this.version);b.writeUInt32(this.locktime);b.writeSlice(p);b.writeSlice(h);b.writeSlice(l);b.writeSlice(d);if(!(a||c)){b.writeSlice(y)}b.writeUInt8(w);if(f){const _=this.ins[e];b.writeSlice(_.hash);b.writeUInt32(_.index);b.writeUInt64(n[e]);b.writeVarSlice(r[e]);b.writeUInt32(_.sequence)}else{b.writeUInt32(e)}if(o){const E=T.BufferWriter.withCapacity(O(o));E.writeVarSlice(o);b.writeSlice(v.sha256(E.end()))}if(c){b.writeSlice(y)}if(i){b.writeSlice(i);b.writeUInt8(0);b.writeUInt32(4294967295)}return v.taggedHash("TapSighash",B.concat([B.from([0]),b.end()]))}hashForWitnessV0(e,t,r,n){k(I.tuple(I.UInt32,I.Buffer,I.Satoshi,I.UInt32),arguments);let i=B.from([]);let o;let s=h;let u=h;let f=h;if(!(n&A.SIGHASH_ANYONECANPAY)){i=B.allocUnsafe(36*this.ins.length);o=new T.BufferWriter(i,0);this.ins.forEach(e=>{o.writeSlice(e.hash);o.writeUInt32(e.index)});u=v.hash256(i)}if(!(n&A.SIGHASH_ANYONECANPAY)&&(n&31)!==A.SIGHASH_SINGLE&&(n&31)!==A.SIGHASH_NONE){i=B.allocUnsafe(4*this.ins.length);o=new T.BufferWriter(i,0);this.ins.forEach(e=>{o.writeUInt32(e.sequence)});f=v.hash256(i)}if((n&31)!==A.SIGHASH_SINGLE&&(n&31)!==A.SIGHASH_NONE){const c=this.outs.reduce((e,t)=>{return e+8+O(t.script)},0);i=B.allocUnsafe(c);o=new T.BufferWriter(i,0);this.outs.forEach(e=>{o.writeUInt64(e.value);o.writeVarSlice(e.script)});s=v.hash256(i)}else if((n&31)===A.SIGHASH_SINGLE&&e<this.outs.length){const p=this.outs[e];i=B.allocUnsafe(8+O(p.script));o=new T.BufferWriter(i,0);o.writeUInt64(p.value);o.writeVarSlice(p.script);s=v.hash256(i)}i=B.allocUnsafe(156+O(t));o=new T.BufferWriter(i,0);const a=this.ins[e];o.writeInt32(this.version);o.writeSlice(u);o.writeSlice(f);o.writeSlice(a.hash);o.writeUInt32(a.index);o.writeVarSlice(t);o.writeUInt64(r);o.writeUInt32(a.sequence);o.writeSlice(s);o.writeUInt32(this.locktime);o.writeUInt32(n);return v.hash256(i)}getHash(e){if(e&&this.isCoinbase())return B.alloc(32,0);return v.hash256(this.__toBuffer(undefined,undefined,e))}getId(){return(0,T.reverseBuffer)(this.getHash(false)).toString("hex")}toBuffer(e,t){return this.__toBuffer(e,t,true)}toHex(){return this.toBuffer(undefined,undefined).toString("hex")}setInputScript(e,t){k(I.tuple(I.Number,I.Buffer),arguments);this.ins[e].script=t}setWitness(e,t){k(I.tuple(I.Number,[I.Buffer]),arguments);this.ins[e].witness=t}__toBuffer(e,t,r=false){if(!e)e=B.allocUnsafe(this.byteLength(r));const n=new T.BufferWriter(e,t||0);n.writeInt32(this.version);const i=r&&this.hasWitnesses();if(i){n.writeUInt8(A.ADVANCED_TRANSACTION_MARKER);n.writeUInt8(A.ADVANCED_TRANSACTION_FLAG)}n.writeVarInt(this.ins.length);this.ins.forEach(e=>{n.writeSlice(e.hash);n.writeUInt32(e.index);n.writeVarSlice(e.script);n.writeUInt32(e.sequence)});n.writeVarInt(this.outs.length);this.outs.forEach(e=>{if(o(e)){n.writeUInt64(e.value)}else{n.writeSlice(e.valueBuffer)}n.writeVarSlice(e.script)});if(i){this.ins.forEach(e=>{n.writeVector(e.witness)})}n.writeUInt32(this.locktime);if(t!==undefined)return e.slice(t,n.offset);return e}}n.Transaction=A;A.DEFAULT_SEQUENCE=4294967295;A.SIGHASH_DEFAULT=0;A.SIGHASH_ALL=1;A.SIGHASH_NONE=2;A.SIGHASH_SINGLE=3;A.SIGHASH_ANYONECANPAY=128;A.SIGHASH_OUTPUT_MASK=3;A.SIGHASH_INPUT_MASK=128;A.ADVANCED_TRANSACTION_MARKER=0;A.ADVANCED_TRANSACTION_FLAG=1}).call(this)}).call(this,t("buffer").Buffer)},{"./bufferutils":45,"./crypto":46,"./script":67,"./types":71,buffer:75}],71:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.oneOf=r.Null=r.BufferN=r.Function=r.UInt32=r.UInt8=r.tuple=r.maybe=r.Hex=r.Buffer=r.String=r.Boolean=r.Array=r.Number=r.Hash256bit=r.Hash160bit=r.Buffer256bit=r.isTaptree=r.isTapleaf=r.TAPLEAF_VERSION_MASK=r.Satoshi=r.isPoint=r.stacksEqual=r.typeforce=void 0;const i=e("buffer");r.typeforce=e("typeforce");const o=i.Buffer.alloc(32,0);const s=i.Buffer.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex");function n(e,r){if(e.length!==r.length)return false;return e.every((e,t)=>{return e.equals(r[t])})}r.stacksEqual=n;function u(e){if(!i.Buffer.isBuffer(e))return false;if(e.length<33)return false;const t=e[0];const r=e.slice(1,33);if(r.compare(o)===0)return false;if(r.compare(s)>=0)return false;if((t===2||t===3)&&e.length===33){return true}const n=e.slice(33);if(n.compare(o)===0)return false;if(n.compare(s)>=0)return false;if(t===4&&e.length===65)return true;return false}r.isPoint=u;const f=21*1e14;function a(e){return r.typeforce.UInt53(e)&&e<=f}r.Satoshi=a;r.TAPLEAF_VERSION_MASK=254;function c(e){if(!e||!("output"in e))return false;if(!i.Buffer.isBuffer(e.output))return false;if(e.version!==undefined)return(e.version&r.TAPLEAF_VERSION_MASK)===e.version;return true}r.isTapleaf=c;function p(e){if(!(0,r.Array)(e))return c(e);if(e.length!==2)return false;return e.every(e=>p(e))}r.isTaptree=p;r.Buffer256bit=r.typeforce.BufferN(32);r.Hash160bit=r.typeforce.BufferN(20);r.Hash256bit=r.typeforce.BufferN(32);r.Number=r.typeforce.Number;r.Array=r.typeforce.Array;r.Boolean=r.typeforce.Boolean;r.String=r.typeforce.String;r.Buffer=r.typeforce.Buffer;r.Hex=r.typeforce.Hex;r.maybe=r.typeforce.maybe;r.tuple=r.typeforce.tuple;r.UInt8=r.typeforce.UInt8;r.UInt32=r.typeforce.UInt32;r.Function=r.typeforce.Function;r.BufferN=r.typeforce.BufferN;r.Null=r.typeforce.Null;r.oneOf=r.typeforce.oneOf},{buffer:75,typeforce:81}],72:[function(e,t,r){const n=e("base-x");const i="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";t.exports=n(i)},{"base-x":9}],73:[function(e,t,r){"use strict";var s=e("bs58");t.exports=function(o){function e(e){var t=Uint8Array.from(e);var r=o(t);var n=t.length+4;var i=new Uint8Array(n);i.set(t,0);i.set(r.subarray(0,4),t.length);return s.encode(i,n)}function n(e){var t=e.slice(0,-4);var r=e.slice(-4);var n=o(t);if(r[0]^n[0]|r[1]^n[1]|r[2]^n[2]|r[3]^n[3])return;return t}function t(e){var t=s.decodeUnsafe(e);if(!t)return;return n(t)}function r(e){var t=s.decode(e);var r=n(t,o);if(!r)throw new Error("Invalid checksum");return r}return{encode:e,decode:r,decodeUnsafe:t}}},{bs58:72}],74:[function(e,t,r){"use strict";var{sha256:n}=e("@noble/hashes/sha256");var i=e("./base");function o(e){return n(n(e))}t.exports=i(o)},{"./base":73,"@noble/hashes/sha256":7}],75:[function($,e,J){(function(e){(function(){"use strict";var n=$("base64-js");var o=$("ieee754");J.Buffer=h;J.SlowBuffer=t;J.INSPECT_MAX_BYTES=50;var r=2147483647;J.kMaxLength=r;h.TYPED_ARRAY_SUPPORT=e();if(!h.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function e(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42}catch(e){return false}}Object.defineProperty(h.prototype,"parent",{enumerable:true,get:function(){if(!h.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(h.prototype,"offset",{enumerable:true,get:function(){if(!h.isBuffer(this))return undefined;return this.byteOffset}});function s(e){if(e>r){throw new RangeError('The value "'+e+'" is invalid for option "size"')}var t=new Uint8Array(e);t.__proto__=h.prototype;return t}function h(e,t,r){if(typeof e==="number"){if(typeof t==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return a(e)}return i(e,t,r)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&h[Symbol.species]===h){Object.defineProperty(h,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}h.poolSize=8192;function i(e,t,r){if(typeof e==="string"){return c(e,t)}if(ArrayBuffer.isView(e)){return p(e)}if(e==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}if(C(e,ArrayBuffer)||e&&C(e.buffer,ArrayBuffer)){return l(e,t,r)}if(typeof e==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var n=e.valueOf&&e.valueOf();if(n!=null&&n!==e){return h.from(n,t,r)}var i=d(e);if(i)return i;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]==="function"){return h.from(e[Symbol.toPrimitive]("string"),t,r)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}h.from=function(e,t,r){return i(e,t,r)};h.prototype.__proto__=Uint8Array.prototype;h.__proto__=Uint8Array;function u(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be of type number')}else if(e<0){throw new RangeError('The value "'+e+'" is invalid for option "size"')}}function f(e,t,r){u(e);if(e<=0){return s(e)}if(t!==undefined){return typeof r==="string"?s(e).fill(t,r):s(e).fill(t)}return s(e)}h.alloc=function(e,t,r){return f(e,t,r)};function a(e){u(e);return s(e<0?0:y(e)|0)}h.allocUnsafe=function(e){return a(e)};h.allocUnsafeSlow=function(e){return a(e)};function c(e,t){if(typeof t!=="string"||t===""){t="utf8"}if(!h.isEncoding(t)){throw new TypeError("Unknown encoding: "+t)}var r=w(e,t)|0;var n=s(r);var i=n.write(e,t);if(i!==r){n=n.slice(0,i)}return n}function p(e){var t=e.length<0?0:y(e.length)|0;var r=s(t);for(var n=0;n<t;n+=1){r[n]=e[n]&255}return r}function l(e,t,r){if(t<0||e.byteLength<t){throw new RangeError('"offset" is outside of buffer bounds')}if(e.byteLength<t+(r||0)){throw new RangeError('"length" is outside of buffer bounds')}var n;if(t===undefined&&r===undefined){n=new Uint8Array(e)}else if(r===undefined){n=new Uint8Array(e,t)}else{n=new Uint8Array(e,t,r)}n.__proto__=h.prototype;return n}function d(e){if(h.isBuffer(e)){var t=y(e.length)|0;var r=s(t);if(r.length===0){return r}e.copy(r,0,0,t);return r}if(e.length!==undefined){if(typeof e.length!=="number"||x(e.length)){return s(0)}return p(e)}if(e.type==="Buffer"&&Array.isArray(e.data)){return p(e.data)}}function y(e){if(e>=r){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+r.toString(16)+" bytes")}return e|0}function t(e){if(+e!=e){e=0}return h.alloc(+e)}h.isBuffer=function e(t){return t!=null&&t._isBuffer===true&&t!==h.prototype};h.compare=function e(t,r){if(C(t,Uint8Array))t=h.from(t,t.offset,t.byteLength);if(C(r,Uint8Array))r=h.from(r,r.offset,r.byteLength);if(!h.isBuffer(t)||!h.isBuffer(r)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(t===r)return 0;var n=t.length;var i=r.length;for(var o=0,s=Math.min(n,i);o<s;++o){if(t[o]!==r[o]){n=t[o];i=r[o];break}}if(n<i)return-1;if(i<n)return 1;return 0};h.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};h.concat=function e(t,r){if(!Array.isArray(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return h.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var i=h.allocUnsafe(r);var o=0;for(n=0;n<t.length;++n){var s=t[n];if(C(s,Uint8Array)){s=h.from(s)}if(!h.isBuffer(s)){throw new TypeError('"list" argument must be an Array of Buffers')}s.copy(i,o);o+=s.length}return i};function w(e,t){if(h.isBuffer(e)){return e.length}if(ArrayBuffer.isView(e)||C(e,ArrayBuffer)){return e.byteLength}if(typeof e!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof e)}var r=e.length;var n=arguments.length>2&&arguments[2]===true;if(!n&&r===0)return 0;var i=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return N(e).length;default:if(i){return n?-1:U(e).length}t=(""+t).toLowerCase();i=true}}}h.byteLength=w;function g(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return j(this,t,r);case"utf8":case"utf-8":return v(this,t,r);case"ascii":return K(this,t,r);case"latin1":case"binary":return V(this,t,r);case"base64":return M(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}h.prototype._isBuffer=true;function b(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}h.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){b(this,r,r+1)}return this};h.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){b(this,r,r+3);b(this,r+1,r+2)}return this};h.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){b(this,r,r+7);b(this,r+1,r+6);b(this,r+2,r+5);b(this,r+3,r+4)}return this};h.prototype.toString=function e(){var t=this.length;if(t===0)return"";if(arguments.length===0)return v(this,0,t);return g.apply(this,arguments)};h.prototype.toLocaleString=h.prototype.toString;h.prototype.equals=function e(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return h.compare(this,t)===0};h.prototype.inspect=function e(){var t="";var r=J.INSPECT_MAX_BYTES;t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim();if(this.length>r)t+=" ... ";return"<Buffer "+t+">"};h.prototype.compare=function e(t,r,n,i,o){if(C(t,Uint8Array)){t=h.from(t,t.offset,t.byteLength)}if(!h.isBuffer(t)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof t)}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(i===undefined){i=0}if(o===undefined){o=this.length}if(r<0||n>t.length||i<0||o>this.length){throw new RangeError("out of range index")}if(i>=o&&r>=n){return 0}if(i>=o){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;i>>>=0;o>>>=0;if(this===t)return 0;var s=o-i;var u=n-r;var f=Math.min(s,u);var a=this.slice(i,o);var c=t.slice(r,n);for(var p=0;p<f;++p){if(a[p]!==c[p]){s=a[p];u=c[p];break}}if(s<u)return-1;if(u<s)return 1;return 0};function m(e,t,r,n,i){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(x(r)){r=i?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(i)return-1;else r=e.length-1}else if(r<0){if(i)r=0;else return-1}if(typeof t==="string"){t=h.from(t,n)}if(h.isBuffer(t)){if(t.length===0){return-1}return E(e,t,r,n,i)}else if(typeof t==="number"){t=t&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(i){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return E(e,[t],r,n,i)}throw new TypeError("val must be string, number or Buffer")}function E(e,t,r,n,i){var o=1;var s=e.length;var u=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}o=2;s/=2;u/=2;r/=2}}function f(e,t){if(o===1){return e[t]}else{return e.readUInt16BE(t*o)}}var a;if(i){var c=-1;for(a=r;a<s;a++){if(f(e,a)===f(t,c===-1?0:a-c)){if(c===-1)c=a;if(a-c+1===u)return c*o}else{if(c!==-1)a-=a-c;c=-1}}}else{if(r+u>s)r=s-u;for(a=r;a>=0;a--){var p=true;for(var h=0;h<u;h++){if(f(e,a+h)!==f(t,h)){p=false;break}}if(p)return a}}return-1}h.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};h.prototype.indexOf=function e(t,r,n){return m(this,t,r,n,true)};h.prototype.lastIndexOf=function e(t,r,n){return m(this,t,r,n,false)};function S(e,t,r,n){r=Number(r)||0;var i=e.length-r;if(!n){n=i}else{n=Number(n);if(n>i){n=i}}var o=t.length;if(n>o/2){n=o/2}for(var s=0;s<n;++s){var u=parseInt(t.substr(s*2,2),16);if(x(u))return s;e[r+s]=u}return s}function _(e,t,r,n){return H(U(t,e.length-r),e,r,n)}function T(e,t,r,n){return H(z(t),e,r,n)}function L(e,t,r,n){return T(e,t,r,n)}function R(e,t,r,n){return H(N(t),e,r,n)}function F(e,t,r,n){return H(Y(t,e.length-r),e,r,n)}h.prototype.write=function e(t,r,n,i){if(r===undefined){i="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){i=r;n=this.length;r=0}else if(isFinite(r)){r=r>>>0;if(isFinite(n)){n=n>>>0;if(i===undefined)i="utf8"}else{i=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var o=this.length-r;if(n===undefined||n>o)n=o;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!i)i="utf8";var s=false;for(;;){switch(i){case"hex":return S(this,t,r,n);case"utf8":case"utf-8":return _(this,t,r,n);case"ascii":return T(this,t,r,n);case"latin1":case"binary":return L(this,t,r,n);case"base64":return R(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,t,r,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase();s=true}}};h.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function M(e,t,r){if(t===0&&r===e.length){return n.fromByteArray(e)}else{return n.fromByteArray(e.slice(t,r))}}function v(e,t,r){r=Math.min(e.length,r);var n=[];var i=t;while(i<r){var o=e[i];var s=null;var u=o>239?4:o>223?3:o>191?2:1;if(i+u<=r){var f,a,c,p;switch(u){case 1:if(o<128){s=o}break;case 2:f=e[i+1];if((f&192)===128){p=(o&31)<<6|f&63;if(p>127){s=p}}break;case 3:f=e[i+1];a=e[i+2];if((f&192)===128&&(a&192)===128){p=(o&15)<<12|(f&63)<<6|a&63;if(p>2047&&(p<55296||p>57343)){s=p}}break;case 4:f=e[i+1];a=e[i+2];c=e[i+3];if((f&192)===128&&(a&192)===128&&(c&192)===128){p=(o&15)<<18|(f&63)<<12|(a&63)<<6|c&63;if(p>65535&&p<1114112){s=p}}}}if(s===null){s=65533;u=1}else if(s>65535){s-=65536;n.push(s>>>10&1023|55296);s=56320|s&1023}n.push(s);i+=u}return D(n)}var I=4096;function D(e){var t=e.length;if(t<=I){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=I))}return r}function K(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i]&127)}return n}function V(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i])}return n}function j(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var i="";for(var o=t;o<r;++o){i+=q(e[o])}return i}function W(e,t,r){var n=e.slice(t,r);var i="";for(var o=0;o<n.length;o+=2){i+=String.fromCharCode(n[o]+n[o+1]*256)}return i}h.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var i=this.subarray(t,r);i.__proto__=h.prototype;return i};function k(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}h.prototype.readUIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)k(t,r,this.length);var i=this[t];var o=1;var s=0;while(++s<r&&(o*=256)){i+=this[t+s]*o}return i};h.prototype.readUIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n){k(t,r,this.length)}var i=this[t+--r];var o=1;while(r>0&&(o*=256)){i+=this[t+--r]*o}return i};h.prototype.readUInt8=function e(t,r){t=t>>>0;if(!r)k(t,1,this.length);return this[t]};h.prototype.readUInt16LE=function e(t,r){t=t>>>0;if(!r)k(t,2,this.length);return this[t]|this[t+1]<<8};h.prototype.readUInt16BE=function e(t,r){t=t>>>0;if(!r)k(t,2,this.length);return this[t]<<8|this[t+1]};h.prototype.readUInt32LE=function e(t,r){t=t>>>0;if(!r)k(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};h.prototype.readUInt32BE=function e(t,r){t=t>>>0;if(!r)k(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};h.prototype.readIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)k(t,r,this.length);var i=this[t];var o=1;var s=0;while(++s<r&&(o*=256)){i+=this[t+s]*o}o*=128;if(i>=o)i-=Math.pow(2,8*r);return i};h.prototype.readIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)k(t,r,this.length);var i=r;var o=1;var s=this[t+--i];while(i>0&&(o*=256)){s+=this[t+--i]*o}o*=128;if(s>=o)s-=Math.pow(2,8*r);return s};h.prototype.readInt8=function e(t,r){t=t>>>0;if(!r)k(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};h.prototype.readInt16LE=function e(t,r){t=t>>>0;if(!r)k(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};h.prototype.readInt16BE=function e(t,r){t=t>>>0;if(!r)k(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};h.prototype.readInt32LE=function e(t,r){t=t>>>0;if(!r)k(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};h.prototype.readInt32BE=function e(t,r){t=t>>>0;if(!r)k(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};h.prototype.readFloatLE=function e(t,r){t=t>>>0;if(!r)k(t,4,this.length);return o.read(this,t,true,23,4)};h.prototype.readFloatBE=function e(t,r){t=t>>>0;if(!r)k(t,4,this.length);return o.read(this,t,false,23,4)};h.prototype.readDoubleLE=function e(t,r){t=t>>>0;if(!r)k(t,8,this.length);return o.read(this,t,true,52,8)};h.prototype.readDoubleBE=function e(t,r){t=t>>>0;if(!r)k(t,8,this.length);return o.read(this,t,false,52,8)};function O(e,t,r,n,i,o){if(!h.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}h.prototype.writeUIntLE=function e(t,r,n,i){t=+t;r=r>>>0;n=n>>>0;if(!i){var o=Math.pow(2,8*n)-1;O(this,t,r,n,o,0)}var s=1;var u=0;this[r]=t&255;while(++u<n&&(s*=256)){this[r+u]=t/s&255}return r+n};h.prototype.writeUIntBE=function e(t,r,n,i){t=+t;r=r>>>0;n=n>>>0;if(!i){var o=Math.pow(2,8*n)-1;O(this,t,r,n,o,0)}var s=n-1;var u=1;this[r+s]=t&255;while(--s>=0&&(u*=256)){this[r+s]=t/u&255}return r+n};h.prototype.writeUInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,1,255,0);this[r]=t&255;return r+1};h.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,2,65535,0);this[r]=t&255;this[r+1]=t>>>8;return r+2};h.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,2,65535,0);this[r]=t>>>8;this[r+1]=t&255;return r+2};h.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,4,4294967295,0);this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255;return r+4};h.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,4,4294967295,0);this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};h.prototype.writeIntLE=function e(t,r,n,i){t=+t;r=r>>>0;if(!i){var o=Math.pow(2,8*n-1);O(this,t,r,n,o-1,-o)}var s=0;var u=1;var f=0;this[r]=t&255;while(++s<n&&(u*=256)){if(t<0&&f===0&&this[r+s-1]!==0){f=1}this[r+s]=(t/u>>0)-f&255}return r+n};h.prototype.writeIntBE=function e(t,r,n,i){t=+t;r=r>>>0;if(!i){var o=Math.pow(2,8*n-1);O(this,t,r,n,o-1,-o)}var s=n-1;var u=1;var f=0;this[r+s]=t&255;while(--s>=0&&(u*=256)){if(t<0&&f===0&&this[r+s+1]!==0){f=1}this[r+s]=(t/u>>0)-f&255}return r+n};h.prototype.writeInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,1,127,-128);if(t<0)t=255+t+1;this[r]=t&255;return r+1};h.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,2,32767,-32768);this[r]=t&255;this[r+1]=t>>>8;return r+2};h.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,2,32767,-32768);this[r]=t>>>8;this[r+1]=t&255;return r+2};h.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,4,2147483647,-2147483648);this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24;return r+4};h.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)O(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};function P(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function A(e,t,r,n,i){t=+t;r=r>>>0;if(!i){P(e,t,r,4,34028234663852886e22,-34028234663852886e22)}o.write(e,t,r,n,23,4);return r+4}h.prototype.writeFloatLE=function e(t,r,n){return A(this,t,r,true,n)};h.prototype.writeFloatBE=function e(t,r,n){return A(this,t,r,false,n)};function B(e,t,r,n,i){t=+t;r=r>>>0;if(!i){P(e,t,r,8,17976931348623157e292,-17976931348623157e292)}o.write(e,t,r,n,52,8);return r+8}h.prototype.writeDoubleLE=function e(t,r,n){return B(this,t,r,true,n)};h.prototype.writeDoubleBE=function e(t,r,n){return B(this,t,r,false,n)};h.prototype.copy=function e(t,r,n,i){if(!h.isBuffer(t))throw new TypeError("argument should be a Buffer");if(!n)n=0;if(!i&&i!==0)i=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(i>0&&i<n)i=n;if(i===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");if(i>this.length)i=this.length;if(t.length-r<i-n){i=t.length-r+n}var o=i-n;if(this===t&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(r,n,i)}else if(this===t&&n<r&&r<i){for(var s=o-1;s>=0;--s){t[s+r]=this[s+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,i),r)}return o};h.prototype.fill=function e(t,r,n,i){if(typeof t==="string"){if(typeof r==="string"){i=r;r=0;n=this.length}else if(typeof n==="string"){i=n;n=this.length}if(i!==undefined&&typeof i!=="string"){throw new TypeError("encoding must be a string")}if(typeof i==="string"&&!h.isEncoding(i)){throw new TypeError("Unknown encoding: "+i)}if(t.length===1){var o=t.charCodeAt(0);if(i==="utf8"&&o<128||i==="latin1"){t=o}}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var s;if(typeof t==="number"){for(s=r;s<n;++s){this[s]=t}}else{var u=h.isBuffer(t)?t:h.from(t,i);var f=u.length;if(f===0){throw new TypeError('The value "'+t+'" is invalid for argument "value"')}for(s=0;s<n-r;++s){this[s+r]=u[s%f]}}return this};var G=/[^+/0-9A-Za-z-_]/g;function X(e){e=e.split("=")[0];e=e.trim().replace(G,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function q(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function U(e,t){t=t||Infinity;var r;var n=e.length;var i=null;var o=[];for(var s=0;s<n;++s){r=e.charCodeAt(s);if(r>55295&&r<57344){if(!i){if(r>56319){if((t-=3)>-1)o.push(239,191,189);continue}else if(s+1===n){if((t-=3)>-1)o.push(239,191,189);continue}i=r;continue}if(r<56320){if((t-=3)>-1)o.push(239,191,189);i=r;continue}r=(i-55296<<10|r-56320)+65536}else if(i){if((t-=3)>-1)o.push(239,191,189)}i=null;if(r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return o}function z(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function Y(e,t){var r,n,i;var o=[];for(var s=0;s<e.length;++s){if((t-=2)<0)break;r=e.charCodeAt(s);n=r>>8;i=r%256;o.push(i);o.push(n)}return o}function N(e){return n.toByteArray(X(e))}function H(e,t,r,n){for(var i=0;i<n;++i){if(i+r>=t.length||i>=e.length)break;t[i+r]=e[i]}return i}function C(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function x(e){return e!==e}}).call(this)}).call(this,$("buffer").Buffer)},{"base64-js":10,buffer:75,ieee754:76}],76:[function(e,t,r){r.read=function(e,t,r,n,i){var o,s;var u=i*8-n-1;var f=(1<<u)-1;var a=f>>1;var c=-7;var p=r?i-1:0;var h=r?-1:1;var l=e[t+p];p+=h;o=l&(1<<-c)-1;l>>=-c;c+=u;for(;c>0;o=o*256+e[t+p],p+=h,c-=8){}s=o&(1<<-c)-1;o>>=-c;c+=n;for(;c>0;s=s*256+e[t+p],p+=h,c-=8){}if(o===0){o=1-a}else if(o===f){return s?NaN:(l?-1:1)*Infinity}else{s=s+Math.pow(2,n);o=o-a}return(l?-1:1)*s*Math.pow(2,o-n)};r.write=function(e,t,r,n,i,o){var s,u,f;var a=o*8-i-1;var c=(1<<a)-1;var p=c>>1;var h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var l=n?0:o-1;var d=n?1:-1;var y=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){u=isNaN(t)?1:0;s=c}else{s=Math.floor(Math.log(t)/Math.LN2);if(t*(f=Math.pow(2,-s))<1){s--;f*=2}if(s+p>=1){t+=h/f}else{t+=h*Math.pow(2,1-p)}if(t*f>=2){s++;f/=2}if(s+p>=c){u=0;s=c}else if(s+p>=1){u=(t*f-1)*Math.pow(2,i);s=s+p}else{u=t*Math.pow(2,p-1)*Math.pow(2,i);s=0}}for(;i>=8;e[r+l]=u&255,l+=d,u/=256,i-=8){}s=s<<i|u;a+=i;for(;a>0;e[r+l]=s&255,l+=d,s/=256,a-=8){}e[r+l-d]|=y*128}},{}],77:[function(e,t,r){t.exports=function(e){return e!=null&&(n(e)||i(e)||!!e._isBuffer)};function n(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function i(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&n(e.slice(0,0))}},{}],78:[function(e,t,r){var n=e("buffer");var i=n.Buffer;function o(e,t){for(var r in e){t[r]=e[r]}}if(i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow){t.exports=n}else{o(n,r);r.Buffer=s}function s(e,t,r){return i(e,t,r)}s.prototype=Object.create(i.prototype);o(i,s);s.from=function(e,t,r){if(typeof e==="number"){throw new TypeError("Argument must not be a number")}return i(e,t,r)};s.alloc=function(e,t,r){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}var n=i(e);if(t!==undefined){if(typeof r==="string"){n.fill(t,r)}else{n.fill(t)}}else{n.fill(0)}return n};s.allocUnsafe=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return i(e)};s.allocUnsafeSlow=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return n.SlowBuffer(e)}},{buffer:75}],79:[function(e,t,r){var n=e("./native");function i(e){return e.name||e.toString().match(/function (.*?)\s*\(/)[1]}function o(e){return n.Nil(e)?"":i(e.constructor)}function s(e){if(n.Function(e))return"";if(n.String(e))return JSON.stringify(e);if(e&&n.Object(e))return"";return e}function u(e,t){if(Error.captureStackTrace){Error.captureStackTrace(e,t)}}function f(e){if(n.Function(e))return e.toJSON?e.toJSON():i(e);if(n.Array(e))return"Array";if(e&&n.Object(e))return"Object";return e!==undefined?e:""}function a(e,t,r){var n=s(t);return"Expected "+f(e)+", got"+(r!==""?" "+r:"")+(n!==""?" "+n:"")}function c(e,t,r){r=r||o(t);this.message=a(e,t,r);u(this,c);this.__type=e;this.__value=t;this.__valueTypeName=r}c.prototype=Object.create(Error.prototype);c.prototype.constructor=c;function p(e,t,r,n,i){var o='" of type ';if(t==="key")o='" with key type ';return a('property "'+f(r)+o+f(e),n,i)}function h(e,t,r,n,i){if(e){i=i||o(n);this.message=p(e,r,t,n,i)}else{this.message='Unexpected property "'+t+'"'}u(this,c);this.__label=r;this.__property=t;this.__type=e;this.__value=n;this.__valueTypeName=i}h.prototype=Object.create(Error.prototype);h.prototype.constructor=c;function l(e,t){return new c(e,{},t)}function d(e,t,r){if(e instanceof h){t=t+"."+e.__property;e=new h(e.__type,t,e.__label,e.__value,e.__valueTypeName)}else if(e instanceof c){e=new h(e.__type,t,r,e.__value,e.__valueTypeName)}u(e);return e}t.exports={TfTypeError:c,TfPropertyTypeError:h,tfCustomError:l,tfSubError:d,tfJSON:f,getValueTypeName:o}},{"./native":82}],80:[function(T,v,e){(function(_){(function(){var t=T("./native");var i=T("./errors");function e(e){return _.isBuffer(e)}function r(e){return typeof e==="string"&&/^([0-9a-f]{2})+$/i.test(e)}function n(t,r){var n=t.toJSON();function e(e){if(!t(e))return false;if(e.length===r)return true;throw i.tfCustomError(n+"(Length: "+r+")",n+"(Length: "+e.length+")")}e.toJSON=function(){return n};return e}var o=n.bind(null,t.Array);var s=n.bind(null,e);var u=n.bind(null,r);var f=n.bind(null,t.String);function a(r,n,i){i=i||t.Number;function e(e,t){return i(e,t)&&e>r&&e<n}e.toJSON=function(){return`${i.toJSON()} between [${r}, ${n}]`};return e}var c=Math.pow(2,53)-1;function p(e){return typeof e==="number"&&isFinite(e)}function h(e){return e<<24>>24===e}function l(e){return e<<16>>16===e}function d(e){return(e|0)===e}function y(e){return typeof e==="number"&&e>=-c&&e<=c&&Math.floor(e)===e}function w(e){return(e&255)===e}function g(e){return(e&65535)===e}function b(e){return e>>>0===e}function m(e){return typeof e==="number"&&e>=0&&e<=c&&Math.floor(e)===e}var E={ArrayN:o,Buffer:e,BufferN:s,Finite:p,Hex:r,HexN:u,Int8:h,Int16:l,Int32:d,Int53:y,Range:a,StringN:f,UInt8:w,UInt16:g,UInt32:b,UInt53:m};for(var S in E){E[S].toJSON=function(e){return e}.bind(null,S)}v.exports=E}).call(this)}).call(this,{isBuffer:T("../is-buffer/index.js")})},{"../is-buffer/index.js":77,"./errors":79,"./native":82}],81:[function(e,t,r){var n=e("./errors");var s=e("./native");var u=n.tfJSON;var i=n.TfTypeError;var f=n.TfPropertyTypeError;var a=n.tfSubError;var o=n.getValueTypeName;var c={arrayOf:function e(n,t){n=p(n);t=t||{};function r(e,r){if(!s.Array(e))return false;if(s.Nil(e))return false;if(t.minLength!==undefined&&e.length<t.minLength)return false;if(t.maxLength!==undefined&&e.length>t.maxLength)return false;if(t.length!==undefined&&e.length!==t.length)return false;return e.every(function(e,t){try{return h(n,e,r)}catch(e){throw a(e,t)}})}r.toJSON=function(){var e="["+u(n)+"]";if(t.length!==undefined){e+="{"+t.length+"}"}else if(t.minLength!==undefined||t.maxLength!==undefined){e+="{"+(t.minLength===undefined?0:t.minLength)+","+(t.maxLength===undefined?Infinity:t.maxLength)+"}"}return e};return r},maybe:function r(n){n=p(n);function e(e,t){return s.Nil(e)||n(e,t,r)}e.toJSON=function(){return"?"+u(n)};return e},map:function e(i,o){i=p(i);if(o)o=p(o);function t(e,t){if(!s.Object(e))return false;if(s.Nil(e))return false;for(var r in e){try{if(o){h(o,r,t)}}catch(e){throw a(e,r,"key")}try{var n=e[r];h(i,n,t)}catch(e){throw a(e,r)}}return true}if(o){t.toJSON=function(){return"{"+u(o)+": "+u(i)+"}"}}else{t.toJSON=function(){return"{"+u(i)+"}"}}return t},object:function e(t){var o={};for(var r in t){o[r]=p(t[r])}function n(e,t){if(!s.Object(e))return false;if(s.Nil(e))return false;var r;try{for(r in o){var n=o[r];var i=e[r];h(n,i,t)}}catch(e){throw a(e,r)}if(t){for(r in e){if(o[r])continue;throw new f(undefined,r)}}return true}n.toJSON=function(){return u(o)};return n},anyOf:function e(){var n=[].slice.call(arguments).map(p);function t(t,r){return n.some(function(e){try{return h(e,t,r)}catch(e){return false}})}t.toJSON=function(){return n.map(u).join("|")};return t},allOf:function e(){var n=[].slice.call(arguments).map(p);function t(t,r){return n.every(function(e){try{return h(e,t,r)}catch(e){return false}})}t.toJSON=function(){return n.map(u).join(" & ")};return t},quacksLike:function e(t){function r(e){return t===o(e)}r.toJSON=function(){return t};return r},tuple:function e(){var t=[].slice.call(arguments).map(p);function r(r,n){if(s.Nil(r))return false;if(s.Nil(r.length))return false;if(n&&r.length!==t.length)return false;return t.every(function(e,t){try{return h(e,r[t],n)}catch(e){throw a(e,t)}})}r.toJSON=function(){return"("+t.map(u).join(", ")+")"};return r},value:function e(t){function r(e){return e===t}r.toJSON=function(){return t};return r}};c.oneOf=c.anyOf;function p(e){if(s.String(e)){if(e[0]==="?")return c.maybe(e.slice(1));return s[e]||c.quacksLike(e)}else if(e&&s.Object(e)){if(s.Array(e)){if(e.length!==1)throw new TypeError("Expected compile() parameter of type Array of length 1");return c.arrayOf(e[0])}return c.object(e)}else if(s.Function(e)){return e}return c.value(e)}function h(e,t,r,n){if(s.Function(e)){if(e(t,r))return true;throw new i(n||e,t)}return h(p(e),t,r)}for(var l in s){h[l]=s[l]}for(l in c){h[l]=c[l]}var d=e("./extra");for(l in d){h[l]=d[l]}h.compile=p;h.TfTypeError=i;h.TfPropertyTypeError=f;t.exports=h},{"./errors":79,"./extra":80,"./native":82}],82:[function(e,t,r){var n={Array:function(e){return e!==null&&e!==undefined&&e.constructor===Array},Boolean:function(e){return typeof e==="boolean"},Function:function(e){return typeof e==="function"},Nil:function(e){return e===undefined||e===null},Number:function(e){return typeof e==="number"},Object:function(e){return typeof e==="object"},String:function(e){return typeof e==="string"},"":function(){return true}};n.Null=n.Nil;for(var i in n){n[i].toJSON=function(e){return e}.bind(null,i)}t.exports=n},{}],83:[function(e,t,r){"use strict";var s=e("safe-buffer").Buffer;var n=9007199254740991;function u(e){if(e<0||e>n||e%1!==0)throw new RangeError("value out of range")}function i(e,t,r){u(e);if(!t)t=s.allocUnsafe(o(e));if(!s.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(!r)r=0;if(e<253){t.writeUInt8(e,r);i.bytes=1}else if(e<=65535){t.writeUInt8(253,r);t.writeUInt16LE(e,r+1);i.bytes=3}else if(e<=4294967295){t.writeUInt8(254,r);t.writeUInt32LE(e,r+1);i.bytes=5}else{t.writeUInt8(255,r);t.writeUInt32LE(e>>>0,r+1);t.writeUInt32LE(e/4294967296|0,r+5);i.bytes=9}return t}function f(e,t){if(!s.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(!t)t=0;var r=e.readUInt8(t);if(r<253){f.bytes=1;return r}else if(r===253){f.bytes=3;return e.readUInt16LE(t+1)}else if(r===254){f.bytes=5;return e.readUInt32LE(t+1)}else{f.bytes=9;var n=e.readUInt32LE(t+1);var i=e.readUInt32LE(t+5);var o=i*4294967296+n;u(o);return o}}function o(e){u(e);return e<253?1:e<=65535?3:e<=4294967295?5:9}t.exports={encode:i,decode:f,encodingLength:o}},{"safe-buffer":78}]},{},[1])(1)});